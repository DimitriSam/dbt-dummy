

============================== 2023-02-20 15:15:24.866003 | 23a8a17a-8243-4987-8851-3b048f4ef276 ==============================
[0m15:15:24.866016 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:15:24.866939 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m15:15:24.868977 [debug] [MainThread]: Tracking: tracking
[0m15:15:24.872665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867d7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867d7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867d7d90>]}
[0m15:15:24.895983 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-y1r_t0k7'
[0m15:15:24.897341 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:15:25.634780 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:15:25.654793 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:15:26.253455 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:15:26.318392 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:15:31.750516 [info ] [MainThread]:   Installed from version 1.0.0
[0m15:15:31.752294 [info ] [MainThread]:   Up to date!
[0m15:15:31.754107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '23a8a17a-8243-4987-8851-3b048f4ef276', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86632890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866324a0>]}
[0m15:15:31.756558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867edd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86633f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866330a0>]}
[0m15:15:31.757661 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 15:15:33.970427 | 29b151b3-3bf4-4c61-9793-e4f255a34af9 ==============================
[0m15:15:33.970445 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:15:33.972196 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m15:15:33.974773 [debug] [MainThread]: Tracking: tracking
[0m15:15:33.980266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa99180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa99270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa99210>]}
[0m15:15:34.011139 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m15:15:34.013737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa98ac0>]}
[0m15:15:34.399997 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m15:15:34.405785 [debug] [MainThread]: Parsing macros/relations.sql
[0m15:15:34.408195 [debug] [MainThread]: Parsing macros/adapters.sql
[0m15:15:34.420827 [debug] [MainThread]: Parsing macros/catalog.sql
[0m15:15:34.423413 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:15:34.426904 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:15:34.429209 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:15:34.434165 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:15:34.436221 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:15:34.437954 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:15:34.440116 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m15:15:34.460753 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m15:15:34.463428 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m15:15:34.468241 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:15:34.470048 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:15:34.471880 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:15:34.474355 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:15:34.476144 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m15:15:34.477892 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:15:34.485390 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:15:34.487567 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:15:34.489264 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:15:34.490971 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:15:34.494076 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m15:15:34.501751 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:15:34.503727 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m15:15:34.505939 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m15:15:34.507830 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:15:34.510074 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m15:15:34.515704 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:15:34.517958 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m15:15:34.520516 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m15:15:34.522709 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:15:34.525019 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m15:15:34.527017 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:15:34.528939 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:15:34.530656 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m15:15:34.532398 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m15:15:34.538494 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m15:15:34.542355 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m15:15:34.547772 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m15:15:34.550942 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m15:15:34.553900 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:15:34.561485 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m15:15:34.565304 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m15:15:34.574302 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m15:15:34.577878 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m15:15:34.580305 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m15:15:34.582329 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m15:15:34.584333 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m15:15:34.606969 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m15:15:34.612908 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m15:15:34.616445 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m15:15:34.619874 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m15:15:34.627140 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m15:15:34.630052 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m15:15:34.640409 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m15:15:34.648826 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m15:15:34.653531 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m15:15:34.656412 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m15:15:34.658762 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m15:15:34.665054 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m15:15:34.673398 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m15:15:34.682714 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m15:15:34.692508 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m15:15:34.697028 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m15:15:34.700094 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m15:15:34.704168 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m15:15:34.710743 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m15:15:34.713128 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m15:15:34.715265 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m15:15:34.718701 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m15:15:34.720805 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m15:15:34.725619 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m15:15:34.735443 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m15:15:34.737811 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m15:15:34.739974 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m15:15:34.741676 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m15:15:34.743547 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m15:15:34.747893 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m15:15:34.750945 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m15:15:34.753704 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m15:15:34.756268 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m15:15:34.759920 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m15:15:34.764647 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m15:15:34.767172 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m15:15:34.770621 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m15:15:34.777021 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m15:15:34.779943 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m15:15:34.799624 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m15:15:34.802364 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m15:15:34.806766 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m15:15:34.811158 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m15:15:34.815062 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m15:15:34.818878 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m15:15:34.823958 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m15:15:34.831688 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m15:15:34.834644 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m15:15:34.837535 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m15:15:34.840720 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m15:15:34.843727 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m15:15:34.850923 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m15:15:34.855953 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m15:15:34.859958 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m15:15:34.865570 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m15:15:34.869609 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m15:15:34.877575 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m15:15:34.881441 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m15:15:34.884706 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m15:15:34.888127 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m15:15:34.891518 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m15:15:34.895622 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m15:15:34.898678 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m15:15:34.903921 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m15:15:34.906280 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m15:15:34.909866 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m15:15:34.914566 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m15:15:34.916809 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m15:15:34.918705 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m15:15:34.921883 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m15:15:34.925757 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m15:15:34.927549 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m15:15:34.931299 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m15:15:34.933372 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m15:15:34.941632 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m15:15:34.964377 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m15:15:34.968195 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m15:15:34.970754 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m15:15:34.972839 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m15:15:35.122074 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m15:15:35.131556 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m15:15:35.134894 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m15:15:35.137882 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payment.sql
[0m15:15:35.174408 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m15:15:35.193616 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_int_customers_per_store_snapshot_total_customers.6745de9a0e' (snapshots/_snapshots.yml) depends on a node named 'int_customers_per_store_snapshot' which was not found
[0m15:15:35.287525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa66050>]}
[0m15:15:35.334292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa67250>]}
[0m15:15:35.337069 [info ] [MainThread]: Found 4 models, 8 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m15:15:35.338832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf928220>]}
[0m15:15:35.341385 [info ] [MainThread]: 
[0m15:15:35.374816 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:15:35.377273 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m15:15:35.386130 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:15:35.388218 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:15:35.391001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:35.452514 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.06 seconds
[0m15:15:35.456066 [debug] [ThreadPool]: On list_postgres: Close
[0m15:15:35.465337 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m15:15:35.472589 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:15:35.477082 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:15:35.481119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:35.518199 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m15:15:35.526989 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:15:35.531155 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:15:35.585769 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.05 seconds
[0m15:15:35.589307 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:15:35.596921 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:15:35.601958 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:35.604050 [debug] [MainThread]: On master: BEGIN
[0m15:15:35.605570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:15:40.688191 [debug] [MainThread]: SQL status: BEGIN in 5.08 seconds
[0m15:15:40.691881 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:40.694370 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:15:40.781289 [debug] [MainThread]: SQL status: SELECT 43 in 0.08 seconds
[0m15:15:40.786300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa4cfd0>]}
[0m15:15:40.788696 [debug] [MainThread]: On master: ROLLBACK
[0m15:15:40.809882 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:40.811858 [debug] [MainThread]: On master: BEGIN
[0m15:15:40.814579 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:15:40.816495 [debug] [MainThread]: On master: COMMIT
[0m15:15:40.818195 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:40.819909 [debug] [MainThread]: On master: COMMIT
[0m15:15:40.822094 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:15:40.823403 [debug] [MainThread]: On master: Close
[0m15:15:40.830000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:15:40.831799 [info ] [MainThread]: 
[0m15:15:40.845450 [debug] [Thread-1 (]: Began running node model.test_dbt_project.stg_payment
[0m15:15:40.848039 [info ] [Thread-1 (]: 1 of 14 START sql view model public.stg_payment ................................ [RUN]
[0m15:15:40.850999 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.stg_payment"
[0m15:15:40.856953 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.stg_payment
[0m15:15:40.859244 [debug] [Thread-1 (]: Compiling model.test_dbt_project.stg_payment
[0m15:15:40.864059 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.stg_payment"
[0m15:15:40.897222 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:40.898857 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.stg_payment
[0m15:15:40.920757 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.stg_payment"
[0m15:15:40.967811 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:15:40.969685 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: BEGIN
[0m15:15:40.976508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:41.006214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:41.009140 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:15:41.012159 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */

  create view "postgres"."public"."stg_payment__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m15:15:41.044562 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m15:15:41.050976 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:15:41.053129 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
alter table "postgres"."public"."stg_payment__dbt_tmp" rename to "stg_payment"
[0m15:15:41.057354 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:41.067675 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m15:15:41.073678 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:15:41.075778 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m15:15:41.080119 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:41.085196 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:15:41.086887 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
drop view if exists "postgres"."public"."stg_payment__dbt_backup" cascade
[0m15:15:41.089505 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:15:41.091882 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:41.093843 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: Close
[0m15:15:41.096189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf9a65f0>]}
[0m15:15:41.097728 [info ] [Thread-1 (]: 1 of 14 OK created sql view model public.stg_payment ........................... [[32mCREATE VIEW[0m in 0.25s]
[0m15:15:41.101089 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.stg_payment
[0m15:15:41.103083 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m15:15:41.104840 [info ] [Thread-1 (]: 2 of 14 START seed file public.customer_base ................................... [RUN]
[0m15:15:41.106226 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.test_dbt_project.customer_base"
[0m15:15:41.107696 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m15:15:41.110625 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:41.112342 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m15:15:41.156081 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:15:41.158767 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m15:15:41.181836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:46.261716 [debug] [Thread-1 (]: SQL status: BEGIN in 5.08 seconds
[0m15:15:46.271290 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:15:46.274361 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */

    create table "postgres"."public"."customer_base" ("customer_id" integer,"store_id" integer,"first_name" text,"last_name" text,"email" text,"address_id" integer,"activebool" text,"create_date" date,"last_update" timestamp without time zone,"active" integer)
  
[0m15:15:46.305822 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.03 seconds
[0m15:15:46.790852 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:15:46.792986 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m15:15:46.848596 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.05 seconds
[0m15:15:46.855089 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m15:15:46.869049 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m15:15:46.870599 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:15:46.871964 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m15:15:46.875908 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:46.877731 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:46.880614 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m15:15:46.882518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef20250>]}
[0m15:15:46.884307 [info ] [Thread-1 (]: 2 of 14 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 5.78s]
[0m15:15:46.886665 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m15:15:46.888259 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:15:46.908708 [info ] [Thread-1 (]: 3 of 14 START test not_null_stg_payment_customer_id ............................ [RUN]
[0m15:15:46.911189 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:15:46.912717 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:15:46.914443 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:15:46.923034 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:15:46.937617 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:46.939328 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:15:46.951279 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:15:46.963827 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:15:46.965507 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: BEGIN
[0m15:15:46.967292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:46.993860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:46.995786 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:15:46.997145 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_payment"
where customer_id is null



      
    ) dbt_internal_test
[0m15:15:47.026070 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:15:47.030428 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.032369 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: ROLLBACK
[0m15:15:47.037256 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: Close
[0m15:15:47.039412 [info ] [Thread-1 (]: 3 of 14 PASS not_null_stg_payment_customer_id .................................. [[32mPASS[0m in 0.13s]
[0m15:15:47.041084 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:15:47.042909 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:15:47.046055 [info ] [Thread-1 (]: 4 of 14 START test not_null_stg_payment_payment_id ............................. [RUN]
[0m15:15:47.048187 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:15:47.049756 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:15:47.051084 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:15:47.055584 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:15:47.087041 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.091390 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:15:47.095835 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:15:47.108808 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:15:47.110628 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: BEGIN
[0m15:15:47.112087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:47.140916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:47.147585 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:15:47.150407 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payment"
where payment_id is null



      
    ) dbt_internal_test
[0m15:15:47.182439 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:15:47.186330 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.193755 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: ROLLBACK
[0m15:15:47.197124 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: Close
[0m15:15:47.199603 [info ] [Thread-1 (]: 4 of 14 PASS not_null_stg_payment_payment_id ................................... [[32mPASS[0m in 0.15s]
[0m15:15:47.203138 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:15:47.205697 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:15:47.208535 [info ] [Thread-1 (]: 5 of 14 START test unique_stg_payment_payment_id ............................... [RUN]
[0m15:15:47.210959 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:15:47.212833 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:15:47.214644 [debug] [Thread-1 (]: Compiling test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:15:47.221485 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:15:47.227454 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.231782 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:15:47.235246 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:15:47.263911 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:15:47.266283 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: BEGIN
[0m15:15:47.267985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:47.294403 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:47.296669 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:15:47.298215 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payment"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:15:47.387505 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.09 seconds
[0m15:15:47.395247 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.397398 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: ROLLBACK
[0m15:15:47.400325 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: Close
[0m15:15:47.402087 [info ] [Thread-1 (]: 5 of 14 PASS unique_stg_payment_payment_id ..................................... [[32mPASS[0m in 0.19s]
[0m15:15:47.404018 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:15:47.410089 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:15:47.411882 [info ] [Thread-1 (]: 6 of 14 START test not_null_customer_base_customer_id .......................... [RUN]
[0m15:15:47.413673 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:15:47.415273 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:15:47.416946 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:15:47.425354 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:15:47.437239 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.438978 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:15:47.443942 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:15:47.466907 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:15:47.468346 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m15:15:47.469864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:47.513963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m15:15:47.515946 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:15:47.518397 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m15:15:47.543602 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m15:15:47.548244 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.551775 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m15:15:47.561342 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: Close
[0m15:15:47.564208 [info ] [Thread-1 (]: 6 of 14 PASS not_null_customer_base_customer_id ................................ [[32mPASS[0m in 0.15s]
[0m15:15:47.567791 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:15:47.572290 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:15:47.575270 [info ] [Thread-1 (]: 7 of 14 START test not_null_customer_base_store_id ............................. [RUN]
[0m15:15:47.581708 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:15:47.583422 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:15:47.584818 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:15:47.588488 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:15:47.599290 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.600742 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:15:47.603221 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:15:47.607701 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:15:47.609361 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: BEGIN
[0m15:15:47.612282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:47.639236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:47.642379 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:15:47.643917 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m15:15:47.664915 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m15:15:47.669256 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.671243 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m15:15:47.674021 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: Close
[0m15:15:47.675994 [info ] [Thread-1 (]: 7 of 14 PASS not_null_customer_base_store_id ................................... [[32mPASS[0m in 0.09s]
[0m15:15:47.677808 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:15:47.700334 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m15:15:47.703070 [info ] [Thread-1 (]: 8 of 14 START sql view model public.int_revenue_by_date ........................ [RUN]
[0m15:15:47.706094 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.707536 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_revenue_by_date
[0m15:15:47.709175 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_revenue_by_date
[0m15:15:47.713557 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.726451 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.728452 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_revenue_by_date
[0m15:15:47.736668 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.749626 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.751441 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: BEGIN
[0m15:15:47.753027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:47.779314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:47.781736 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.783409 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    "postgres"."public"."stg_payment"
GROUP BY
    1
  );
[0m15:15:47.810811 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m15:15:47.814545 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.815972 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date__dbt_tmp" rename to "int_revenue_by_date"
[0m15:15:47.822866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:47.825855 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m15:15:47.827532 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.829238 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m15:15:47.832639 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:47.836548 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.837898 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
drop view if exists "postgres"."public"."int_revenue_by_date__dbt_backup" cascade
[0m15:15:47.840347 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:15:47.842632 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.844160 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: Close
[0m15:15:47.864903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface77a00>]}
[0m15:15:47.867143 [info ] [Thread-1 (]: 8 of 14 OK created sql view model public.int_revenue_by_date ................... [[32mCREATE VIEW[0m in 0.16s]
[0m15:15:47.869346 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m15:15:47.871536 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m15:15:47.873299 [info ] [Thread-1 (]: 9 of 14 START sql view model public.int_customers_per_store .................... [RUN]
[0m15:15:47.876228 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:15:47.877723 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m15:15:47.883862 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_customers_per_store
[0m15:15:47.887407 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m15:15:47.896927 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.899186 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m15:15:47.903343 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m15:15:47.913841 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:15:47.916196 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m15:15:47.917539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:47.943366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:47.945144 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:15:47.946677 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view "postgres"."public"."int_customers_per_store__dbt_tmp" as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    "postgres"."public"."customer_base"
GROUP BY
    1
  );
[0m15:15:47.974649 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m15:15:47.978552 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:15:47.980049 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store__dbt_tmp" rename to "int_customers_per_store"
[0m15:15:47.985658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:47.988149 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m15:15:47.989610 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:15:47.990819 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m15:15:47.995015 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:48.000290 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:15:48.001989 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
drop view if exists "postgres"."public"."int_customers_per_store__dbt_backup" cascade
[0m15:15:48.005033 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:15:48.007277 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.008575 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m15:15:48.029381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface71ea0>]}
[0m15:15:48.032847 [info ] [Thread-1 (]: 9 of 14 OK created sql view model public.int_customers_per_store ............... [[32mCREATE VIEW[0m in 0.15s]
[0m15:15:48.034639 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m15:15:48.036436 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m15:15:48.038713 [info ] [Thread-1 (]: 10 of 14 START sql table model public.cumulative_revenue ....................... [RUN]
[0m15:15:48.040718 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.046798 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.cumulative_revenue
[0m15:15:48.048346 [debug] [Thread-1 (]: Compiling model.test_dbt_project.cumulative_revenue
[0m15:15:48.051666 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.068647 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.070141 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.cumulative_revenue
[0m15:15:48.086921 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.096193 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.098054 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: BEGIN
[0m15:15:48.099431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:48.128403 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:48.132919 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.134617 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */

  
    

  create  table "postgres"."public"."cumulative_revenue__dbt_tmp"
  as (
    

SELECT
    payment_date,
    amount,
    SUM(amount) OVER (ORDER BY payment_date)
FROM
    "postgres"."public"."int_revenue_by_date"
ORDER BY
    payment_date
  );
  
[0m15:15:48.231304 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.09 seconds
[0m15:15:48.235151 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.238807 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue__dbt_tmp" rename to "cumulative_revenue"
[0m15:15:48.243011 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:48.246306 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m15:15:48.248215 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.250267 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m15:15:48.273086 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:48.276448 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.278107 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
drop table if exists "postgres"."public"."cumulative_revenue__dbt_backup" cascade
[0m15:15:48.280964 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:15:48.283185 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.284483 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: Close
[0m15:15:48.286214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface5e9b0>]}
[0m15:15:48.287576 [info ] [Thread-1 (]: 10 of 14 OK created sql table model public.cumulative_revenue .................. [[32mSELECT 40[0m in 0.25s]
[0m15:15:48.294431 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m15:15:48.296611 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:15:48.300171 [info ] [Thread-1 (]: 11 of 14 START test not_null_int_customers_per_store_store_id .................. [RUN]
[0m15:15:48.302434 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:15:48.304366 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:15:48.310333 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:15:48.314637 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:15:48.332653 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.335189 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:15:48.338958 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:15:48.352798 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:15:48.354703 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m15:15:48.356577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:48.385342 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:48.391582 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:15:48.394341 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."int_customers_per_store"
where store_id is null



      
    ) dbt_internal_test
[0m15:15:48.427221 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:15:48.450793 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.455356 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m15:15:48.458254 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m15:15:48.460118 [info ] [Thread-1 (]: 11 of 14 PASS not_null_int_customers_per_store_store_id ........................ [[32mPASS[0m in 0.16s]
[0m15:15:48.467144 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:15:48.468944 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:15:48.470954 [info ] [Thread-1 (]: 12 of 14 START test not_null_int_customers_per_store_total_customers ........... [RUN]
[0m15:15:48.473084 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:15:48.479612 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:15:48.481762 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:15:48.487869 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:15:48.500897 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.503629 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:15:48.506858 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:15:48.513342 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:15:48.516543 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m15:15:48.518304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:48.544692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:48.547139 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:15:48.549370 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_customers
from "postgres"."public"."int_customers_per_store"
where total_customers is null



      
    ) dbt_internal_test
[0m15:15:48.579939 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:15:48.583042 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.584440 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m15:15:48.587587 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m15:15:48.590157 [info ] [Thread-1 (]: 12 of 14 PASS not_null_int_customers_per_store_total_customers ................. [[32mPASS[0m in 0.12s]
[0m15:15:48.611894 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:15:48.616837 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:15:48.618421 [info ] [Thread-1 (]: 13 of 14 START test unique_int_customers_per_store_store_id .................... [RUN]
[0m15:15:48.620189 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:15:48.621767 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:15:48.623932 [debug] [Thread-1 (]: Compiling test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:15:48.629047 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:15:48.639716 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.642694 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:15:48.647327 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:15:48.659361 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:15:48.661938 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m15:15:48.669011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:48.697326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:48.699840 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:15:48.701536 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "postgres"."public"."int_customers_per_store"
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:15:48.732482 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:15:48.735898 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.738034 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m15:15:48.740976 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m15:15:48.742727 [info ] [Thread-1 (]: 13 of 14 PASS unique_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.12s]
[0m15:15:48.746643 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:15:48.748735 [debug] [Thread-1 (]: Began running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:15:48.750710 [info ] [Thread-1 (]: 14 of 14 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot  [RUN]
[0m15:15:48.752704 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:15:48.754193 [debug] [Thread-1 (]: Began compiling node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:15:48.757332 [debug] [Thread-1 (]: Compiling snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:15:48.761284 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.763682 [debug] [Thread-1 (]: Began executing node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:15:48.792037 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:15:48.821661 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:15:48.823382 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m15:15:48.825383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:48.858093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:48.860399 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:15:48.862160 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      
  
    

  create  table "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(store_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to
    from (
        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"

    ) sbq



  );
  
  
[0m15:15:48.916985 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.05 seconds
[0m15:15:48.921254 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m15:15:48.926872 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:15:48.928575 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m15:15:48.934571 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:48.936901 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.942702 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m15:15:48.944718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface6d450>]}
[0m15:15:48.946528 [info ] [Thread-1 (]: 14 of 14 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot  [[32mSELECT 2[0m in 0.19s]
[0m15:15:48.948270 [debug] [Thread-1 (]: Finished running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:15:48.952332 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:15:48.954356 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:48.955901 [debug] [MainThread]: On master: BEGIN
[0m15:15:48.957431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:48.984813 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m15:15:48.988235 [debug] [MainThread]: On master: COMMIT
[0m15:15:48.990227 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:48.991836 [debug] [MainThread]: On master: COMMIT
[0m15:15:48.994007 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:15:48.995772 [debug] [MainThread]: On master: Close
[0m15:15:48.998920 [info ] [MainThread]: 
[0m15:15:49.001930 [info ] [MainThread]: Finished running 3 view models, 1 seed, 8 tests, 1 table model, 1 snapshot in 0 hours 0 minutes and 13.62 seconds (13.62s).
[0m15:15:49.004007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:49.005815 [debug] [MainThread]: Connection 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m15:15:49.068056 [info ] [MainThread]: 
[0m15:15:49.069416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:49.071055 [info ] [MainThread]: 
[0m15:15:49.072284 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m15:15:49.073927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa9b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa4d000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf982e90>]}
[0m15:15:49.075504 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 15:27:54.534046 | f3144c56-4040-4651-ab93-b75524c48e8b ==============================
[0m15:27:54.534059 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:27:54.535260 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m15:27:54.538040 [debug] [MainThread]: Tracking: tracking
[0m15:27:54.542639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b21ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b21c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b21c30>]}
[0m15:27:54.545363 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jgez9p_0'
[0m15:27:54.546951 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:27:55.348917 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:27:55.361289 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:27:56.061711 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:27:56.124555 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:28:01.585675 [info ] [MainThread]:   Installed from version 1.0.0
[0m15:28:01.587382 [info ] [MainThread]:   Up to date!
[0m15:28:01.588935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3144c56-4040-4651-ab93-b75524c48e8b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b21360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b992a0>]}
[0m15:28:01.590772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ba3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b992a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b993f0>]}
[0m15:28:01.592658 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 15:28:04.064324 | d9cfa442-9e49-4804-b45b-4269f47ef412 ==============================
[0m15:28:04.064343 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:28:04.065893 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m15:28:04.068635 [debug] [MainThread]: Tracking: tracking
[0m15:28:04.080783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d97b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d97c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d97bb0>]}
[0m15:28:04.568331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:28:04.570198 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:28:04.576241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9910a3e0>]}
[0m15:28:04.617290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990ccfa0>]}
[0m15:28:04.639091 [info ] [MainThread]: Found 4 models, 8 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m15:28:04.641334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990cce80>]}
[0m15:28:04.644285 [info ] [MainThread]: 
[0m15:28:04.646294 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:28:04.648539 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m15:28:04.656359 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:28:04.657863 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:28:04.659964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:04.717476 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.06 seconds
[0m15:28:04.719918 [debug] [ThreadPool]: On list_postgres: Close
[0m15:28:04.722482 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m15:28:04.727506 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:28:04.733011 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:28:04.734460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:09.806590 [debug] [ThreadPool]: SQL status: BEGIN in 5.07 seconds
[0m15:28:09.810231 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:28:09.814672 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:28:09.865751 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.05 seconds
[0m15:28:09.869034 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:28:09.872005 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:28:09.879091 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:09.881144 [debug] [MainThread]: On master: BEGIN
[0m15:28:09.882990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:28:09.908792 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m15:28:09.911168 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:09.932025 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:28:10.011199 [debug] [MainThread]: SQL status: SELECT 46 in 0.08 seconds
[0m15:28:10.016364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f5f640>]}
[0m15:28:10.019121 [debug] [MainThread]: On master: ROLLBACK
[0m15:28:10.021663 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:10.023467 [debug] [MainThread]: On master: BEGIN
[0m15:28:10.030165 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:28:10.032153 [debug] [MainThread]: On master: COMMIT
[0m15:28:10.033576 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:10.034936 [debug] [MainThread]: On master: COMMIT
[0m15:28:10.036953 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:28:10.043125 [debug] [MainThread]: On master: Close
[0m15:28:10.045834 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:28:10.048378 [info ] [MainThread]: 
[0m15:28:10.054979 [debug] [Thread-1 (]: Began running node model.test_dbt_project.stg_payment
[0m15:28:10.057917 [info ] [Thread-1 (]: 1 of 14 START sql view model public.stg_payment ................................ [RUN]
[0m15:28:10.065114 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.stg_payment"
[0m15:28:10.067106 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.stg_payment
[0m15:28:10.069648 [debug] [Thread-1 (]: Compiling model.test_dbt_project.stg_payment
[0m15:28:10.075861 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.stg_payment"
[0m15:28:10.081600 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:10.084543 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.stg_payment
[0m15:28:10.104637 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.stg_payment"
[0m15:28:10.113469 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:28:10.115386 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: BEGIN
[0m15:28:10.117027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:10.143828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:10.163857 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:28:10.166007 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */

  create view "postgres"."public"."stg_payment__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m15:28:10.195197 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m15:28:10.201138 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:28:10.203425 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
alter table "postgres"."public"."stg_payment" rename to "stg_payment__dbt_backup"
[0m15:28:10.207042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:10.210311 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:28:10.211877 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
alter table "postgres"."public"."stg_payment__dbt_tmp" rename to "stg_payment"
[0m15:28:10.220002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:10.231613 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m15:28:10.233964 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:28:10.235343 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m15:28:10.243456 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:10.247752 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:28:10.249297 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
drop view if exists "postgres"."public"."stg_payment__dbt_backup" cascade
[0m15:28:10.260240 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m15:28:10.262389 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:10.267789 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: Close
[0m15:28:10.269541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98fbe140>]}
[0m15:28:10.271159 [info ] [Thread-1 (]: 1 of 14 OK created sql view model public.stg_payment ........................... [[32mCREATE VIEW[0m in 0.20s]
[0m15:28:10.273022 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.stg_payment
[0m15:28:10.275138 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m15:28:10.276817 [info ] [Thread-1 (]: 2 of 14 START seed file public.customer_base ................................... [RUN]
[0m15:28:10.278917 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.test_dbt_project.customer_base"
[0m15:28:10.280286 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m15:28:10.282101 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:10.284742 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m15:28:10.323456 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:28:10.325489 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m15:28:10.327741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:10.356106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:10.358772 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:28:10.360501 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */
truncate table "postgres"."public"."customer_base"
[0m15:28:10.378241 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.02 seconds
[0m15:28:10.888774 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:28:10.891362 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m15:28:10.945514 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.05 seconds
[0m15:28:10.951343 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m15:28:10.964232 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m15:28:10.966297 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:28:10.967808 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m15:28:10.979399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:10.981986 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:10.983660 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m15:28:10.985322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f5dea0>]}
[0m15:28:10.991242 [info ] [Thread-1 (]: 2 of 14 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 0.71s]
[0m15:28:10.993320 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m15:28:10.994557 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:28:10.996112 [info ] [Thread-1 (]: 3 of 14 START test not_null_stg_payment_customer_id ............................ [RUN]
[0m15:28:10.997993 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:28:10.999244 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:28:11.000853 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:28:11.009803 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:28:11.017518 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:11.019102 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:28:11.027489 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:28:11.035279 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:28:11.036893 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: BEGIN
[0m15:28:11.056962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:11.082971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:11.084832 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:28:11.086295 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_payment"
where customer_id is null



      
    ) dbt_internal_test
[0m15:28:11.115086 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:28:11.118637 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:11.120660 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: ROLLBACK
[0m15:28:11.127640 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: Close
[0m15:28:11.130473 [info ] [Thread-1 (]: 3 of 14 PASS not_null_stg_payment_customer_id .................................. [[32mPASS[0m in 0.13s]
[0m15:28:11.132565 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:28:11.134504 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:28:11.136194 [info ] [Thread-1 (]: 4 of 14 START test not_null_stg_payment_payment_id ............................. [RUN]
[0m15:28:11.142203 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:28:11.144090 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:28:11.146355 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:28:11.150147 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:28:11.159911 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:11.161389 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:28:11.164024 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:28:11.169292 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:28:11.170732 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: BEGIN
[0m15:28:11.173234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:11.200073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:11.202698 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:28:11.204257 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payment"
where payment_id is null



      
    ) dbt_internal_test
[0m15:28:11.232346 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:28:11.236561 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:11.238090 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: ROLLBACK
[0m15:28:11.240225 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: Close
[0m15:28:11.242002 [info ] [Thread-1 (]: 4 of 14 PASS not_null_stg_payment_payment_id ................................... [[32mPASS[0m in 0.10s]
[0m15:28:11.243946 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:28:11.266338 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:28:11.268034 [info ] [Thread-1 (]: 5 of 14 START test unique_stg_payment_payment_id ............................... [RUN]
[0m15:28:11.270541 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:28:11.272176 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:28:11.273776 [debug] [Thread-1 (]: Compiling test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:28:11.279207 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:28:11.291756 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:11.293318 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:28:11.296164 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:28:11.305662 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:28:11.307050 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: BEGIN
[0m15:28:11.312653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:16.383565 [debug] [Thread-1 (]: SQL status: BEGIN in 5.07 seconds
[0m15:28:16.388084 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:28:16.391815 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payment"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:28:16.477606 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.08 seconds
[0m15:28:16.482896 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.484811 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: ROLLBACK
[0m15:28:16.487680 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: Close
[0m15:28:16.489876 [info ] [Thread-1 (]: 5 of 14 PASS unique_stg_payment_payment_id ..................................... [[32mPASS[0m in 5.22s]
[0m15:28:16.492350 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:28:16.513871 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:28:16.515672 [info ] [Thread-1 (]: 6 of 14 START test not_null_customer_base_customer_id .......................... [RUN]
[0m15:28:16.518350 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:28:16.520357 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:28:16.522210 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:28:16.527175 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:28:16.540655 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.542183 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:28:16.545790 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:28:16.553529 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:28:16.559042 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m15:28:16.560617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:16.586127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:16.588126 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:28:16.589850 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m15:28:16.611328 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m15:28:16.614279 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.616177 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m15:28:16.618860 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: Close
[0m15:28:16.620320 [info ] [Thread-1 (]: 6 of 14 PASS not_null_customer_base_customer_id ................................ [[32mPASS[0m in 0.10s]
[0m15:28:16.624567 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:28:16.626602 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:28:16.628158 [info ] [Thread-1 (]: 7 of 14 START test not_null_customer_base_store_id ............................. [RUN]
[0m15:28:16.630181 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:28:16.632971 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:28:16.634527 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:28:16.638165 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:28:16.663173 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.665705 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:28:16.669061 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:28:16.674785 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:28:16.680678 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: BEGIN
[0m15:28:16.682171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:16.707296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:16.709168 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:28:16.710926 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m15:28:16.736035 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m15:28:16.738799 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.740445 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m15:28:16.742727 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: Close
[0m15:28:16.744496 [info ] [Thread-1 (]: 7 of 14 PASS not_null_customer_base_store_id ................................... [[32mPASS[0m in 0.11s]
[0m15:28:16.751073 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:28:16.753263 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m15:28:16.754805 [info ] [Thread-1 (]: 8 of 14 START sql view model public.int_revenue_by_date ........................ [RUN]
[0m15:28:16.756462 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.757946 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_revenue_by_date
[0m15:28:16.759393 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_revenue_by_date
[0m15:28:16.762585 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.769517 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.771614 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_revenue_by_date
[0m15:28:16.775949 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.783999 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.786382 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: BEGIN
[0m15:28:16.787703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:16.832106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m15:28:16.834520 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.836197 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    "postgres"."public"."stg_payment"
GROUP BY
    1
  );
[0m15:28:16.864289 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m15:28:16.868301 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.870154 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date__dbt_tmp" rename to "int_revenue_by_date"
[0m15:28:16.874538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:16.881434 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m15:28:16.882983 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.884509 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m15:28:16.888624 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:16.890877 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.896240 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
drop view if exists "postgres"."public"."int_revenue_by_date__dbt_backup" cascade
[0m15:28:16.899351 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:28:16.901737 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.903313 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: Close
[0m15:28:16.904922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff986d7490>]}
[0m15:28:16.912155 [info ] [Thread-1 (]: 8 of 14 OK created sql view model public.int_revenue_by_date ................... [[32mCREATE VIEW[0m in 0.15s]
[0m15:28:16.914538 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m15:28:16.916142 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m15:28:16.917693 [info ] [Thread-1 (]: 9 of 14 START sql view model public.int_customers_per_store .................... [RUN]
[0m15:28:16.919532 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:28:16.921002 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m15:28:16.922272 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_customers_per_store
[0m15:28:16.926488 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m15:28:16.933730 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.935449 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m15:28:16.939288 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m15:28:16.946508 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:28:16.948508 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m15:28:16.949765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:16.994025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m15:28:16.995973 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:28:16.997793 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view "postgres"."public"."int_customers_per_store__dbt_tmp" as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    "postgres"."public"."customer_base"
GROUP BY
    1
  );
[0m15:28:17.024979 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m15:28:17.028552 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:28:17.030156 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store" rename to "int_customers_per_store__dbt_backup"
[0m15:28:17.033383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:17.036064 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:28:17.042454 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store__dbt_tmp" rename to "int_customers_per_store"
[0m15:28:17.046294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:17.048801 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m15:28:17.050216 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:28:17.051731 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m15:28:17.060355 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:17.063311 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:28:17.064809 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
drop view if exists "postgres"."public"."int_customers_per_store__dbt_backup" cascade
[0m15:28:17.071952 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m15:28:17.074244 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.079562 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m15:28:17.082139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bd7bb20>]}
[0m15:28:17.085130 [info ] [Thread-1 (]: 9 of 14 OK created sql view model public.int_customers_per_store ............... [[32mCREATE VIEW[0m in 0.16s]
[0m15:28:17.087089 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m15:28:17.088614 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m15:28:17.090113 [info ] [Thread-1 (]: 10 of 14 START sql table model public.cumulative_revenue ....................... [RUN]
[0m15:28:17.091917 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.093646 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.cumulative_revenue
[0m15:28:17.095934 [debug] [Thread-1 (]: Compiling model.test_dbt_project.cumulative_revenue
[0m15:28:17.100624 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.106972 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.110069 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.cumulative_revenue
[0m15:28:17.123603 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.149990 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.151980 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: BEGIN
[0m15:28:17.153952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:17.180060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:17.182584 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.184818 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */

  
    

  create  table "postgres"."public"."cumulative_revenue__dbt_tmp"
  as (
    

SELECT
    payment_date,
    amount,
    SUM(amount) OVER (ORDER BY payment_date)
FROM
    "postgres"."public"."int_revenue_by_date"
ORDER BY
    payment_date
  );
  
[0m15:28:17.278230 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.09 seconds
[0m15:28:17.285680 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.288748 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue" rename to "cumulative_revenue__dbt_backup"
[0m15:28:17.294060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:17.299740 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.304593 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue__dbt_tmp" rename to "cumulative_revenue"
[0m15:28:17.309364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:17.315655 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m15:28:17.319320 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.325826 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m15:28:17.332562 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:17.338511 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.342055 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
drop table if exists "postgres"."public"."cumulative_revenue__dbt_backup" cascade
[0m15:28:17.353012 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m15:28:17.356501 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.358294 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: Close
[0m15:28:17.360368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bd92ce0>]}
[0m15:28:17.366739 [info ] [Thread-1 (]: 10 of 14 OK created sql table model public.cumulative_revenue .................. [[32mSELECT 40[0m in 0.27s]
[0m15:28:17.371626 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m15:28:17.373355 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:28:17.375243 [info ] [Thread-1 (]: 11 of 14 START test not_null_int_customers_per_store_store_id .................. [RUN]
[0m15:28:17.378108 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:28:17.382330 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:28:17.384318 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:28:17.389043 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:28:17.415098 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.417052 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:28:17.420203 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:28:17.432836 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:28:17.434342 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m15:28:17.435731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:17.460196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m15:28:17.466561 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:28:17.468688 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."int_customers_per_store"
where store_id is null



      
    ) dbt_internal_test
[0m15:28:17.496948 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:28:17.500154 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.505871 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m15:28:17.508262 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m15:28:17.509999 [info ] [Thread-1 (]: 11 of 14 PASS not_null_int_customers_per_store_store_id ........................ [[32mPASS[0m in 0.13s]
[0m15:28:17.511893 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:28:17.513573 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:28:17.515117 [info ] [Thread-1 (]: 12 of 14 START test not_null_int_customers_per_store_total_customers ........... [RUN]
[0m15:28:17.516984 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:28:17.518478 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:28:17.520212 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:28:17.524012 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:28:17.530850 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.533144 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:28:17.537298 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:28:17.544064 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:28:17.564371 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m15:28:17.566542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:17.594349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:17.596971 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:28:17.599220 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_customers
from "postgres"."public"."int_customers_per_store"
where total_customers is null



      
    ) dbt_internal_test
[0m15:28:17.626607 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:28:17.629460 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.632006 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m15:28:17.639520 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m15:28:17.641548 [info ] [Thread-1 (]: 12 of 14 PASS not_null_int_customers_per_store_total_customers ................. [[32mPASS[0m in 0.12s]
[0m15:28:17.643096 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:28:17.645062 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:28:17.650611 [info ] [Thread-1 (]: 13 of 14 START test unique_int_customers_per_store_store_id .................... [RUN]
[0m15:28:17.652764 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:28:17.654246 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:28:17.656109 [debug] [Thread-1 (]: Compiling test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:28:17.659853 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:28:17.669737 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.671309 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:28:17.675065 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:28:17.680750 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:28:17.682222 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m15:28:17.684822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:17.710706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:17.712801 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:28:17.714296 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "postgres"."public"."int_customers_per_store"
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:28:17.746290 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:28:17.749198 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.750756 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m15:28:17.753859 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m15:28:17.756690 [info ] [Thread-1 (]: 13 of 14 PASS unique_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.10s]
[0m15:28:17.778881 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:28:17.781487 [debug] [Thread-1 (]: Began running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:28:17.783531 [info ] [Thread-1 (]: 14 of 14 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot  [RUN]
[0m15:28:17.785755 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:17.787961 [debug] [Thread-1 (]: Began compiling node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:28:17.789553 [debug] [Thread-1 (]: Compiling snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:28:17.792812 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.798915 [debug] [Thread-1 (]: Began executing node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:28:17.826312 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:17.828798 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select * from (
            select total_customers from (

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"
) subq
        ) as __dbt_sbq
        where false
        limit 0
    
[0m15:28:17.830642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:17.868822 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.04 seconds
[0m15:28:17.878836 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:17.880478 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m15:28:17.882947 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:28:17.884783 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:17.886313 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m15:28:17.970976 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.08 seconds
[0m15:28:17.977878 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:17.979618 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m15:28:17.995816 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m15:28:18.006185 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.007594 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        
  
    

  create temporary table "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp152818002346"
  as (
    with snapshot_query as (

        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"


    ),

    snapshotted_data as (

        select *,
            store_id as dbt_unique_key

        from "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(store_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            store_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:28:18.050356 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.04 seconds
[0m15:28:18.056480 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.058320 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp152818002346'
        
      order by ordinal_position

  
[0m15:28:18.078025 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m15:28:18.082331 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.084098 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m15:28:18.102703 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.02 seconds
[0m15:28:18.106691 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.108623 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp152818002346'
        
      order by ordinal_position

  
[0m15:28:18.145344 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m15:28:18.149627 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.151060 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m15:28:18.167061 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m15:28:18.173043 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.175452 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp152818002346'
        
      order by ordinal_position

  
[0m15:28:18.193805 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.01 seconds
[0m15:28:18.199128 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.211828 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.213624 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      update "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp152818002346" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_valid_to is null;

    insert into "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot" ("store_id", "total_customers", "current_date", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."store_id",DBT_INTERNAL_SOURCE."total_customers",DBT_INTERNAL_SOURCE."current_date",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp152818002346" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:28:18.222205 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.01 seconds
[0m15:28:18.224993 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m15:28:18.226628 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.228755 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m15:28:18.233522 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:18.236817 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:18.238307 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m15:28:18.240499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be2f4c0>]}
[0m15:28:18.243015 [info ] [Thread-1 (]: 14 of 14 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot  [[32mINSERT 0 0[0m in 0.45s]
[0m15:28:18.246668 [debug] [Thread-1 (]: Finished running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:28:18.249933 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:28:18.251724 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:18.253397 [debug] [MainThread]: On master: BEGIN
[0m15:28:18.254952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:28:18.283993 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m15:28:18.286695 [debug] [MainThread]: On master: COMMIT
[0m15:28:18.288512 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:18.290303 [debug] [MainThread]: On master: COMMIT
[0m15:28:18.311972 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:28:18.313985 [debug] [MainThread]: On master: Close
[0m15:28:18.316770 [info ] [MainThread]: 
[0m15:28:18.318971 [info ] [MainThread]: Finished running 3 view models, 1 seed, 8 tests, 1 table model, 1 snapshot in 0 hours 0 minutes and 13.67 seconds (13.67s).
[0m15:28:18.321908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:18.324857 [debug] [MainThread]: Connection 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m15:28:18.385881 [info ] [MainThread]: 
[0m15:28:18.388324 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:28:18.390553 [info ] [MainThread]: 
[0m15:28:18.392454 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m15:28:18.394445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f4c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f4cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be29c60>]}
[0m15:28:18.396809 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 17:12:32.067212 | 67e56086-9d7c-402f-a7b3-f00f2e547afd ==============================
[0m17:12:32.067229 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:12:32.068629 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/original_dbt', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m17:12:32.070621 [debug] [MainThread]: Tracking: tracking
[0m17:12:32.075159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2535c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2535d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2535cc0>]}
[0m17:12:32.081901 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gq__6ymw'
[0m17:12:32.083567 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:12:32.824734 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:12:32.832293 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:12:33.496899 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:12:33.560589 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:12:39.175045 [info ] [MainThread]:   Installed from version 1.0.0
[0m17:12:39.176926 [info ] [MainThread]:   Up to date!
[0m17:12:39.179655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '67e56086-9d7c-402f-a7b3-f00f2e547afd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25ad3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25ad2d0>]}
[0m17:12:39.181742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa26f5600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25ad450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25ad330>]}
[0m17:12:39.183447 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 17:15:45.971831 | c32a6fca-c10e-4ac3-9bfd-81e1ddf62104 ==============================
[0m17:15:45.971844 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:15:45.973415 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/original_dbt', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m17:15:45.975539 [debug] [MainThread]: Tracking: tracking
[0m17:15:45.979072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabbfbbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabbfa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabbfaa10>]}
[0m17:15:46.086597 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:15:46.089097 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:15:46.092873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c32a6fca-c10e-4ac3-9bfd-81e1ddf62104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabbfb3d0>]}
[0m17:15:46.542978 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m17:15:46.546086 [debug] [MainThread]: Parsing macros/relations.sql
[0m17:15:46.548143 [debug] [MainThread]: Parsing macros/adapters.sql
[0m17:15:46.561355 [debug] [MainThread]: Parsing macros/catalog.sql
[0m17:15:46.568581 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:15:46.571586 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:15:46.573433 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:15:46.578762 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:15:46.590173 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:15:46.593442 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:15:46.596122 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m17:15:46.602774 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m17:15:46.605557 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m17:15:46.615351 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m17:15:46.619038 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:15:46.621788 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:15:46.625907 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m17:15:46.630403 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m17:15:46.634398 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m17:15:46.637634 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:15:46.641626 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m17:15:46.643701 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m17:15:46.667678 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:15:46.670479 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m17:15:46.675285 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m17:15:46.677242 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m17:15:46.679978 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m17:15:46.682462 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m17:15:46.684868 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m17:15:46.686605 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:15:46.693835 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m17:15:46.696130 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m17:15:46.698307 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:15:46.700490 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m17:15:46.702546 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m17:15:46.704525 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m17:15:46.710836 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m17:15:46.712826 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m17:15:46.718620 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m17:15:46.720680 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m17:15:46.725132 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m17:15:46.731967 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m17:15:46.734894 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m17:15:46.742478 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m17:15:46.745156 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m17:15:46.753467 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m17:15:46.756848 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m17:15:46.760343 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m17:15:46.762223 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m17:15:46.764541 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m17:15:46.768652 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m17:15:46.774134 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m17:15:46.776834 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m17:15:46.779862 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m17:15:46.787025 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m17:15:46.789592 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m17:15:46.798274 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m17:15:46.819219 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m17:15:46.823493 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m17:15:46.826614 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m17:15:46.828980 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m17:15:46.835347 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m17:15:46.844157 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m17:15:46.850519 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m17:15:46.865254 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m17:15:46.869928 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m17:15:46.873177 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m17:15:46.878022 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m17:15:46.880897 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m17:15:46.887497 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m17:15:46.889944 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m17:15:46.893702 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m17:15:46.895872 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m17:15:46.900865 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m17:15:46.911818 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m17:15:46.914458 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m17:15:46.916189 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m17:15:46.918070 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m17:15:46.919771 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m17:15:46.922260 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m17:15:46.925264 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m17:15:46.927581 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m17:15:46.930018 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m17:15:46.933500 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m17:15:46.936966 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m17:15:46.940762 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m17:15:46.944604 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m17:15:46.950622 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m17:15:46.952940 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m17:15:46.955428 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m17:15:46.978660 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m17:15:46.982146 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m17:15:46.985532 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m17:15:46.987876 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m17:15:46.991359 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m17:15:46.994209 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m17:15:46.996866 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m17:15:46.998648 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m17:15:47.006204 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m17:15:47.008675 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m17:15:47.010627 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m17:15:47.012555 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m17:15:47.017659 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m17:15:47.025443 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m17:15:47.029233 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m17:15:47.032077 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m17:15:47.036258 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m17:15:47.039223 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m17:15:47.045562 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m17:15:47.048453 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m17:15:47.051955 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m17:15:47.054471 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m17:15:47.056403 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m17:15:47.062042 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m17:15:47.064416 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m17:15:47.066413 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m17:15:47.070522 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m17:15:47.073016 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m17:15:47.077294 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m17:15:47.080790 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m17:15:47.083348 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m17:15:47.085326 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m17:15:47.089260 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m17:15:47.112452 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m17:15:47.120400 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m17:15:47.124720 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m17:15:47.128753 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m17:15:47.131186 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m17:15:47.133578 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m17:15:47.278425 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m17:15:47.286948 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m17:15:47.290074 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m17:15:47.293828 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payment.sql
[0m17:15:47.353280 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m17:15:47.367628 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_int_customers_per_store_snapshot_total_customers.6745de9a0e' (snapshots/_snapshots.yml) depends on a node named 'int_customers_per_store_snapshot' which was not found
[0m17:15:47.434749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c32a6fca-c10e-4ac3-9bfd-81e1ddf62104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf22950>]}
[0m17:15:47.476051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c32a6fca-c10e-4ac3-9bfd-81e1ddf62104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabd1eef0>]}
[0m17:15:47.479656 [info ] [MainThread]: Found 4 models, 8 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m17:15:47.481229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c32a6fca-c10e-4ac3-9bfd-81e1ddf62104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaafb8f10>]}
[0m17:15:47.483454 [info ] [MainThread]: 
[0m17:15:47.485462 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:15:47.507952 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m17:15:47.515740 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:15:47.519029 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:15:47.520850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:47.571771 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.05 seconds
[0m17:15:47.574779 [debug] [ThreadPool]: On list_postgres: Close
[0m17:15:47.577321 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:15:47.587349 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:15:47.589659 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:15:47.590980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:47.618076 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m17:15:47.624364 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:15:47.626408 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:15:47.679343 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.05 seconds
[0m17:15:47.683842 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:15:47.687660 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:15:47.697621 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:47.701227 [debug] [MainThread]: On master: BEGIN
[0m17:15:47.704594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:47.735357 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m17:15:47.739541 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:47.742649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:15:47.849009 [debug] [MainThread]: SQL status: SELECT 46 in 0.1 seconds
[0m17:15:47.852829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c32a6fca-c10e-4ac3-9bfd-81e1ddf62104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf8f190>]}
[0m17:15:47.855548 [debug] [MainThread]: On master: ROLLBACK
[0m17:15:47.858168 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:47.882934 [debug] [MainThread]: On master: BEGIN
[0m17:15:47.885787 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:15:47.887432 [debug] [MainThread]: On master: COMMIT
[0m17:15:47.888806 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:47.889936 [debug] [MainThread]: On master: COMMIT
[0m17:15:47.897403 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:15:47.899119 [debug] [MainThread]: On master: Close
[0m17:15:47.901007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:15:47.902699 [info ] [MainThread]: 
[0m17:15:47.911761 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m17:15:47.913630 [info ] [Thread-1 (]: 1 of 1 START seed file public.customer_base .................................... [RUN]
[0m17:15:47.915549 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.test_dbt_project.customer_base"
[0m17:15:47.917190 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m17:15:47.918932 [debug] [Thread-1 (]: finished collecting timing info
[0m17:15:47.925920 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m17:15:47.965328 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m17:15:47.967348 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m17:15:47.969025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:47.994838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:15:47.997105 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m17:15:47.999118 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */
truncate table "postgres"."public"."customer_base"
[0m17:15:48.017226 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.02 seconds
[0m17:15:48.525923 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m17:15:48.527909 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m17:15:48.582872 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.05 seconds
[0m17:15:48.588785 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m17:15:48.628653 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m17:15:48.630485 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m17:15:48.632084 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m17:15:48.645066 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m17:15:48.648283 [debug] [Thread-1 (]: finished collecting timing info
[0m17:15:48.650854 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m17:15:48.653642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32a6fca-c10e-4ac3-9bfd-81e1ddf62104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf0a5f0>]}
[0m17:15:48.657662 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.customer_base ................................ [[32mINSERT 599[0m in 0.74s]
[0m17:15:48.665358 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m17:15:48.670047 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:15:48.671925 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:48.673752 [debug] [MainThread]: On master: BEGIN
[0m17:15:48.678854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:53.757972 [debug] [MainThread]: SQL status: BEGIN in 5.08 seconds
[0m17:15:53.763517 [debug] [MainThread]: On master: COMMIT
[0m17:15:53.766166 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:53.768098 [debug] [MainThread]: On master: COMMIT
[0m17:15:53.770929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:15:53.772617 [debug] [MainThread]: On master: Close
[0m17:15:53.796836 [info ] [MainThread]: 
[0m17:15:53.800281 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.31 seconds (6.31s).
[0m17:15:53.802206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:53.804357 [debug] [MainThread]: Connection 'seed.test_dbt_project.customer_base' was properly closed.
[0m17:15:53.874974 [info ] [MainThread]: 
[0m17:15:53.876844 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:15:53.881193 [info ] [MainThread]: 
[0m17:15:53.882829 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:15:53.885266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa630280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6302b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab007520>]}
[0m17:15:53.887632 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 17:16:24.558330 | 4fad642d-40cd-417b-b463-e46b6792cb1e ==============================
[0m17:16:24.558340 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:16:24.560205 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/original_dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:16:24.561980 [debug] [MainThread]: Tracking: tracking
[0m17:16:24.570035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb76b3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb76b2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb76b29b0>]}
[0m17:16:24.793768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:24.795411 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:24.801290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6a36410>]}
[0m17:16:24.861331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb69fd0f0>]}
[0m17:16:24.868948 [info ] [MainThread]: Found 4 models, 8 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m17:16:24.875187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb69fceb0>]}
[0m17:16:24.878469 [info ] [MainThread]: 
[0m17:16:24.880390 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:16:24.882798 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m17:16:24.892482 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:16:24.895269 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:16:24.898095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:24.947843 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.05 seconds
[0m17:16:24.953289 [debug] [ThreadPool]: On list_postgres: Close
[0m17:16:24.957181 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:16:24.962338 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:16:24.964619 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:16:24.966209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:24.994792 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m17:16:24.997230 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:16:24.999464 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:16:25.047215 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.05 seconds
[0m17:16:25.050614 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:16:25.053284 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:16:25.058412 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:25.060419 [debug] [MainThread]: On master: BEGIN
[0m17:16:25.067555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:30.144111 [debug] [MainThread]: SQL status: BEGIN in 5.08 seconds
[0m17:16:30.151675 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:30.153761 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:30.240026 [debug] [MainThread]: SQL status: SELECT 46 in 0.08 seconds
[0m17:16:30.245226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb688b820>]}
[0m17:16:30.247213 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:30.250061 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:30.252043 [debug] [MainThread]: On master: BEGIN
[0m17:16:30.255729 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:16:30.257982 [debug] [MainThread]: On master: COMMIT
[0m17:16:30.259624 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:30.261123 [debug] [MainThread]: On master: COMMIT
[0m17:16:30.262884 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:16:30.284852 [debug] [MainThread]: On master: Close
[0m17:16:30.287324 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:30.289300 [info ] [MainThread]: 
[0m17:16:30.297247 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m17:16:30.304304 [info ] [Thread-1 (]: 1 of 4 START sql view model public.int_customers_per_store ..................... [RUN]
[0m17:16:30.306949 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.309650 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m17:16:30.316743 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_customers_per_store
[0m17:16:30.320199 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.334843 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:30.336657 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m17:16:30.357413 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.368223 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.369450 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m17:16:30.370642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:30.397665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:16:30.399429 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.401349 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view "postgres"."public"."int_customers_per_store__dbt_tmp" as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    "postgres"."public"."customer_base"
GROUP BY
    1
  );
[0m17:16:30.429940 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m17:16:30.437039 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.442077 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store" rename to "int_customers_per_store__dbt_backup"
[0m17:16:30.446373 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:30.449595 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.473890 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store__dbt_tmp" rename to "int_customers_per_store"
[0m17:16:30.479388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:30.491980 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m17:16:30.494278 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.496396 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m17:16:30.501281 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:16:30.505571 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.512580 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
drop view if exists "postgres"."public"."int_customers_per_store__dbt_backup" cascade
[0m17:16:30.520030 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m17:16:30.522679 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:30.524093 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m17:16:30.525777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68ee170>]}
[0m17:16:30.532318 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.int_customers_per_store ................ [[32mCREATE VIEW[0m in 0.22s]
[0m17:16:30.534352 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m17:16:30.535861 [debug] [Thread-1 (]: Began running node model.test_dbt_project.stg_payment
[0m17:16:30.537523 [info ] [Thread-1 (]: 2 of 4 START sql view model public.stg_payment ................................. [RUN]
[0m17:16:30.543145 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.stg_payment"
[0m17:16:30.545161 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.stg_payment
[0m17:16:30.546872 [debug] [Thread-1 (]: Compiling model.test_dbt_project.stg_payment
[0m17:16:30.550897 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.stg_payment"
[0m17:16:30.557351 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:30.558970 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.stg_payment
[0m17:16:30.563215 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.stg_payment"
[0m17:16:30.570579 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m17:16:30.572224 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: BEGIN
[0m17:16:30.594891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:30.621848 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:16:30.624378 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m17:16:30.627610 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */

  create view "postgres"."public"."stg_payment__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m17:16:30.653730 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m17:16:30.657553 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m17:16:30.659043 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
alter table "postgres"."public"."stg_payment" rename to "stg_payment__dbt_backup"
[0m17:16:30.662644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:30.671718 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m17:16:30.673806 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
alter table "postgres"."public"."stg_payment__dbt_tmp" rename to "stg_payment"
[0m17:16:30.677246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:30.679798 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m17:16:30.681172 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m17:16:30.687372 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m17:16:30.691737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:16:30.694660 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m17:16:30.696191 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
drop view if exists "postgres"."public"."stg_payment__dbt_backup" cascade
[0m17:16:30.705198 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m17:16:30.711253 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:30.713110 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: Close
[0m17:16:30.715119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6872dd0>]}
[0m17:16:30.716697 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.stg_payment ............................ [[32mCREATE VIEW[0m in 0.17s]
[0m17:16:30.718411 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.stg_payment
[0m17:16:30.720566 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m17:16:30.722100 [info ] [Thread-1 (]: 3 of 4 START sql view model public.int_revenue_by_date ......................... [RUN]
[0m17:16:30.723949 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.725550 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_revenue_by_date
[0m17:16:30.727284 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_revenue_by_date
[0m17:16:30.732312 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.738477 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:30.740031 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_revenue_by_date
[0m17:16:30.766446 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.773535 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.775064 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: BEGIN
[0m17:16:30.776611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:30.808084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:16:30.812133 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.814127 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    "postgres"."public"."stg_payment"
GROUP BY
    1
  );
[0m17:16:30.841761 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m17:16:30.850546 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.852793 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date__dbt_tmp" rename to "int_revenue_by_date"
[0m17:16:30.857914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:30.860261 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m17:16:30.861713 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.867100 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m17:16:30.871527 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:16:30.874519 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.875758 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
drop view if exists "postgres"."public"."int_revenue_by_date__dbt_backup" cascade
[0m17:16:30.878097 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:16:30.880366 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:30.881859 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: Close
[0m17:16:30.883877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb688a0b0>]}
[0m17:16:30.885728 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.int_revenue_by_date .................... [[32mCREATE VIEW[0m in 0.16s]
[0m17:16:30.887600 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m17:16:30.891713 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m17:16:30.893461 [info ] [Thread-1 (]: 4 of 4 START sql table model public.cumulative_revenue ......................... [RUN]
[0m17:16:30.895327 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.cumulative_revenue"
[0m17:16:30.897214 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.cumulative_revenue
[0m17:16:30.898775 [debug] [Thread-1 (]: Compiling model.test_dbt_project.cumulative_revenue
[0m17:16:30.922774 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.cumulative_revenue"
[0m17:16:30.929959 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:30.932254 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.cumulative_revenue
[0m17:16:30.944981 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.cumulative_revenue"
[0m17:16:30.957911 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m17:16:30.959779 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: BEGIN
[0m17:16:30.965734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:36.041553 [debug] [Thread-1 (]: SQL status: BEGIN in 5.08 seconds
[0m17:16:36.046428 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m17:16:36.049556 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */

  
    

  create  table "postgres"."public"."cumulative_revenue__dbt_tmp"
  as (
    

SELECT
    payment_date,
    amount,
    SUM(amount) OVER (ORDER BY payment_date)
FROM
    "postgres"."public"."int_revenue_by_date"
ORDER BY
    payment_date
  );
  
[0m17:16:36.145784 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.09 seconds
[0m17:16:36.149999 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m17:16:36.153827 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue" rename to "cumulative_revenue__dbt_backup"
[0m17:16:36.157266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:36.160334 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m17:16:36.161829 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue__dbt_tmp" rename to "cumulative_revenue"
[0m17:16:36.164968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:36.190139 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m17:16:36.191696 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m17:16:36.193631 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m17:16:36.198070 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:16:36.200826 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m17:16:36.202261 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
drop table if exists "postgres"."public"."cumulative_revenue__dbt_backup" cascade
[0m17:16:36.211330 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m17:16:36.219074 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:36.221077 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: Close
[0m17:16:36.223192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68ee8c0>]}
[0m17:16:36.225213 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.cumulative_revenue .................... [[32mSELECT 40[0m in 5.33s]
[0m17:16:36.227167 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m17:16:36.234420 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:16:36.236512 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:36.237782 [debug] [MainThread]: On master: BEGIN
[0m17:16:36.239241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:36.264989 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m17:16:36.271549 [debug] [MainThread]: On master: COMMIT
[0m17:16:36.273274 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:36.274715 [debug] [MainThread]: On master: COMMIT
[0m17:16:36.276625 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:16:36.278121 [debug] [MainThread]: On master: Close
[0m17:16:36.279979 [info ] [MainThread]: 
[0m17:16:36.282131 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 11.40 seconds (11.40s).
[0m17:16:36.284651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:36.286003 [debug] [MainThread]: Connection 'model.test_dbt_project.cumulative_revenue' was properly closed.
[0m17:16:36.347235 [info ] [MainThread]: 
[0m17:16:36.349607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:36.356517 [info ] [MainThread]: 
[0m17:16:36.359880 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:16:36.363104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4757550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb47570d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4757070>]}
[0m17:16:36.366136 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 17:16:48.537084 | af33524e-a528-4e16-9258-ee66e6580eb5 ==============================
[0m17:16:48.537094 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:16:48.538775 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/original_dbt', 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m17:16:48.540293 [debug] [MainThread]: Tracking: tracking
[0m17:16:48.548669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb59e7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb59e67a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb59e69b0>]}
[0m17:16:48.713251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:48.714912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:48.720285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af33524e-a528-4e16-9258-ee66e6580eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57fe440>]}
[0m17:16:48.784484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af33524e-a528-4e16-9258-ee66e6580eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57c5120>]}
[0m17:16:48.786397 [info ] [MainThread]: Found 4 models, 8 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m17:16:48.788077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af33524e-a528-4e16-9258-ee66e6580eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57c4ee0>]}
[0m17:16:48.790686 [info ] [MainThread]: 
[0m17:16:48.792883 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:16:48.795212 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m17:16:48.803608 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:16:48.811216 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:16:48.814629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:48.861024 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.05 seconds
[0m17:16:48.864812 [debug] [ThreadPool]: On list_postgres: Close
[0m17:16:48.869349 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:16:48.875462 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:16:48.877076 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:16:48.900510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:53.931121 [debug] [ThreadPool]: SQL status: BEGIN in 5.03 seconds
[0m17:16:53.945081 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:16:53.951324 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:16:53.993641 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.04 seconds
[0m17:16:53.998320 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:16:54.002191 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:16:54.014277 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:54.017218 [debug] [MainThread]: On master: BEGIN
[0m17:16:54.019684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:54.049748 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m17:16:54.052766 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:54.054717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:54.134468 [debug] [MainThread]: SQL status: SELECT 46 in 0.08 seconds
[0m17:16:54.141261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af33524e-a528-4e16-9258-ee66e6580eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5843760>]}
[0m17:16:54.145140 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:54.150443 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:54.152706 [debug] [MainThread]: On master: BEGIN
[0m17:16:54.156524 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:16:54.159196 [debug] [MainThread]: On master: COMMIT
[0m17:16:54.184784 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:54.187625 [debug] [MainThread]: On master: COMMIT
[0m17:16:54.191271 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:16:54.194093 [debug] [MainThread]: On master: Close
[0m17:16:54.196711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:54.199598 [info ] [MainThread]: 
[0m17:16:54.206385 [debug] [Thread-1 (]: Began running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m17:16:54.214600 [info ] [Thread-1 (]: 1 of 1 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot .. [RUN]
[0m17:16:54.216496 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.217996 [debug] [Thread-1 (]: Began compiling node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m17:16:54.219427 [debug] [Thread-1 (]: Compiling snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m17:16:54.222875 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:54.228630 [debug] [Thread-1 (]: Began executing node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m17:16:54.257188 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.259991 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select * from (
            select total_customers from (

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"
) subq
        ) as __dbt_sbq
        where false
        limit 0
    
[0m17:16:54.262254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:54.300979 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.04 seconds
[0m17:16:54.307231 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.308722 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m17:16:54.311082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:16:54.312351 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.313820 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:16:54.379654 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.06 seconds
[0m17:16:54.386457 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.389420 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:16:54.407615 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m17:16:54.423236 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.424807 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        
  
    

  create temporary table "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp171654416459"
  as (
    with snapshot_query as (

        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"


    ),

    snapshotted_data as (

        select *,
            store_id as dbt_unique_key

        from "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(store_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            store_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m17:16:54.464384 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.04 seconds
[0m17:16:54.488497 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.490624 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp171654416459'
        
      order by ordinal_position

  
[0m17:16:54.510540 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m17:16:54.515102 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.517089 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:16:54.534511 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.02 seconds
[0m17:16:54.539117 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.541599 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp171654416459'
        
      order by ordinal_position

  
[0m17:16:54.560364 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m17:16:54.564371 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.566107 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:16:54.586797 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m17:16:54.593342 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.596726 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp171654416459'
        
      order by ordinal_position

  
[0m17:16:54.616243 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m17:16:54.622426 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.630670 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.632443 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      update "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp171654416459" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_valid_to is null;

    insert into "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot" ("store_id", "total_customers", "current_date", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."store_id",DBT_INTERNAL_SOURCE."total_customers",DBT_INTERNAL_SOURCE."current_date",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp171654416459" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m17:16:54.640451 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.01 seconds
[0m17:16:54.649482 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m17:16:54.672517 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.675280 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m17:16:54.680124 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:16:54.683437 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:54.684871 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m17:16:54.686548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af33524e-a528-4e16-9258-ee66e6580eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb585ce20>]}
[0m17:16:54.687875 [info ] [Thread-1 (]: 1 of 1 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot .. [[32mINSERT 0 0[0m in 0.47s]
[0m17:16:54.690249 [debug] [Thread-1 (]: Finished running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m17:16:54.697351 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:16:54.699340 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:54.701047 [debug] [MainThread]: On master: BEGIN
[0m17:16:54.702666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:54.728767 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m17:16:54.731080 [debug] [MainThread]: On master: COMMIT
[0m17:16:54.732510 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:54.734150 [debug] [MainThread]: On master: COMMIT
[0m17:16:54.736202 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:16:54.741665 [debug] [MainThread]: On master: Close
[0m17:16:54.743621 [info ] [MainThread]: 
[0m17:16:54.744726 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.95 seconds (5.95s).
[0m17:16:54.746535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:54.748310 [debug] [MainThread]: Connection 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m17:16:54.804294 [info ] [MainThread]: 
[0m17:16:54.806197 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:54.807844 [info ] [MainThread]: 
[0m17:16:54.815770 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:16:54.817902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5722a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5721c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5721e40>]}
[0m17:16:54.819631 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 17:17:05.484409 | f078b56e-de00-4c2f-8082-1761bcf24931 ==============================
[0m17:17:05.484419 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:17:05.485372 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/original_dbt', 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:17:05.487688 [debug] [MainThread]: Tracking: tracking
[0m17:17:05.491297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e15c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be32a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be32a70>]}
[0m17:17:05.663636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:17:05.665012 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:17:05.670366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f078b56e-de00-4c2f-8082-1761bcf24931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1b6440>]}
[0m17:17:05.725994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f078b56e-de00-4c2f-8082-1761bcf24931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b17d120>]}
[0m17:17:05.727780 [info ] [MainThread]: Found 4 models, 8 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m17:17:05.734973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f078b56e-de00-4c2f-8082-1761bcf24931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b17cee0>]}
[0m17:17:05.739134 [info ] [MainThread]: 
[0m17:17:05.740939 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:17:05.743396 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:17:05.751043 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:17:05.752706 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:17:05.754500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:10.829288 [debug] [ThreadPool]: SQL status: BEGIN in 5.07 seconds
[0m17:17:10.832445 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:17:10.835306 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:17:10.883059 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.04 seconds
[0m17:17:10.886067 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:17:10.888515 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:17:10.894196 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:10.896807 [debug] [MainThread]: On master: BEGIN
[0m17:17:10.898526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:10.924150 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m17:17:10.926821 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:10.933937 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:17:11.007045 [debug] [MainThread]: SQL status: SELECT 46 in 0.07 seconds
[0m17:17:11.010835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f078b56e-de00-4c2f-8082-1761bcf24931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b17cdf0>]}
[0m17:17:11.012796 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:11.020109 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:11.021905 [debug] [MainThread]: On master: BEGIN
[0m17:17:11.024248 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:11.026206 [debug] [MainThread]: On master: COMMIT
[0m17:17:11.028084 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:11.033716 [debug] [MainThread]: On master: COMMIT
[0m17:17:11.036283 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:11.038182 [debug] [MainThread]: On master: Close
[0m17:17:11.040169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:11.042199 [info ] [MainThread]: 
[0m17:17:11.046463 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m17:17:11.047909 [info ] [Thread-1 (]: 1 of 8 START test not_null_customer_base_customer_id ........................... [RUN]
[0m17:17:11.049655 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m17:17:11.051661 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m17:17:11.054820 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m17:17:11.063268 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m17:17:11.091049 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:11.093257 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m17:17:11.102442 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m17:17:11.108689 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m17:17:11.115956 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m17:17:11.117586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:11.142418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m17:17:11.144879 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m17:17:11.151258 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m17:17:11.172085 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m17:17:11.175375 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:11.177217 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m17:17:11.179906 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: Close
[0m17:17:11.185881 [info ] [Thread-1 (]: 1 of 8 PASS not_null_customer_base_customer_id ................................. [[32mPASS[0m in 0.14s]
[0m17:17:11.188948 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m17:17:11.190918 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m17:17:11.192659 [info ] [Thread-1 (]: 2 of 8 START test not_null_customer_base_store_id .............................. [RUN]
[0m17:17:11.194815 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m17:17:11.196292 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m17:17:11.197807 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m17:17:11.201582 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m17:17:11.208309 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:11.210498 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m17:17:11.213145 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m17:17:11.239867 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m17:17:11.242078 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: BEGIN
[0m17:17:11.243773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:16.314264 [debug] [Thread-1 (]: SQL status: BEGIN in 5.07 seconds
[0m17:17:16.323289 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m17:17:16.325873 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m17:17:16.349074 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m17:17:16.351655 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.357053 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m17:17:16.359620 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: Close
[0m17:17:16.361548 [info ] [Thread-1 (]: 2 of 8 PASS not_null_customer_base_store_id .................................... [[32mPASS[0m in 5.17s]
[0m17:17:16.363682 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m17:17:16.365806 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m17:17:16.367349 [info ] [Thread-1 (]: 3 of 8 START test not_null_int_customers_per_store_store_id .................... [RUN]
[0m17:17:16.369305 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m17:17:16.370777 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m17:17:16.372731 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m17:17:16.376698 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m17:17:16.384906 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.386204 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m17:17:16.410156 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m17:17:16.418407 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m17:17:16.420410 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m17:17:16.422352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:16.452779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:17:16.455066 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m17:17:16.456682 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."int_customers_per_store"
where store_id is null



      
    ) dbt_internal_test
[0m17:17:16.484584 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m17:17:16.487199 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.493886 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m17:17:16.496691 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m17:17:16.498350 [info ] [Thread-1 (]: 3 of 8 PASS not_null_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.13s]
[0m17:17:16.499880 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m17:17:16.501925 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m17:17:16.507300 [info ] [Thread-1 (]: 4 of 8 START test not_null_int_customers_per_store_total_customers ............. [RUN]
[0m17:17:16.509329 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m17:17:16.511092 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m17:17:16.512455 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m17:17:16.516307 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m17:17:16.520994 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.522548 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m17:17:16.525769 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m17:17:16.532385 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m17:17:16.534096 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m17:17:16.535419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:16.581242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m17:17:16.583342 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m17:17:16.584989 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_customers
from "postgres"."public"."int_customers_per_store"
where total_customers is null



      
    ) dbt_internal_test
[0m17:17:16.612109 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m17:17:16.614839 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.616506 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m17:17:16.618898 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m17:17:16.626114 [info ] [Thread-1 (]: 4 of 8 PASS not_null_int_customers_per_store_total_customers ................... [[32mPASS[0m in 0.12s]
[0m17:17:16.627824 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m17:17:16.629330 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m17:17:16.630804 [info ] [Thread-1 (]: 5 of 8 START test not_null_stg_payment_customer_id ............................. [RUN]
[0m17:17:16.632701 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m17:17:16.639078 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m17:17:16.640616 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m17:17:16.644301 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m17:17:16.654985 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.657029 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m17:17:16.659557 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m17:17:16.666242 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m17:17:16.667557 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: BEGIN
[0m17:17:16.670782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:16.695875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:17:16.698296 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m17:17:16.700905 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_payment"
where customer_id is null



      
    ) dbt_internal_test
[0m17:17:16.727488 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m17:17:16.750394 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.753067 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: ROLLBACK
[0m17:17:16.756067 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: Close
[0m17:17:16.757896 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stg_payment_customer_id ................................... [[32mPASS[0m in 0.13s]
[0m17:17:16.759792 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m17:17:16.762040 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m17:17:16.764652 [info ] [Thread-1 (]: 6 of 8 START test not_null_stg_payment_payment_id .............................. [RUN]
[0m17:17:16.771764 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m17:17:16.773641 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m17:17:16.775306 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m17:17:16.779527 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m17:17:16.789690 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.791162 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m17:17:16.793577 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m17:17:16.803156 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m17:17:16.805075 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: BEGIN
[0m17:17:16.806516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:16.832156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:17:16.834850 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m17:17:16.836670 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payment"
where payment_id is null



      
    ) dbt_internal_test
[0m17:17:16.863901 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m17:17:16.866709 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.869433 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: ROLLBACK
[0m17:17:16.871940 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: Close
[0m17:17:16.873479 [info ] [Thread-1 (]: 6 of 8 PASS not_null_stg_payment_payment_id .................................... [[32mPASS[0m in 0.10s]
[0m17:17:16.874879 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m17:17:16.876412 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m17:17:16.899575 [info ] [Thread-1 (]: 7 of 8 START test unique_int_customers_per_store_store_id ...................... [RUN]
[0m17:17:16.902328 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m17:17:16.904382 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m17:17:16.906331 [debug] [Thread-1 (]: Compiling test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m17:17:16.911945 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m17:17:16.923222 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.925490 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m17:17:16.928536 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m17:17:16.939032 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m17:17:16.941546 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m17:17:16.942832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:16.966920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m17:17:16.972662 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m17:17:16.974477 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "postgres"."public"."int_customers_per_store"
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:17:17.003863 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m17:17:17.007151 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:17.009406 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m17:17:17.012559 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m17:17:17.015971 [info ] [Thread-1 (]: 7 of 8 PASS unique_int_customers_per_store_store_id ............................ [[32mPASS[0m in 0.11s]
[0m17:17:17.019317 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m17:17:17.023982 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m17:17:17.028429 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_payment_payment_id ................................ [RUN]
[0m17:17:17.030833 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m17:17:17.036055 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m17:17:17.038121 [debug] [Thread-1 (]: Compiling test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m17:17:17.044786 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m17:17:17.074401 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:17.077260 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m17:17:17.082076 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m17:17:17.096987 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m17:17:17.099841 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: BEGIN
[0m17:17:17.102958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:17.131933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:17:17.135259 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m17:17:17.137520 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payment"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:17:17.220668 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.08 seconds
[0m17:17:17.224988 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:17.230904 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: ROLLBACK
[0m17:17:17.234397 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: Close
[0m17:17:17.237562 [info ] [Thread-1 (]: 8 of 8 PASS unique_stg_payment_payment_id ...................................... [[32mPASS[0m in 0.21s]
[0m17:17:17.240506 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m17:17:17.244238 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:17:17.247126 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.249418 [debug] [MainThread]: On master: BEGIN
[0m17:17:17.251850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:17.281208 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m17:17:17.285795 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.288098 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.291317 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.294010 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:17.295496 [debug] [MainThread]: On master: Close
[0m17:17:17.322047 [info ] [MainThread]: 
[0m17:17:17.325513 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 11.58 seconds (11.58s).
[0m17:17:17.328590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:17.331444 [debug] [MainThread]: Connection 'test.test_dbt_project.unique_stg_payment_payment_id.7398e70184' was properly closed.
[0m17:17:17.377870 [info ] [MainThread]: 
[0m17:17:17.380923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:17.383455 [info ] [MainThread]: 
[0m17:17:17.387657 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:17:17.389811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b0099c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b008f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b008d30>]}
[0m17:17:17.394039 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 20:44:27.980007 | 15eccdcb-fb15-4bd9-bfb4-83b9d53caec5 ==============================
[0m20:44:27.980018 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:44:27.981354 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/shared_dbt', 'select': ['./shared_dbt'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:44:27.983073 [debug] [MainThread]: Tracking: tracking
[0m20:44:28.009284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f8bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f8a9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f8aa10>]}
[0m20:44:28.012622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f8bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f8a740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f8a9e0>]}
[0m20:44:28.015207 [debug] [MainThread]: Flushing usage events
[0m20:44:28.951446 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.


============================== 2023-02-20 20:45:01.490998 | f6bb495a-7f26-4e25-9422-b6c069420130 ==============================
[0m20:45:01.491011 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:45:01.493127 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/shared_dbt', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m20:45:01.494952 [debug] [MainThread]: Tracking: tracking
[0m20:45:01.498126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2b0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2b2260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2b2200>]}
[0m20:45:01.508779 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-flgrke5_'
[0m20:45:01.510558 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:45:02.326228 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:45:02.328980 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:45:02.918528 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:45:02.979159 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:45:07.862188 [info ] [MainThread]:   Installed from version 1.0.0
[0m20:45:07.864760 [info ] [MainThread]:   Up to date!
[0m20:45:07.866582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f6bb495a-7f26-4e25-9422-b6c069420130', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2b2500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2b20e0>]}
[0m20:45:07.868839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f11a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2b2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2b2860>]}
[0m20:45:07.892793 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 20:45:12.083358 | 151ced27-cbf1-4c60-99b9-60f24bdf5e1f ==============================
[0m20:45:12.083368 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:45:12.088719 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/shared_dbt', 'select': ['./shared_dbt'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:45:12.091110 [debug] [MainThread]: Tracking: tracking
[0m20:45:12.094688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbbb246d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d42a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d42a70>]}
[0m20:45:12.119523 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m20:45:12.122051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '151ced27-cbf1-4c60-99b9-60f24bdf5e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d5c340>]}
[0m20:45:12.495848 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m20:45:12.520568 [debug] [MainThread]: Parsing macros/relations.sql
[0m20:45:12.523500 [debug] [MainThread]: Parsing macros/adapters.sql
[0m20:45:12.536579 [debug] [MainThread]: Parsing macros/catalog.sql
[0m20:45:12.539515 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:45:12.542009 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:45:12.544683 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:45:12.549307 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:45:12.552373 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:45:12.559983 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:45:12.562247 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m20:45:12.564147 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m20:45:12.566004 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m20:45:12.570176 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m20:45:12.576935 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m20:45:12.579319 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m20:45:12.582098 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m20:45:12.583769 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m20:45:12.585194 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m20:45:12.586884 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m20:45:12.593351 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m20:45:12.595662 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m20:45:12.598212 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m20:45:12.600836 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m20:45:12.605598 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m20:45:12.607724 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m20:45:12.609549 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m20:45:12.611383 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m20:45:12.613170 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m20:45:12.615058 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m20:45:12.616791 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m20:45:12.620789 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m20:45:12.622890 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m20:45:12.625642 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m20:45:12.627661 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m20:45:12.629833 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m20:45:12.652962 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m20:45:12.655616 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m20:45:12.662209 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m20:45:12.665168 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m20:45:12.670009 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m20:45:12.672709 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m20:45:12.675386 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m20:45:12.683185 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m20:45:12.690753 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m20:45:12.699743 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m20:45:12.703197 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m20:45:12.705795 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m20:45:12.708783 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m20:45:12.715572 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m20:45:12.719661 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m20:45:12.724780 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m20:45:12.727862 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m20:45:12.731063 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m20:45:12.742478 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m20:45:12.744992 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m20:45:12.754127 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m20:45:12.762063 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m20:45:12.766033 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m20:45:12.768930 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m20:45:12.771270 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m20:45:12.777428 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m20:45:12.787169 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m20:45:12.792365 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m20:45:12.801625 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m20:45:12.808436 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m20:45:12.811501 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m20:45:12.816078 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m20:45:12.818654 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m20:45:12.820527 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m20:45:12.843844 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m20:45:12.848316 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m20:45:12.851206 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m20:45:12.856313 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m20:45:12.866508 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m20:45:12.868954 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m20:45:12.870500 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m20:45:12.872088 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m20:45:12.878937 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m20:45:12.881646 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m20:45:12.884212 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m20:45:12.886645 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m20:45:12.888931 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m20:45:12.897015 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m20:45:12.900252 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m20:45:12.902622 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m20:45:12.906545 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m20:45:12.912341 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m20:45:12.915335 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m20:45:12.917927 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m20:45:12.920382 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m20:45:12.923465 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m20:45:12.927596 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m20:45:12.930142 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m20:45:12.933167 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m20:45:12.936043 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m20:45:12.938272 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m20:45:12.940163 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m20:45:12.943500 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m20:45:12.945215 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m20:45:12.947224 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m20:45:12.949087 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m20:45:12.952937 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m20:45:12.955841 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m20:45:12.979448 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m20:45:12.982605 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m20:45:12.986793 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m20:45:12.989876 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m20:45:12.992207 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m20:45:12.995686 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m20:45:12.998929 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m20:45:13.001852 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m20:45:13.008543 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m20:45:13.013768 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m20:45:13.016167 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m20:45:13.018355 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m20:45:13.022200 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m20:45:13.028713 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m20:45:13.031073 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m20:45:13.034414 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m20:45:13.036703 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m20:45:13.038605 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m20:45:13.046753 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m20:45:13.048879 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m20:45:13.055890 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m20:45:13.060059 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m20:45:13.064216 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m20:45:13.066702 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m20:45:13.068974 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m20:45:13.213896 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m20:45:13.221685 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payment.sql
[0m20:45:13.316671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '151ced27-cbf1-4c60-99b9-60f24bdf5e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb851d930>]}
[0m20:45:13.363012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '151ced27-cbf1-4c60-99b9-60f24bdf5e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d5d660>]}
[0m20:45:13.365488 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m20:45:13.367637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '151ced27-cbf1-4c60-99b9-60f24bdf5e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb4ad180>]}
[0m20:45:13.372662 [warn ] [MainThread]: The selection criterion './shared_dbt' does not match any nodes
[0m20:45:13.375021 [info ] [MainThread]: 
[0m20:45:13.377255 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m20:45:13.442913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb40f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb45cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb1bfaf0>]}
[0m20:45:13.444675 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 20:46:02.654198 | 601c9d5e-dd81-4836-91d7-1e91dcbd9b5b ==============================
[0m20:46:02.654207 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:46:02.656332 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/shared_dbt', 'select': ['./shared_dbt'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:46:02.658091 [debug] [MainThread]: Tracking: tracking
[0m20:46:02.661467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce5ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce5e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce5e9b0>]}
[0m20:46:02.869315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:46:02.871401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:46:02.876811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '601c9d5e-dd81-4836-91d7-1e91dcbd9b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cc540d0>]}
[0m20:46:02.932612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '601c9d5e-dd81-4836-91d7-1e91dcbd9b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd0e650>]}
[0m20:46:02.934368 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m20:46:02.936060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '601c9d5e-dd81-4836-91d7-1e91dcbd9b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f57be20>]}
[0m20:46:02.943332 [warn ] [MainThread]: The selection criterion './shared_dbt' does not match any nodes
[0m20:46:02.945574 [info ] [MainThread]: 
[0m20:46:02.947261 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m20:46:02.992719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd0c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd0c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd0de10>]}
[0m20:46:02.999771 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 20:46:11.902881 | 3bf0d268-7793-4fc9-8965-41a6458b3d12 ==============================
[0m20:46:11.902892 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:46:11.909285 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/shared_dbt', 'select': ['./shared_dbt'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:46:11.911479 [debug] [MainThread]: Tracking: tracking
[0m20:46:11.914679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c93f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c92950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c929b0>]}
[0m20:46:12.085825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:46:12.088566 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:46:12.094700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bf0d268-7793-4fc9-8965-41a6458b3d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4ff40d0>]}
[0m20:46:12.137126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bf0d268-7793-4fc9-8965-41a6458b3d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50aa620>]}
[0m20:46:12.138933 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m20:46:12.163156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bf0d268-7793-4fc9-8965-41a6458b3d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78f3340>]}
[0m20:46:12.166794 [warn ] [MainThread]: The selection criterion './shared_dbt' does not match any nodes
[0m20:46:12.169909 [info ] [MainThread]: 
[0m20:46:12.172315 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m20:46:12.211398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50a8730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50a8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50a9de0>]}
[0m20:46:12.212910 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 20:46:27.570940 | 1d0a3b3b-f884-443d-b570-2a76f10a0245 ==============================
[0m20:46:27.570950 [info ] [MainThread]: Running with dbt=1.3.1
[0m20:46:27.572672 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/shared_dbt', 'select': ['./shared_dbt'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:46:27.574435 [debug] [MainThread]: Tracking: tracking
[0m20:46:27.581873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61afbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61ae9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61aea10>]}
[0m20:46:27.736549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:46:27.741078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:46:27.746652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d0a3b3b-f884-443d-b570-2a76f10a0245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa55100d0>]}
[0m20:46:27.799310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d0a3b3b-f884-443d-b570-2a76f10a0245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa55ca6b0>]}
[0m20:46:27.805945 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m20:46:27.807824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d0a3b3b-f884-443d-b570-2a76f10a0245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa55ca710>]}
[0m20:46:27.810774 [warn ] [MainThread]: The selection criterion './shared_dbt' does not match any nodes
[0m20:46:27.812467 [info ] [MainThread]: 
[0m20:46:27.814565 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m20:46:27.866151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa55c8700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa55c9ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa55c83a0>]}
[0m20:46:27.868865 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 21:08:07.921796 | 595da3ac-8422-433b-bc27-70f83bf01685 ==============================
[0m21:08:07.921807 [info ] [MainThread]: Running with dbt=1.3.1
[0m21:08:07.923144 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:08:07.924655 [debug] [MainThread]: Tracking: tracking
[0m21:08:07.927620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc8786d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba546a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba546a70>]}
[0m21:08:08.126369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:08:08.129298 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:08:08.140662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '595da3ac-8422-433b-bc27-70f83bf01685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb98a80d0>]}
[0m21:08:08.202989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '595da3ac-8422-433b-bc27-70f83bf01685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb995e6b0>]}
[0m21:08:08.204745 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 401 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m21:08:08.206424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '595da3ac-8422-433b-bc27-70f83bf01685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb981bb50>]}
[0m21:08:08.231185 [info ] [MainThread]: 
[0m21:08:08.233396 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:08:08.237470 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m21:08:08.245416 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:08:08.247398 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "shared_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:08:08.249507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:13.319456 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.07 seconds
[0m21:08:13.323322 [debug] [ThreadPool]: On list_postgres: Close
[0m21:08:13.328028 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m21:08:13.337711 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:08:13.339221 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m21:08:13.340568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:18.379419 [debug] [ThreadPool]: SQL status: BEGIN in 5.04 seconds
[0m21:08:18.383286 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m21:08:18.387087 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "shared_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m21:08:18.448430 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.06 seconds
[0m21:08:18.475006 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m21:08:18.477948 [debug] [ThreadPool]: On list_postgres_public: Close
[0m21:08:18.482385 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:18.484678 [debug] [MainThread]: On master: BEGIN
[0m21:08:18.486533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:08:23.537193 [debug] [MainThread]: SQL status: BEGIN in 5.05 seconds
[0m21:08:23.540597 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:23.549026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "shared_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:08:23.636498 [debug] [MainThread]: SQL status: SELECT 46 in 0.08 seconds
[0m21:08:23.640186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '595da3ac-8422-433b-bc27-70f83bf01685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb98e3dc0>]}
[0m21:08:23.642339 [debug] [MainThread]: On master: ROLLBACK
[0m21:08:23.645553 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:23.647657 [debug] [MainThread]: On master: BEGIN
[0m21:08:23.650275 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:08:23.651744 [debug] [MainThread]: On master: COMMIT
[0m21:08:23.653092 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:23.654713 [debug] [MainThread]: On master: COMMIT
[0m21:08:23.656591 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:08:23.658142 [debug] [MainThread]: On master: Close
[0m21:08:23.661557 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:08:23.663267 [info ] [MainThread]: 
[0m21:08:23.668834 [debug] [Thread-1 (]: Began running node model.shared_dbt.stg_payment
[0m21:08:23.670812 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_payment ................................. [RUN]
[0m21:08:23.694138 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_dbt.stg_payment"
[0m21:08:23.695975 [debug] [Thread-1 (]: Began compiling node model.shared_dbt.stg_payment
[0m21:08:23.698094 [debug] [Thread-1 (]: Compiling model.shared_dbt.stg_payment
[0m21:08:23.701691 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_dbt.stg_payment"
[0m21:08:23.735983 [debug] [Thread-1 (]: finished collecting timing info
[0m21:08:23.737480 [debug] [Thread-1 (]: Began executing node model.shared_dbt.stg_payment
[0m21:08:23.760283 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_dbt.stg_payment"
[0m21:08:23.782800 [debug] [Thread-1 (]: Using postgres connection "model.shared_dbt.stg_payment"
[0m21:08:23.784395 [debug] [Thread-1 (]: On model.shared_dbt.stg_payment: BEGIN
[0m21:08:23.785800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:23.832732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m21:08:23.835168 [debug] [Thread-1 (]: Using postgres connection "model.shared_dbt.stg_payment"
[0m21:08:23.836644 [debug] [Thread-1 (]: On model.shared_dbt.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "shared_dbt", "target_name": "dev", "node_id": "model.shared_dbt.stg_payment"} */

  create view "postgres"."public"."stg_payment__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m21:08:23.863510 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m21:08:23.868926 [debug] [Thread-1 (]: Using postgres connection "model.shared_dbt.stg_payment"
[0m21:08:23.870914 [debug] [Thread-1 (]: On model.shared_dbt.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "shared_dbt", "target_name": "dev", "node_id": "model.shared_dbt.stg_payment"} */
alter table "postgres"."public"."stg_payment" rename to "stg_payment__dbt_backup"
[0m21:08:23.874714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:08:23.883059 [debug] [Thread-1 (]: Using postgres connection "model.shared_dbt.stg_payment"
[0m21:08:23.884909 [debug] [Thread-1 (]: On model.shared_dbt.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "shared_dbt", "target_name": "dev", "node_id": "model.shared_dbt.stg_payment"} */
alter table "postgres"."public"."stg_payment__dbt_tmp" rename to "stg_payment"
[0m21:08:23.889600 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:08:23.899757 [debug] [Thread-1 (]: On model.shared_dbt.stg_payment: COMMIT
[0m21:08:23.901287 [debug] [Thread-1 (]: Using postgres connection "model.shared_dbt.stg_payment"
[0m21:08:23.907617 [debug] [Thread-1 (]: On model.shared_dbt.stg_payment: COMMIT
[0m21:08:23.912607 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:08:23.916386 [debug] [Thread-1 (]: Using postgres connection "model.shared_dbt.stg_payment"
[0m21:08:23.917754 [debug] [Thread-1 (]: On model.shared_dbt.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "shared_dbt", "target_name": "dev", "node_id": "model.shared_dbt.stg_payment"} */
drop view if exists "postgres"."public"."stg_payment__dbt_backup" cascade
[0m21:08:23.927029 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m21:08:23.933670 [debug] [Thread-1 (]: finished collecting timing info
[0m21:08:23.935394 [debug] [Thread-1 (]: On model.shared_dbt.stg_payment: Close
[0m21:08:23.937165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '595da3ac-8422-433b-bc27-70f83bf01685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb974d6f0>]}
[0m21:08:23.940171 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_payment ............................ [[32mCREATE VIEW[0m in 0.24s]
[0m21:08:23.942445 [debug] [Thread-1 (]: Finished running node model.shared_dbt.stg_payment
[0m21:08:23.944628 [debug] [Thread-1 (]: Began running node model.shared_dbt.int_revenue_by_date
[0m21:08:23.946354 [info ] [Thread-1 (]: 2 of 2 START sql view model public.int_revenue_by_date ......................... [RUN]
[0m21:08:23.948314 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_dbt.int_revenue_by_date"
[0m21:08:23.949995 [debug] [Thread-1 (]: Began compiling node model.shared_dbt.int_revenue_by_date
[0m21:08:23.951626 [debug] [Thread-1 (]: Compiling model.shared_dbt.int_revenue_by_date
[0m21:08:23.955735 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_dbt.int_revenue_by_date"
[0m21:08:23.992671 [debug] [Thread-1 (]: finished collecting timing info
[0m21:08:23.994920 [debug] [Thread-1 (]: Began executing node model.shared_dbt.int_revenue_by_date
[0m21:08:23.998952 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_dbt.int_revenue_by_date"
[0m21:08:24.012427 [debug] [Thread-1 (]: Using postgres connection "model.shared_dbt.int_revenue_by_date"
[0m21:08:24.014257 [debug] [Thread-1 (]: On model.shared_dbt.int_revenue_by_date: BEGIN
[0m21:08:24.015581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:24.041267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m21:08:24.047443 [debug] [Thread-1 (]: Using postgres connection "model.shared_dbt.int_revenue_by_date"
[0m21:08:24.048971 [debug] [Thread-1 (]: On model.shared_dbt.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "shared_dbt", "target_name": "dev", "node_id": "model.shared_dbt.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    "postgres"."public"."stg_payment"
GROUP BY
    1
  );
[0m21:08:24.076527 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m21:08:24.080307 [debug] [Thread-1 (]: Using postgres connection "model.shared_dbt.int_revenue_by_date"
[0m21:08:24.081946 [debug] [Thread-1 (]: On model.shared_dbt.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "shared_dbt", "target_name": "dev", "node_id": "model.shared_dbt.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date__dbt_tmp" rename to "int_revenue_by_date"
[0m21:08:24.092005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:08:24.094698 [debug] [Thread-1 (]: On model.shared_dbt.int_revenue_by_date: COMMIT
[0m21:08:24.096317 [debug] [Thread-1 (]: Using postgres connection "model.shared_dbt.int_revenue_by_date"
[0m21:08:24.097806 [debug] [Thread-1 (]: On model.shared_dbt.int_revenue_by_date: COMMIT
[0m21:08:24.102109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:08:24.104995 [debug] [Thread-1 (]: Using postgres connection "model.shared_dbt.int_revenue_by_date"
[0m21:08:24.106534 [debug] [Thread-1 (]: On model.shared_dbt.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "shared_dbt", "target_name": "dev", "node_id": "model.shared_dbt.int_revenue_by_date"} */
drop view if exists "postgres"."public"."int_revenue_by_date__dbt_backup" cascade
[0m21:08:24.108956 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:08:24.111056 [debug] [Thread-1 (]: finished collecting timing info
[0m21:08:24.112684 [debug] [Thread-1 (]: On model.shared_dbt.int_revenue_by_date: Close
[0m21:08:24.116253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '595da3ac-8422-433b-bc27-70f83bf01685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb97682b0>]}
[0m21:08:24.118828 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.int_revenue_by_date .................... [[32mCREATE VIEW[0m in 0.17s]
[0m21:08:24.120755 [debug] [Thread-1 (]: Finished running node model.shared_dbt.int_revenue_by_date
[0m21:08:24.123161 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m21:08:24.124506 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:24.147664 [debug] [MainThread]: On master: BEGIN
[0m21:08:24.150130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:08:24.175562 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m21:08:24.177711 [debug] [MainThread]: On master: COMMIT
[0m21:08:24.179351 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:24.181106 [debug] [MainThread]: On master: COMMIT
[0m21:08:24.183156 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:08:24.190183 [debug] [MainThread]: On master: Close
[0m21:08:24.192381 [info ] [MainThread]: 
[0m21:08:24.194080 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 15.96 seconds (15.96s).
[0m21:08:24.196087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:08:24.202455 [debug] [MainThread]: Connection 'model.shared_dbt.int_revenue_by_date' was properly closed.
[0m21:08:24.257342 [info ] [MainThread]: 
[0m21:08:24.259345 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:08:24.266462 [info ] [MainThread]: 
[0m21:08:24.268332 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:08:24.270514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb995c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb985bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb975b430>]}
[0m21:08:24.272310 [debug] [MainThread]: Flushing usage events
