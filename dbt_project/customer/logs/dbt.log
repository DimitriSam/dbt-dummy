

============================== 2023-02-20 15:15:24.866003 | 23a8a17a-8243-4987-8851-3b048f4ef276 ==============================
[0m15:15:24.866016 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:15:24.866939 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m15:15:24.868977 [debug] [MainThread]: Tracking: tracking
[0m15:15:24.872665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867d7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867d7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867d7d90>]}
[0m15:15:24.895983 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-y1r_t0k7'
[0m15:15:24.897341 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:15:25.634780 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:15:25.654793 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:15:26.253455 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:15:26.318392 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:15:31.750516 [info ] [MainThread]:   Installed from version 1.0.0
[0m15:15:31.752294 [info ] [MainThread]:   Up to date!
[0m15:15:31.754107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '23a8a17a-8243-4987-8851-3b048f4ef276', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86632890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866324a0>]}
[0m15:15:31.756558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867edd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86633f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866330a0>]}
[0m15:15:31.757661 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 15:15:33.970427 | 29b151b3-3bf4-4c61-9793-e4f255a34af9 ==============================
[0m15:15:33.970445 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:15:33.972196 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m15:15:33.974773 [debug] [MainThread]: Tracking: tracking
[0m15:15:33.980266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa99180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa99270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa99210>]}
[0m15:15:34.011139 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m15:15:34.013737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa98ac0>]}
[0m15:15:34.399997 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m15:15:34.405785 [debug] [MainThread]: Parsing macros/relations.sql
[0m15:15:34.408195 [debug] [MainThread]: Parsing macros/adapters.sql
[0m15:15:34.420827 [debug] [MainThread]: Parsing macros/catalog.sql
[0m15:15:34.423413 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:15:34.426904 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:15:34.429209 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:15:34.434165 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:15:34.436221 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:15:34.437954 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:15:34.440116 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m15:15:34.460753 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m15:15:34.463428 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m15:15:34.468241 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m15:15:34.470048 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m15:15:34.471880 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m15:15:34.474355 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m15:15:34.476144 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m15:15:34.477892 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m15:15:34.485390 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m15:15:34.487567 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m15:15:34.489264 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m15:15:34.490971 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m15:15:34.494076 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m15:15:34.501751 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m15:15:34.503727 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m15:15:34.505939 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m15:15:34.507830 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m15:15:34.510074 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m15:15:34.515704 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m15:15:34.517958 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m15:15:34.520516 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m15:15:34.522709 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m15:15:34.525019 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m15:15:34.527017 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m15:15:34.528939 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m15:15:34.530656 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m15:15:34.532398 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m15:15:34.538494 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m15:15:34.542355 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m15:15:34.547772 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m15:15:34.550942 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m15:15:34.553900 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m15:15:34.561485 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m15:15:34.565304 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m15:15:34.574302 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m15:15:34.577878 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m15:15:34.580305 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m15:15:34.582329 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m15:15:34.584333 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m15:15:34.606969 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m15:15:34.612908 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m15:15:34.616445 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m15:15:34.619874 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m15:15:34.627140 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m15:15:34.630052 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m15:15:34.640409 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m15:15:34.648826 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m15:15:34.653531 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m15:15:34.656412 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m15:15:34.658762 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m15:15:34.665054 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m15:15:34.673398 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m15:15:34.682714 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m15:15:34.692508 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m15:15:34.697028 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m15:15:34.700094 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m15:15:34.704168 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m15:15:34.710743 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m15:15:34.713128 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m15:15:34.715265 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m15:15:34.718701 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m15:15:34.720805 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m15:15:34.725619 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m15:15:34.735443 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m15:15:34.737811 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m15:15:34.739974 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m15:15:34.741676 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m15:15:34.743547 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m15:15:34.747893 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m15:15:34.750945 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m15:15:34.753704 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m15:15:34.756268 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m15:15:34.759920 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m15:15:34.764647 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m15:15:34.767172 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m15:15:34.770621 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m15:15:34.777021 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m15:15:34.779943 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m15:15:34.799624 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m15:15:34.802364 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m15:15:34.806766 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m15:15:34.811158 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m15:15:34.815062 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m15:15:34.818878 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m15:15:34.823958 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m15:15:34.831688 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m15:15:34.834644 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m15:15:34.837535 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m15:15:34.840720 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m15:15:34.843727 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m15:15:34.850923 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m15:15:34.855953 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m15:15:34.859958 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m15:15:34.865570 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m15:15:34.869609 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m15:15:34.877575 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m15:15:34.881441 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m15:15:34.884706 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m15:15:34.888127 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m15:15:34.891518 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m15:15:34.895622 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m15:15:34.898678 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m15:15:34.903921 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m15:15:34.906280 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m15:15:34.909866 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m15:15:34.914566 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m15:15:34.916809 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m15:15:34.918705 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m15:15:34.921883 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m15:15:34.925757 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m15:15:34.927549 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m15:15:34.931299 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m15:15:34.933372 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m15:15:34.941632 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m15:15:34.964377 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m15:15:34.968195 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m15:15:34.970754 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m15:15:34.972839 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m15:15:35.122074 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m15:15:35.131556 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m15:15:35.134894 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m15:15:35.137882 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payment.sql
[0m15:15:35.174408 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m15:15:35.193616 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_int_customers_per_store_snapshot_total_customers.6745de9a0e' (snapshots/_snapshots.yml) depends on a node named 'int_customers_per_store_snapshot' which was not found
[0m15:15:35.287525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa66050>]}
[0m15:15:35.334292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa67250>]}
[0m15:15:35.337069 [info ] [MainThread]: Found 4 models, 8 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m15:15:35.338832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf928220>]}
[0m15:15:35.341385 [info ] [MainThread]: 
[0m15:15:35.374816 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:15:35.377273 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m15:15:35.386130 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:15:35.388218 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:15:35.391001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:35.452514 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.06 seconds
[0m15:15:35.456066 [debug] [ThreadPool]: On list_postgres: Close
[0m15:15:35.465337 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m15:15:35.472589 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:15:35.477082 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:15:35.481119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:35.518199 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m15:15:35.526989 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:15:35.531155 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:15:35.585769 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.05 seconds
[0m15:15:35.589307 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:15:35.596921 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:15:35.601958 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:35.604050 [debug] [MainThread]: On master: BEGIN
[0m15:15:35.605570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:15:40.688191 [debug] [MainThread]: SQL status: BEGIN in 5.08 seconds
[0m15:15:40.691881 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:40.694370 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:15:40.781289 [debug] [MainThread]: SQL status: SELECT 43 in 0.08 seconds
[0m15:15:40.786300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa4cfd0>]}
[0m15:15:40.788696 [debug] [MainThread]: On master: ROLLBACK
[0m15:15:40.809882 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:40.811858 [debug] [MainThread]: On master: BEGIN
[0m15:15:40.814579 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:15:40.816495 [debug] [MainThread]: On master: COMMIT
[0m15:15:40.818195 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:40.819909 [debug] [MainThread]: On master: COMMIT
[0m15:15:40.822094 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:15:40.823403 [debug] [MainThread]: On master: Close
[0m15:15:40.830000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:15:40.831799 [info ] [MainThread]: 
[0m15:15:40.845450 [debug] [Thread-1 (]: Began running node model.test_dbt_project.stg_payment
[0m15:15:40.848039 [info ] [Thread-1 (]: 1 of 14 START sql view model public.stg_payment ................................ [RUN]
[0m15:15:40.850999 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.stg_payment"
[0m15:15:40.856953 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.stg_payment
[0m15:15:40.859244 [debug] [Thread-1 (]: Compiling model.test_dbt_project.stg_payment
[0m15:15:40.864059 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.stg_payment"
[0m15:15:40.897222 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:40.898857 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.stg_payment
[0m15:15:40.920757 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.stg_payment"
[0m15:15:40.967811 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:15:40.969685 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: BEGIN
[0m15:15:40.976508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:41.006214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:41.009140 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:15:41.012159 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */

  create view "postgres"."public"."stg_payment__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m15:15:41.044562 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m15:15:41.050976 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:15:41.053129 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
alter table "postgres"."public"."stg_payment__dbt_tmp" rename to "stg_payment"
[0m15:15:41.057354 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:41.067675 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m15:15:41.073678 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:15:41.075778 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m15:15:41.080119 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:41.085196 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:15:41.086887 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
drop view if exists "postgres"."public"."stg_payment__dbt_backup" cascade
[0m15:15:41.089505 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:15:41.091882 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:41.093843 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: Close
[0m15:15:41.096189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf9a65f0>]}
[0m15:15:41.097728 [info ] [Thread-1 (]: 1 of 14 OK created sql view model public.stg_payment ........................... [[32mCREATE VIEW[0m in 0.25s]
[0m15:15:41.101089 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.stg_payment
[0m15:15:41.103083 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m15:15:41.104840 [info ] [Thread-1 (]: 2 of 14 START seed file public.customer_base ................................... [RUN]
[0m15:15:41.106226 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.test_dbt_project.customer_base"
[0m15:15:41.107696 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m15:15:41.110625 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:41.112342 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m15:15:41.156081 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:15:41.158767 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m15:15:41.181836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:46.261716 [debug] [Thread-1 (]: SQL status: BEGIN in 5.08 seconds
[0m15:15:46.271290 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:15:46.274361 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */

    create table "postgres"."public"."customer_base" ("customer_id" integer,"store_id" integer,"first_name" text,"last_name" text,"email" text,"address_id" integer,"activebool" text,"create_date" date,"last_update" timestamp without time zone,"active" integer)
  
[0m15:15:46.305822 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.03 seconds
[0m15:15:46.790852 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:15:46.792986 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m15:15:46.848596 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.05 seconds
[0m15:15:46.855089 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m15:15:46.869049 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m15:15:46.870599 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:15:46.871964 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m15:15:46.875908 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:46.877731 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:46.880614 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m15:15:46.882518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef20250>]}
[0m15:15:46.884307 [info ] [Thread-1 (]: 2 of 14 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 5.78s]
[0m15:15:46.886665 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m15:15:46.888259 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:15:46.908708 [info ] [Thread-1 (]: 3 of 14 START test not_null_stg_payment_customer_id ............................ [RUN]
[0m15:15:46.911189 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:15:46.912717 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:15:46.914443 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:15:46.923034 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:15:46.937617 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:46.939328 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:15:46.951279 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:15:46.963827 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:15:46.965507 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: BEGIN
[0m15:15:46.967292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:46.993860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:46.995786 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:15:46.997145 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_payment"
where customer_id is null



      
    ) dbt_internal_test
[0m15:15:47.026070 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:15:47.030428 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.032369 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: ROLLBACK
[0m15:15:47.037256 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: Close
[0m15:15:47.039412 [info ] [Thread-1 (]: 3 of 14 PASS not_null_stg_payment_customer_id .................................. [[32mPASS[0m in 0.13s]
[0m15:15:47.041084 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:15:47.042909 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:15:47.046055 [info ] [Thread-1 (]: 4 of 14 START test not_null_stg_payment_payment_id ............................. [RUN]
[0m15:15:47.048187 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:15:47.049756 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:15:47.051084 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:15:47.055584 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:15:47.087041 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.091390 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:15:47.095835 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:15:47.108808 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:15:47.110628 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: BEGIN
[0m15:15:47.112087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:47.140916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:47.147585 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:15:47.150407 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payment"
where payment_id is null



      
    ) dbt_internal_test
[0m15:15:47.182439 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:15:47.186330 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.193755 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: ROLLBACK
[0m15:15:47.197124 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: Close
[0m15:15:47.199603 [info ] [Thread-1 (]: 4 of 14 PASS not_null_stg_payment_payment_id ................................... [[32mPASS[0m in 0.15s]
[0m15:15:47.203138 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:15:47.205697 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:15:47.208535 [info ] [Thread-1 (]: 5 of 14 START test unique_stg_payment_payment_id ............................... [RUN]
[0m15:15:47.210959 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:15:47.212833 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:15:47.214644 [debug] [Thread-1 (]: Compiling test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:15:47.221485 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:15:47.227454 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.231782 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:15:47.235246 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:15:47.263911 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:15:47.266283 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: BEGIN
[0m15:15:47.267985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:47.294403 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:47.296669 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:15:47.298215 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payment"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:15:47.387505 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.09 seconds
[0m15:15:47.395247 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.397398 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: ROLLBACK
[0m15:15:47.400325 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: Close
[0m15:15:47.402087 [info ] [Thread-1 (]: 5 of 14 PASS unique_stg_payment_payment_id ..................................... [[32mPASS[0m in 0.19s]
[0m15:15:47.404018 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:15:47.410089 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:15:47.411882 [info ] [Thread-1 (]: 6 of 14 START test not_null_customer_base_customer_id .......................... [RUN]
[0m15:15:47.413673 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:15:47.415273 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:15:47.416946 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:15:47.425354 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:15:47.437239 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.438978 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:15:47.443942 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:15:47.466907 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:15:47.468346 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m15:15:47.469864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:47.513963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m15:15:47.515946 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:15:47.518397 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m15:15:47.543602 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m15:15:47.548244 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.551775 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m15:15:47.561342 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: Close
[0m15:15:47.564208 [info ] [Thread-1 (]: 6 of 14 PASS not_null_customer_base_customer_id ................................ [[32mPASS[0m in 0.15s]
[0m15:15:47.567791 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:15:47.572290 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:15:47.575270 [info ] [Thread-1 (]: 7 of 14 START test not_null_customer_base_store_id ............................. [RUN]
[0m15:15:47.581708 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:15:47.583422 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:15:47.584818 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:15:47.588488 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:15:47.599290 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.600742 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:15:47.603221 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:15:47.607701 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:15:47.609361 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: BEGIN
[0m15:15:47.612282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:47.639236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:47.642379 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:15:47.643917 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m15:15:47.664915 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m15:15:47.669256 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.671243 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m15:15:47.674021 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: Close
[0m15:15:47.675994 [info ] [Thread-1 (]: 7 of 14 PASS not_null_customer_base_store_id ................................... [[32mPASS[0m in 0.09s]
[0m15:15:47.677808 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:15:47.700334 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m15:15:47.703070 [info ] [Thread-1 (]: 8 of 14 START sql view model public.int_revenue_by_date ........................ [RUN]
[0m15:15:47.706094 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.707536 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_revenue_by_date
[0m15:15:47.709175 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_revenue_by_date
[0m15:15:47.713557 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.726451 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.728452 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_revenue_by_date
[0m15:15:47.736668 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.749626 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.751441 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: BEGIN
[0m15:15:47.753027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:47.779314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:47.781736 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.783409 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    "postgres"."public"."stg_payment"
GROUP BY
    1
  );
[0m15:15:47.810811 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m15:15:47.814545 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.815972 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date__dbt_tmp" rename to "int_revenue_by_date"
[0m15:15:47.822866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:47.825855 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m15:15:47.827532 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.829238 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m15:15:47.832639 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:47.836548 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:15:47.837898 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
drop view if exists "postgres"."public"."int_revenue_by_date__dbt_backup" cascade
[0m15:15:47.840347 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:15:47.842632 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.844160 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: Close
[0m15:15:47.864903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface77a00>]}
[0m15:15:47.867143 [info ] [Thread-1 (]: 8 of 14 OK created sql view model public.int_revenue_by_date ................... [[32mCREATE VIEW[0m in 0.16s]
[0m15:15:47.869346 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m15:15:47.871536 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m15:15:47.873299 [info ] [Thread-1 (]: 9 of 14 START sql view model public.int_customers_per_store .................... [RUN]
[0m15:15:47.876228 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:15:47.877723 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m15:15:47.883862 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_customers_per_store
[0m15:15:47.887407 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m15:15:47.896927 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:47.899186 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m15:15:47.903343 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m15:15:47.913841 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:15:47.916196 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m15:15:47.917539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:47.943366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:47.945144 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:15:47.946677 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view "postgres"."public"."int_customers_per_store__dbt_tmp" as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    "postgres"."public"."customer_base"
GROUP BY
    1
  );
[0m15:15:47.974649 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m15:15:47.978552 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:15:47.980049 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store__dbt_tmp" rename to "int_customers_per_store"
[0m15:15:47.985658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:47.988149 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m15:15:47.989610 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:15:47.990819 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m15:15:47.995015 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:48.000290 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:15:48.001989 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
drop view if exists "postgres"."public"."int_customers_per_store__dbt_backup" cascade
[0m15:15:48.005033 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:15:48.007277 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.008575 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m15:15:48.029381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface71ea0>]}
[0m15:15:48.032847 [info ] [Thread-1 (]: 9 of 14 OK created sql view model public.int_customers_per_store ............... [[32mCREATE VIEW[0m in 0.15s]
[0m15:15:48.034639 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m15:15:48.036436 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m15:15:48.038713 [info ] [Thread-1 (]: 10 of 14 START sql table model public.cumulative_revenue ....................... [RUN]
[0m15:15:48.040718 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.046798 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.cumulative_revenue
[0m15:15:48.048346 [debug] [Thread-1 (]: Compiling model.test_dbt_project.cumulative_revenue
[0m15:15:48.051666 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.068647 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.070141 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.cumulative_revenue
[0m15:15:48.086921 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.096193 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.098054 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: BEGIN
[0m15:15:48.099431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:48.128403 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:48.132919 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.134617 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */

  
    

  create  table "postgres"."public"."cumulative_revenue__dbt_tmp"
  as (
    

SELECT
    payment_date,
    amount,
    SUM(amount) OVER (ORDER BY payment_date)
FROM
    "postgres"."public"."int_revenue_by_date"
ORDER BY
    payment_date
  );
  
[0m15:15:48.231304 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.09 seconds
[0m15:15:48.235151 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.238807 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue__dbt_tmp" rename to "cumulative_revenue"
[0m15:15:48.243011 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:48.246306 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m15:15:48.248215 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.250267 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m15:15:48.273086 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:48.276448 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:15:48.278107 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
drop table if exists "postgres"."public"."cumulative_revenue__dbt_backup" cascade
[0m15:15:48.280964 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:15:48.283185 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.284483 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: Close
[0m15:15:48.286214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface5e9b0>]}
[0m15:15:48.287576 [info ] [Thread-1 (]: 10 of 14 OK created sql table model public.cumulative_revenue .................. [[32mSELECT 40[0m in 0.25s]
[0m15:15:48.294431 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m15:15:48.296611 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:15:48.300171 [info ] [Thread-1 (]: 11 of 14 START test not_null_int_customers_per_store_store_id .................. [RUN]
[0m15:15:48.302434 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:15:48.304366 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:15:48.310333 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:15:48.314637 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:15:48.332653 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.335189 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:15:48.338958 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:15:48.352798 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:15:48.354703 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m15:15:48.356577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:48.385342 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:48.391582 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:15:48.394341 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."int_customers_per_store"
where store_id is null



      
    ) dbt_internal_test
[0m15:15:48.427221 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:15:48.450793 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.455356 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m15:15:48.458254 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m15:15:48.460118 [info ] [Thread-1 (]: 11 of 14 PASS not_null_int_customers_per_store_store_id ........................ [[32mPASS[0m in 0.16s]
[0m15:15:48.467144 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:15:48.468944 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:15:48.470954 [info ] [Thread-1 (]: 12 of 14 START test not_null_int_customers_per_store_total_customers ........... [RUN]
[0m15:15:48.473084 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:15:48.479612 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:15:48.481762 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:15:48.487869 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:15:48.500897 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.503629 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:15:48.506858 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:15:48.513342 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:15:48.516543 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m15:15:48.518304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:48.544692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:48.547139 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:15:48.549370 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_customers
from "postgres"."public"."int_customers_per_store"
where total_customers is null



      
    ) dbt_internal_test
[0m15:15:48.579939 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:15:48.583042 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.584440 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m15:15:48.587587 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m15:15:48.590157 [info ] [Thread-1 (]: 12 of 14 PASS not_null_int_customers_per_store_total_customers ................. [[32mPASS[0m in 0.12s]
[0m15:15:48.611894 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:15:48.616837 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:15:48.618421 [info ] [Thread-1 (]: 13 of 14 START test unique_int_customers_per_store_store_id .................... [RUN]
[0m15:15:48.620189 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:15:48.621767 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:15:48.623932 [debug] [Thread-1 (]: Compiling test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:15:48.629047 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:15:48.639716 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.642694 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:15:48.647327 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:15:48.659361 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:15:48.661938 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m15:15:48.669011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:48.697326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:48.699840 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:15:48.701536 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "postgres"."public"."int_customers_per_store"
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:15:48.732482 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:15:48.735898 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.738034 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m15:15:48.740976 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m15:15:48.742727 [info ] [Thread-1 (]: 13 of 14 PASS unique_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.12s]
[0m15:15:48.746643 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:15:48.748735 [debug] [Thread-1 (]: Began running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:15:48.750710 [info ] [Thread-1 (]: 14 of 14 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot  [RUN]
[0m15:15:48.752704 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:15:48.754193 [debug] [Thread-1 (]: Began compiling node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:15:48.757332 [debug] [Thread-1 (]: Compiling snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:15:48.761284 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.763682 [debug] [Thread-1 (]: Began executing node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:15:48.792037 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:15:48.821661 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:15:48.823382 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m15:15:48.825383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:48.858093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:15:48.860399 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:15:48.862160 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      
  
    

  create  table "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(store_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to
    from (
        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"

    ) sbq



  );
  
  
[0m15:15:48.916985 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.05 seconds
[0m15:15:48.921254 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m15:15:48.926872 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:15:48.928575 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m15:15:48.934571 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:48.936901 [debug] [Thread-1 (]: finished collecting timing info
[0m15:15:48.942702 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m15:15:48.944718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29b151b3-3bf4-4c61-9793-e4f255a34af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface6d450>]}
[0m15:15:48.946528 [info ] [Thread-1 (]: 14 of 14 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot  [[32mSELECT 2[0m in 0.19s]
[0m15:15:48.948270 [debug] [Thread-1 (]: Finished running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:15:48.952332 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:15:48.954356 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:48.955901 [debug] [MainThread]: On master: BEGIN
[0m15:15:48.957431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:48.984813 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m15:15:48.988235 [debug] [MainThread]: On master: COMMIT
[0m15:15:48.990227 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:48.991836 [debug] [MainThread]: On master: COMMIT
[0m15:15:48.994007 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:15:48.995772 [debug] [MainThread]: On master: Close
[0m15:15:48.998920 [info ] [MainThread]: 
[0m15:15:49.001930 [info ] [MainThread]: Finished running 3 view models, 1 seed, 8 tests, 1 table model, 1 snapshot in 0 hours 0 minutes and 13.62 seconds (13.62s).
[0m15:15:49.004007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:49.005815 [debug] [MainThread]: Connection 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m15:15:49.068056 [info ] [MainThread]: 
[0m15:15:49.069416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:49.071055 [info ] [MainThread]: 
[0m15:15:49.072284 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m15:15:49.073927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa9b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa4d000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf982e90>]}
[0m15:15:49.075504 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 15:27:54.534046 | f3144c56-4040-4651-ab93-b75524c48e8b ==============================
[0m15:27:54.534059 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:27:54.535260 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m15:27:54.538040 [debug] [MainThread]: Tracking: tracking
[0m15:27:54.542639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b21ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b21c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b21c30>]}
[0m15:27:54.545363 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jgez9p_0'
[0m15:27:54.546951 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:27:55.348917 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:27:55.361289 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:27:56.061711 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:27:56.124555 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:28:01.585675 [info ] [MainThread]:   Installed from version 1.0.0
[0m15:28:01.587382 [info ] [MainThread]:   Up to date!
[0m15:28:01.588935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3144c56-4040-4651-ab93-b75524c48e8b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b21360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b992a0>]}
[0m15:28:01.590772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ba3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b992a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b993f0>]}
[0m15:28:01.592658 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 15:28:04.064324 | d9cfa442-9e49-4804-b45b-4269f47ef412 ==============================
[0m15:28:04.064343 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:28:04.065893 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m15:28:04.068635 [debug] [MainThread]: Tracking: tracking
[0m15:28:04.080783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d97b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d97c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d97bb0>]}
[0m15:28:04.568331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:28:04.570198 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:28:04.576241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9910a3e0>]}
[0m15:28:04.617290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990ccfa0>]}
[0m15:28:04.639091 [info ] [MainThread]: Found 4 models, 8 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m15:28:04.641334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990cce80>]}
[0m15:28:04.644285 [info ] [MainThread]: 
[0m15:28:04.646294 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:28:04.648539 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m15:28:04.656359 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:28:04.657863 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:28:04.659964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:04.717476 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.06 seconds
[0m15:28:04.719918 [debug] [ThreadPool]: On list_postgres: Close
[0m15:28:04.722482 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m15:28:04.727506 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:28:04.733011 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:28:04.734460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:09.806590 [debug] [ThreadPool]: SQL status: BEGIN in 5.07 seconds
[0m15:28:09.810231 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:28:09.814672 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:28:09.865751 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.05 seconds
[0m15:28:09.869034 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:28:09.872005 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:28:09.879091 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:09.881144 [debug] [MainThread]: On master: BEGIN
[0m15:28:09.882990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:28:09.908792 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m15:28:09.911168 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:09.932025 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:28:10.011199 [debug] [MainThread]: SQL status: SELECT 46 in 0.08 seconds
[0m15:28:10.016364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f5f640>]}
[0m15:28:10.019121 [debug] [MainThread]: On master: ROLLBACK
[0m15:28:10.021663 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:10.023467 [debug] [MainThread]: On master: BEGIN
[0m15:28:10.030165 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:28:10.032153 [debug] [MainThread]: On master: COMMIT
[0m15:28:10.033576 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:10.034936 [debug] [MainThread]: On master: COMMIT
[0m15:28:10.036953 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:28:10.043125 [debug] [MainThread]: On master: Close
[0m15:28:10.045834 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:28:10.048378 [info ] [MainThread]: 
[0m15:28:10.054979 [debug] [Thread-1 (]: Began running node model.test_dbt_project.stg_payment
[0m15:28:10.057917 [info ] [Thread-1 (]: 1 of 14 START sql view model public.stg_payment ................................ [RUN]
[0m15:28:10.065114 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.stg_payment"
[0m15:28:10.067106 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.stg_payment
[0m15:28:10.069648 [debug] [Thread-1 (]: Compiling model.test_dbt_project.stg_payment
[0m15:28:10.075861 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.stg_payment"
[0m15:28:10.081600 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:10.084543 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.stg_payment
[0m15:28:10.104637 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.stg_payment"
[0m15:28:10.113469 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:28:10.115386 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: BEGIN
[0m15:28:10.117027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:10.143828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:10.163857 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:28:10.166007 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */

  create view "postgres"."public"."stg_payment__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m15:28:10.195197 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m15:28:10.201138 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:28:10.203425 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
alter table "postgres"."public"."stg_payment" rename to "stg_payment__dbt_backup"
[0m15:28:10.207042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:10.210311 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:28:10.211877 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
alter table "postgres"."public"."stg_payment__dbt_tmp" rename to "stg_payment"
[0m15:28:10.220002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:10.231613 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m15:28:10.233964 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:28:10.235343 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m15:28:10.243456 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:10.247752 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m15:28:10.249297 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
drop view if exists "postgres"."public"."stg_payment__dbt_backup" cascade
[0m15:28:10.260240 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m15:28:10.262389 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:10.267789 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: Close
[0m15:28:10.269541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98fbe140>]}
[0m15:28:10.271159 [info ] [Thread-1 (]: 1 of 14 OK created sql view model public.stg_payment ........................... [[32mCREATE VIEW[0m in 0.20s]
[0m15:28:10.273022 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.stg_payment
[0m15:28:10.275138 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m15:28:10.276817 [info ] [Thread-1 (]: 2 of 14 START seed file public.customer_base ................................... [RUN]
[0m15:28:10.278917 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.test_dbt_project.customer_base"
[0m15:28:10.280286 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m15:28:10.282101 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:10.284742 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m15:28:10.323456 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:28:10.325489 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m15:28:10.327741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:10.356106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:10.358772 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:28:10.360501 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */
truncate table "postgres"."public"."customer_base"
[0m15:28:10.378241 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.02 seconds
[0m15:28:10.888774 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:28:10.891362 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m15:28:10.945514 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.05 seconds
[0m15:28:10.951343 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m15:28:10.964232 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m15:28:10.966297 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m15:28:10.967808 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m15:28:10.979399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:10.981986 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:10.983660 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m15:28:10.985322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f5dea0>]}
[0m15:28:10.991242 [info ] [Thread-1 (]: 2 of 14 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 0.71s]
[0m15:28:10.993320 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m15:28:10.994557 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:28:10.996112 [info ] [Thread-1 (]: 3 of 14 START test not_null_stg_payment_customer_id ............................ [RUN]
[0m15:28:10.997993 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:28:10.999244 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:28:11.000853 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:28:11.009803 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:28:11.017518 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:11.019102 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:28:11.027489 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:28:11.035279 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:28:11.036893 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: BEGIN
[0m15:28:11.056962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:11.082971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:11.084832 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m15:28:11.086295 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_payment"
where customer_id is null



      
    ) dbt_internal_test
[0m15:28:11.115086 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:28:11.118637 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:11.120660 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: ROLLBACK
[0m15:28:11.127640 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: Close
[0m15:28:11.130473 [info ] [Thread-1 (]: 3 of 14 PASS not_null_stg_payment_customer_id .................................. [[32mPASS[0m in 0.13s]
[0m15:28:11.132565 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m15:28:11.134504 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:28:11.136194 [info ] [Thread-1 (]: 4 of 14 START test not_null_stg_payment_payment_id ............................. [RUN]
[0m15:28:11.142203 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:28:11.144090 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:28:11.146355 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:28:11.150147 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:28:11.159911 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:11.161389 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:28:11.164024 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:28:11.169292 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:28:11.170732 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: BEGIN
[0m15:28:11.173234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:11.200073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:11.202698 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m15:28:11.204257 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payment"
where payment_id is null



      
    ) dbt_internal_test
[0m15:28:11.232346 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:28:11.236561 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:11.238090 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: ROLLBACK
[0m15:28:11.240225 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: Close
[0m15:28:11.242002 [info ] [Thread-1 (]: 4 of 14 PASS not_null_stg_payment_payment_id ................................... [[32mPASS[0m in 0.10s]
[0m15:28:11.243946 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m15:28:11.266338 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:28:11.268034 [info ] [Thread-1 (]: 5 of 14 START test unique_stg_payment_payment_id ............................... [RUN]
[0m15:28:11.270541 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:28:11.272176 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:28:11.273776 [debug] [Thread-1 (]: Compiling test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:28:11.279207 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:28:11.291756 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:11.293318 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:28:11.296164 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:28:11.305662 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:28:11.307050 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: BEGIN
[0m15:28:11.312653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:16.383565 [debug] [Thread-1 (]: SQL status: BEGIN in 5.07 seconds
[0m15:28:16.388084 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m15:28:16.391815 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payment"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:28:16.477606 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.08 seconds
[0m15:28:16.482896 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.484811 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: ROLLBACK
[0m15:28:16.487680 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: Close
[0m15:28:16.489876 [info ] [Thread-1 (]: 5 of 14 PASS unique_stg_payment_payment_id ..................................... [[32mPASS[0m in 5.22s]
[0m15:28:16.492350 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m15:28:16.513871 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:28:16.515672 [info ] [Thread-1 (]: 6 of 14 START test not_null_customer_base_customer_id .......................... [RUN]
[0m15:28:16.518350 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:28:16.520357 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:28:16.522210 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:28:16.527175 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:28:16.540655 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.542183 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:28:16.545790 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:28:16.553529 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:28:16.559042 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m15:28:16.560617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:16.586127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:16.588126 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m15:28:16.589850 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m15:28:16.611328 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m15:28:16.614279 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.616177 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m15:28:16.618860 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: Close
[0m15:28:16.620320 [info ] [Thread-1 (]: 6 of 14 PASS not_null_customer_base_customer_id ................................ [[32mPASS[0m in 0.10s]
[0m15:28:16.624567 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m15:28:16.626602 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:28:16.628158 [info ] [Thread-1 (]: 7 of 14 START test not_null_customer_base_store_id ............................. [RUN]
[0m15:28:16.630181 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:28:16.632971 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:28:16.634527 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:28:16.638165 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:28:16.663173 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.665705 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:28:16.669061 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:28:16.674785 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:28:16.680678 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: BEGIN
[0m15:28:16.682171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:16.707296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:16.709168 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m15:28:16.710926 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m15:28:16.736035 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m15:28:16.738799 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.740445 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m15:28:16.742727 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: Close
[0m15:28:16.744496 [info ] [Thread-1 (]: 7 of 14 PASS not_null_customer_base_store_id ................................... [[32mPASS[0m in 0.11s]
[0m15:28:16.751073 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m15:28:16.753263 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m15:28:16.754805 [info ] [Thread-1 (]: 8 of 14 START sql view model public.int_revenue_by_date ........................ [RUN]
[0m15:28:16.756462 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.757946 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_revenue_by_date
[0m15:28:16.759393 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_revenue_by_date
[0m15:28:16.762585 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.769517 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.771614 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_revenue_by_date
[0m15:28:16.775949 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.783999 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.786382 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: BEGIN
[0m15:28:16.787703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:16.832106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m15:28:16.834520 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.836197 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    "postgres"."public"."stg_payment"
GROUP BY
    1
  );
[0m15:28:16.864289 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m15:28:16.868301 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.870154 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date__dbt_tmp" rename to "int_revenue_by_date"
[0m15:28:16.874538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:16.881434 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m15:28:16.882983 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.884509 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m15:28:16.888624 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:16.890877 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m15:28:16.896240 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
drop view if exists "postgres"."public"."int_revenue_by_date__dbt_backup" cascade
[0m15:28:16.899351 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:28:16.901737 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.903313 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: Close
[0m15:28:16.904922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff986d7490>]}
[0m15:28:16.912155 [info ] [Thread-1 (]: 8 of 14 OK created sql view model public.int_revenue_by_date ................... [[32mCREATE VIEW[0m in 0.15s]
[0m15:28:16.914538 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m15:28:16.916142 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m15:28:16.917693 [info ] [Thread-1 (]: 9 of 14 START sql view model public.int_customers_per_store .................... [RUN]
[0m15:28:16.919532 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:28:16.921002 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m15:28:16.922272 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_customers_per_store
[0m15:28:16.926488 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m15:28:16.933730 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:16.935449 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m15:28:16.939288 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m15:28:16.946508 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:28:16.948508 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m15:28:16.949765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:16.994025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m15:28:16.995973 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:28:16.997793 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view "postgres"."public"."int_customers_per_store__dbt_tmp" as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    "postgres"."public"."customer_base"
GROUP BY
    1
  );
[0m15:28:17.024979 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m15:28:17.028552 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:28:17.030156 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store" rename to "int_customers_per_store__dbt_backup"
[0m15:28:17.033383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:17.036064 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:28:17.042454 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store__dbt_tmp" rename to "int_customers_per_store"
[0m15:28:17.046294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:17.048801 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m15:28:17.050216 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:28:17.051731 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m15:28:17.060355 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:17.063311 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m15:28:17.064809 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
drop view if exists "postgres"."public"."int_customers_per_store__dbt_backup" cascade
[0m15:28:17.071952 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m15:28:17.074244 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.079562 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m15:28:17.082139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bd7bb20>]}
[0m15:28:17.085130 [info ] [Thread-1 (]: 9 of 14 OK created sql view model public.int_customers_per_store ............... [[32mCREATE VIEW[0m in 0.16s]
[0m15:28:17.087089 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m15:28:17.088614 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m15:28:17.090113 [info ] [Thread-1 (]: 10 of 14 START sql table model public.cumulative_revenue ....................... [RUN]
[0m15:28:17.091917 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.093646 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.cumulative_revenue
[0m15:28:17.095934 [debug] [Thread-1 (]: Compiling model.test_dbt_project.cumulative_revenue
[0m15:28:17.100624 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.106972 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.110069 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.cumulative_revenue
[0m15:28:17.123603 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.149990 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.151980 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: BEGIN
[0m15:28:17.153952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:17.180060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:17.182584 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.184818 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */

  
    

  create  table "postgres"."public"."cumulative_revenue__dbt_tmp"
  as (
    

SELECT
    payment_date,
    amount,
    SUM(amount) OVER (ORDER BY payment_date)
FROM
    "postgres"."public"."int_revenue_by_date"
ORDER BY
    payment_date
  );
  
[0m15:28:17.278230 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.09 seconds
[0m15:28:17.285680 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.288748 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue" rename to "cumulative_revenue__dbt_backup"
[0m15:28:17.294060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:17.299740 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.304593 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue__dbt_tmp" rename to "cumulative_revenue"
[0m15:28:17.309364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:17.315655 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m15:28:17.319320 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.325826 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m15:28:17.332562 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:17.338511 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m15:28:17.342055 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
drop table if exists "postgres"."public"."cumulative_revenue__dbt_backup" cascade
[0m15:28:17.353012 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m15:28:17.356501 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.358294 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: Close
[0m15:28:17.360368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bd92ce0>]}
[0m15:28:17.366739 [info ] [Thread-1 (]: 10 of 14 OK created sql table model public.cumulative_revenue .................. [[32mSELECT 40[0m in 0.27s]
[0m15:28:17.371626 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m15:28:17.373355 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:28:17.375243 [info ] [Thread-1 (]: 11 of 14 START test not_null_int_customers_per_store_store_id .................. [RUN]
[0m15:28:17.378108 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:28:17.382330 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:28:17.384318 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:28:17.389043 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:28:17.415098 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.417052 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:28:17.420203 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:28:17.432836 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:28:17.434342 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m15:28:17.435731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:17.460196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m15:28:17.466561 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m15:28:17.468688 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."int_customers_per_store"
where store_id is null



      
    ) dbt_internal_test
[0m15:28:17.496948 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:28:17.500154 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.505871 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m15:28:17.508262 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m15:28:17.509999 [info ] [Thread-1 (]: 11 of 14 PASS not_null_int_customers_per_store_store_id ........................ [[32mPASS[0m in 0.13s]
[0m15:28:17.511893 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m15:28:17.513573 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:28:17.515117 [info ] [Thread-1 (]: 12 of 14 START test not_null_int_customers_per_store_total_customers ........... [RUN]
[0m15:28:17.516984 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:28:17.518478 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:28:17.520212 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:28:17.524012 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:28:17.530850 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.533144 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:28:17.537298 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:28:17.544064 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:28:17.564371 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m15:28:17.566542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:17.594349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:17.596971 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m15:28:17.599220 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_customers
from "postgres"."public"."int_customers_per_store"
where total_customers is null



      
    ) dbt_internal_test
[0m15:28:17.626607 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:28:17.629460 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.632006 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m15:28:17.639520 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m15:28:17.641548 [info ] [Thread-1 (]: 12 of 14 PASS not_null_int_customers_per_store_total_customers ................. [[32mPASS[0m in 0.12s]
[0m15:28:17.643096 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m15:28:17.645062 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:28:17.650611 [info ] [Thread-1 (]: 13 of 14 START test unique_int_customers_per_store_store_id .................... [RUN]
[0m15:28:17.652764 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:28:17.654246 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:28:17.656109 [debug] [Thread-1 (]: Compiling test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:28:17.659853 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:28:17.669737 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.671309 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:28:17.675065 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:28:17.680750 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:28:17.682222 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m15:28:17.684822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:17.710706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m15:28:17.712801 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m15:28:17.714296 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "postgres"."public"."int_customers_per_store"
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:28:17.746290 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m15:28:17.749198 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.750756 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m15:28:17.753859 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m15:28:17.756690 [info ] [Thread-1 (]: 13 of 14 PASS unique_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.10s]
[0m15:28:17.778881 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m15:28:17.781487 [debug] [Thread-1 (]: Began running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:28:17.783531 [info ] [Thread-1 (]: 14 of 14 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot  [RUN]
[0m15:28:17.785755 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:17.787961 [debug] [Thread-1 (]: Began compiling node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:28:17.789553 [debug] [Thread-1 (]: Compiling snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:28:17.792812 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:17.798915 [debug] [Thread-1 (]: Began executing node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:28:17.826312 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:17.828798 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select * from (
            select total_customers from (

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"
) subq
        ) as __dbt_sbq
        where false
        limit 0
    
[0m15:28:17.830642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:17.868822 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.04 seconds
[0m15:28:17.878836 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:17.880478 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m15:28:17.882947 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:28:17.884783 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:17.886313 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m15:28:17.970976 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.08 seconds
[0m15:28:17.977878 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:17.979618 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m15:28:17.995816 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m15:28:18.006185 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.007594 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        
  
    

  create temporary table "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp152818002346"
  as (
    with snapshot_query as (

        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"


    ),

    snapshotted_data as (

        select *,
            store_id as dbt_unique_key

        from "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(store_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            store_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m15:28:18.050356 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.04 seconds
[0m15:28:18.056480 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.058320 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp152818002346'
        
      order by ordinal_position

  
[0m15:28:18.078025 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m15:28:18.082331 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.084098 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m15:28:18.102703 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.02 seconds
[0m15:28:18.106691 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.108623 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp152818002346'
        
      order by ordinal_position

  
[0m15:28:18.145344 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m15:28:18.149627 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.151060 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m15:28:18.167061 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m15:28:18.173043 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.175452 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp152818002346'
        
      order by ordinal_position

  
[0m15:28:18.193805 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.01 seconds
[0m15:28:18.199128 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.211828 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.213624 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "test_profile", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      update "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp152818002346" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_valid_to is null;

    insert into "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot" ("store_id", "total_customers", "current_date", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."store_id",DBT_INTERNAL_SOURCE."total_customers",DBT_INTERNAL_SOURCE."current_date",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp152818002346" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m15:28:18.222205 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.01 seconds
[0m15:28:18.224993 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m15:28:18.226628 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m15:28:18.228755 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m15:28:18.233522 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:18.236817 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:18.238307 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m15:28:18.240499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9cfa442-9e49-4804-b45b-4269f47ef412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be2f4c0>]}
[0m15:28:18.243015 [info ] [Thread-1 (]: 14 of 14 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot  [[32mINSERT 0 0[0m in 0.45s]
[0m15:28:18.246668 [debug] [Thread-1 (]: Finished running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m15:28:18.249933 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:28:18.251724 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:18.253397 [debug] [MainThread]: On master: BEGIN
[0m15:28:18.254952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:28:18.283993 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m15:28:18.286695 [debug] [MainThread]: On master: COMMIT
[0m15:28:18.288512 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:18.290303 [debug] [MainThread]: On master: COMMIT
[0m15:28:18.311972 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:28:18.313985 [debug] [MainThread]: On master: Close
[0m15:28:18.316770 [info ] [MainThread]: 
[0m15:28:18.318971 [info ] [MainThread]: Finished running 3 view models, 1 seed, 8 tests, 1 table model, 1 snapshot in 0 hours 0 minutes and 13.67 seconds (13.67s).
[0m15:28:18.321908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:18.324857 [debug] [MainThread]: Connection 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m15:28:18.385881 [info ] [MainThread]: 
[0m15:28:18.388324 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:28:18.390553 [info ] [MainThread]: 
[0m15:28:18.392454 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m15:28:18.394445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f4c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f4cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be29c60>]}
[0m15:28:18.396809 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 17:12:32.067212 | 67e56086-9d7c-402f-a7b3-f00f2e547afd ==============================
[0m17:12:32.067229 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:12:32.068629 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/original_dbt', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m17:12:32.070621 [debug] [MainThread]: Tracking: tracking
[0m17:12:32.075159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2535c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2535d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2535cc0>]}
[0m17:12:32.081901 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gq__6ymw'
[0m17:12:32.083567 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:12:32.824734 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:12:32.832293 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:12:33.496899 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:12:33.560589 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:12:39.175045 [info ] [MainThread]:   Installed from version 1.0.0
[0m17:12:39.176926 [info ] [MainThread]:   Up to date!
[0m17:12:39.179655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '67e56086-9d7c-402f-a7b3-f00f2e547afd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25ad3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25ad2d0>]}
[0m17:12:39.181742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa26f5600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25ad450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25ad330>]}
[0m17:12:39.183447 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 17:15:45.971831 | c32a6fca-c10e-4ac3-9bfd-81e1ddf62104 ==============================
[0m17:15:45.971844 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:15:45.973415 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/original_dbt', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m17:15:45.975539 [debug] [MainThread]: Tracking: tracking
[0m17:15:45.979072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabbfbbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabbfa9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabbfaa10>]}
[0m17:15:46.086597 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:15:46.089097 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:15:46.092873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c32a6fca-c10e-4ac3-9bfd-81e1ddf62104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabbfb3d0>]}
[0m17:15:46.542978 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m17:15:46.546086 [debug] [MainThread]: Parsing macros/relations.sql
[0m17:15:46.548143 [debug] [MainThread]: Parsing macros/adapters.sql
[0m17:15:46.561355 [debug] [MainThread]: Parsing macros/catalog.sql
[0m17:15:46.568581 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:15:46.571586 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:15:46.573433 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:15:46.578762 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:15:46.590173 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:15:46.593442 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:15:46.596122 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m17:15:46.602774 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m17:15:46.605557 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m17:15:46.615351 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m17:15:46.619038 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m17:15:46.621788 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m17:15:46.625907 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m17:15:46.630403 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m17:15:46.634398 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m17:15:46.637634 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m17:15:46.641626 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m17:15:46.643701 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m17:15:46.667678 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m17:15:46.670479 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m17:15:46.675285 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m17:15:46.677242 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m17:15:46.679978 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m17:15:46.682462 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m17:15:46.684868 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m17:15:46.686605 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m17:15:46.693835 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m17:15:46.696130 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m17:15:46.698307 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m17:15:46.700490 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m17:15:46.702546 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m17:15:46.704525 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m17:15:46.710836 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m17:15:46.712826 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m17:15:46.718620 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m17:15:46.720680 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m17:15:46.725132 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m17:15:46.731967 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m17:15:46.734894 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m17:15:46.742478 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m17:15:46.745156 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m17:15:46.753467 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m17:15:46.756848 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m17:15:46.760343 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m17:15:46.762223 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m17:15:46.764541 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m17:15:46.768652 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m17:15:46.774134 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m17:15:46.776834 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m17:15:46.779862 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m17:15:46.787025 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m17:15:46.789592 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m17:15:46.798274 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m17:15:46.819219 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m17:15:46.823493 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m17:15:46.826614 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m17:15:46.828980 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m17:15:46.835347 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m17:15:46.844157 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m17:15:46.850519 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m17:15:46.865254 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m17:15:46.869928 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m17:15:46.873177 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m17:15:46.878022 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m17:15:46.880897 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m17:15:46.887497 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m17:15:46.889944 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m17:15:46.893702 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m17:15:46.895872 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m17:15:46.900865 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m17:15:46.911818 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m17:15:46.914458 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m17:15:46.916189 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m17:15:46.918070 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m17:15:46.919771 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m17:15:46.922260 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m17:15:46.925264 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m17:15:46.927581 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m17:15:46.930018 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m17:15:46.933500 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m17:15:46.936966 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m17:15:46.940762 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m17:15:46.944604 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m17:15:46.950622 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m17:15:46.952940 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m17:15:46.955428 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m17:15:46.978660 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m17:15:46.982146 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m17:15:46.985532 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m17:15:46.987876 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m17:15:46.991359 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m17:15:46.994209 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m17:15:46.996866 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m17:15:46.998648 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m17:15:47.006204 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m17:15:47.008675 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m17:15:47.010627 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m17:15:47.012555 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m17:15:47.017659 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m17:15:47.025443 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m17:15:47.029233 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m17:15:47.032077 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m17:15:47.036258 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m17:15:47.039223 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m17:15:47.045562 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m17:15:47.048453 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m17:15:47.051955 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m17:15:47.054471 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m17:15:47.056403 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m17:15:47.062042 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m17:15:47.064416 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m17:15:47.066413 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m17:15:47.070522 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m17:15:47.073016 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m17:15:47.077294 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m17:15:47.080790 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m17:15:47.083348 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m17:15:47.085326 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m17:15:47.089260 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m17:15:47.112452 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m17:15:47.120400 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m17:15:47.124720 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m17:15:47.128753 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m17:15:47.131186 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m17:15:47.133578 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m17:15:47.278425 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m17:15:47.286948 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m17:15:47.290074 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m17:15:47.293828 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payment.sql
[0m17:15:47.353280 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m17:15:47.367628 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_dbt_project.not_null_int_customers_per_store_snapshot_total_customers.6745de9a0e' (snapshots/_snapshots.yml) depends on a node named 'int_customers_per_store_snapshot' which was not found
[0m17:15:47.434749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c32a6fca-c10e-4ac3-9bfd-81e1ddf62104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf22950>]}
[0m17:15:47.476051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c32a6fca-c10e-4ac3-9bfd-81e1ddf62104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabd1eef0>]}
[0m17:15:47.479656 [info ] [MainThread]: Found 4 models, 8 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m17:15:47.481229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c32a6fca-c10e-4ac3-9bfd-81e1ddf62104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaafb8f10>]}
[0m17:15:47.483454 [info ] [MainThread]: 
[0m17:15:47.485462 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:15:47.507952 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m17:15:47.515740 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:15:47.519029 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:15:47.520850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:47.571771 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.05 seconds
[0m17:15:47.574779 [debug] [ThreadPool]: On list_postgres: Close
[0m17:15:47.577321 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:15:47.587349 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:15:47.589659 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:15:47.590980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:47.618076 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m17:15:47.624364 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:15:47.626408 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:15:47.679343 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.05 seconds
[0m17:15:47.683842 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:15:47.687660 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:15:47.697621 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:47.701227 [debug] [MainThread]: On master: BEGIN
[0m17:15:47.704594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:47.735357 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m17:15:47.739541 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:47.742649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:15:47.849009 [debug] [MainThread]: SQL status: SELECT 46 in 0.1 seconds
[0m17:15:47.852829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c32a6fca-c10e-4ac3-9bfd-81e1ddf62104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf8f190>]}
[0m17:15:47.855548 [debug] [MainThread]: On master: ROLLBACK
[0m17:15:47.858168 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:47.882934 [debug] [MainThread]: On master: BEGIN
[0m17:15:47.885787 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:15:47.887432 [debug] [MainThread]: On master: COMMIT
[0m17:15:47.888806 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:47.889936 [debug] [MainThread]: On master: COMMIT
[0m17:15:47.897403 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:15:47.899119 [debug] [MainThread]: On master: Close
[0m17:15:47.901007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:15:47.902699 [info ] [MainThread]: 
[0m17:15:47.911761 [debug] [Thread-1 (]: Began running node seed.test_dbt_project.customer_base
[0m17:15:47.913630 [info ] [Thread-1 (]: 1 of 1 START seed file public.customer_base .................................... [RUN]
[0m17:15:47.915549 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.test_dbt_project.customer_base"
[0m17:15:47.917190 [debug] [Thread-1 (]: Began compiling node seed.test_dbt_project.customer_base
[0m17:15:47.918932 [debug] [Thread-1 (]: finished collecting timing info
[0m17:15:47.925920 [debug] [Thread-1 (]: Began executing node seed.test_dbt_project.customer_base
[0m17:15:47.965328 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m17:15:47.967348 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: BEGIN
[0m17:15:47.969025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:47.994838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:15:47.997105 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m17:15:47.999118 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "seed.test_dbt_project.customer_base"} */
truncate table "postgres"."public"."customer_base"
[0m17:15:48.017226 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.02 seconds
[0m17:15:48.525923 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m17:15:48.527909 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m17:15:48.582872 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.05 seconds
[0m17:15:48.588785 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.test_dbt_project.customer_base"
[0m17:15:48.628653 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m17:15:48.630485 [debug] [Thread-1 (]: Using postgres connection "seed.test_dbt_project.customer_base"
[0m17:15:48.632084 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: COMMIT
[0m17:15:48.645066 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m17:15:48.648283 [debug] [Thread-1 (]: finished collecting timing info
[0m17:15:48.650854 [debug] [Thread-1 (]: On seed.test_dbt_project.customer_base: Close
[0m17:15:48.653642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32a6fca-c10e-4ac3-9bfd-81e1ddf62104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf0a5f0>]}
[0m17:15:48.657662 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.customer_base ................................ [[32mINSERT 599[0m in 0.74s]
[0m17:15:48.665358 [debug] [Thread-1 (]: Finished running node seed.test_dbt_project.customer_base
[0m17:15:48.670047 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:15:48.671925 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:48.673752 [debug] [MainThread]: On master: BEGIN
[0m17:15:48.678854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:53.757972 [debug] [MainThread]: SQL status: BEGIN in 5.08 seconds
[0m17:15:53.763517 [debug] [MainThread]: On master: COMMIT
[0m17:15:53.766166 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:53.768098 [debug] [MainThread]: On master: COMMIT
[0m17:15:53.770929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:15:53.772617 [debug] [MainThread]: On master: Close
[0m17:15:53.796836 [info ] [MainThread]: 
[0m17:15:53.800281 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.31 seconds (6.31s).
[0m17:15:53.802206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:53.804357 [debug] [MainThread]: Connection 'seed.test_dbt_project.customer_base' was properly closed.
[0m17:15:53.874974 [info ] [MainThread]: 
[0m17:15:53.876844 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:15:53.881193 [info ] [MainThread]: 
[0m17:15:53.882829 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:15:53.885266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa630280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6302b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab007520>]}
[0m17:15:53.887632 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 17:16:24.558330 | 4fad642d-40cd-417b-b463-e46b6792cb1e ==============================
[0m17:16:24.558340 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:16:24.560205 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/original_dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:16:24.561980 [debug] [MainThread]: Tracking: tracking
[0m17:16:24.570035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb76b3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb76b2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb76b29b0>]}
[0m17:16:24.793768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:24.795411 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:24.801290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6a36410>]}
[0m17:16:24.861331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb69fd0f0>]}
[0m17:16:24.868948 [info ] [MainThread]: Found 4 models, 8 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m17:16:24.875187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb69fceb0>]}
[0m17:16:24.878469 [info ] [MainThread]: 
[0m17:16:24.880390 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:16:24.882798 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m17:16:24.892482 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:16:24.895269 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:16:24.898095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:24.947843 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.05 seconds
[0m17:16:24.953289 [debug] [ThreadPool]: On list_postgres: Close
[0m17:16:24.957181 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:16:24.962338 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:16:24.964619 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:16:24.966209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:24.994792 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m17:16:24.997230 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:16:24.999464 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:16:25.047215 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.05 seconds
[0m17:16:25.050614 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:16:25.053284 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:16:25.058412 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:25.060419 [debug] [MainThread]: On master: BEGIN
[0m17:16:25.067555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:30.144111 [debug] [MainThread]: SQL status: BEGIN in 5.08 seconds
[0m17:16:30.151675 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:30.153761 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:30.240026 [debug] [MainThread]: SQL status: SELECT 46 in 0.08 seconds
[0m17:16:30.245226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb688b820>]}
[0m17:16:30.247213 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:30.250061 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:30.252043 [debug] [MainThread]: On master: BEGIN
[0m17:16:30.255729 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:16:30.257982 [debug] [MainThread]: On master: COMMIT
[0m17:16:30.259624 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:30.261123 [debug] [MainThread]: On master: COMMIT
[0m17:16:30.262884 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:16:30.284852 [debug] [MainThread]: On master: Close
[0m17:16:30.287324 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:30.289300 [info ] [MainThread]: 
[0m17:16:30.297247 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_customers_per_store
[0m17:16:30.304304 [info ] [Thread-1 (]: 1 of 4 START sql view model public.int_customers_per_store ..................... [RUN]
[0m17:16:30.306949 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.309650 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_customers_per_store
[0m17:16:30.316743 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_customers_per_store
[0m17:16:30.320199 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.334843 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:30.336657 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_customers_per_store
[0m17:16:30.357413 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.368223 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.369450 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: BEGIN
[0m17:16:30.370642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:30.397665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:16:30.399429 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.401349 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */

  create view "postgres"."public"."int_customers_per_store__dbt_tmp" as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    "postgres"."public"."customer_base"
GROUP BY
    1
  );
[0m17:16:30.429940 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m17:16:30.437039 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.442077 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store" rename to "int_customers_per_store__dbt_backup"
[0m17:16:30.446373 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:30.449595 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.473890 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store__dbt_tmp" rename to "int_customers_per_store"
[0m17:16:30.479388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:30.491980 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m17:16:30.494278 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.496396 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: COMMIT
[0m17:16:30.501281 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:16:30.505571 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_customers_per_store"
[0m17:16:30.512580 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.int_customers_per_store"} */
drop view if exists "postgres"."public"."int_customers_per_store__dbt_backup" cascade
[0m17:16:30.520030 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m17:16:30.522679 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:30.524093 [debug] [Thread-1 (]: On model.test_dbt_project.int_customers_per_store: Close
[0m17:16:30.525777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68ee170>]}
[0m17:16:30.532318 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.int_customers_per_store ................ [[32mCREATE VIEW[0m in 0.22s]
[0m17:16:30.534352 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_customers_per_store
[0m17:16:30.535861 [debug] [Thread-1 (]: Began running node model.test_dbt_project.stg_payment
[0m17:16:30.537523 [info ] [Thread-1 (]: 2 of 4 START sql view model public.stg_payment ................................. [RUN]
[0m17:16:30.543145 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.stg_payment"
[0m17:16:30.545161 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.stg_payment
[0m17:16:30.546872 [debug] [Thread-1 (]: Compiling model.test_dbt_project.stg_payment
[0m17:16:30.550897 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.stg_payment"
[0m17:16:30.557351 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:30.558970 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.stg_payment
[0m17:16:30.563215 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.stg_payment"
[0m17:16:30.570579 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m17:16:30.572224 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: BEGIN
[0m17:16:30.594891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:30.621848 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:16:30.624378 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m17:16:30.627610 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */

  create view "postgres"."public"."stg_payment__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m17:16:30.653730 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m17:16:30.657553 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m17:16:30.659043 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
alter table "postgres"."public"."stg_payment" rename to "stg_payment__dbt_backup"
[0m17:16:30.662644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:30.671718 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m17:16:30.673806 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
alter table "postgres"."public"."stg_payment__dbt_tmp" rename to "stg_payment"
[0m17:16:30.677246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:30.679798 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m17:16:30.681172 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m17:16:30.687372 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: COMMIT
[0m17:16:30.691737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:16:30.694660 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.stg_payment"
[0m17:16:30.696191 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.stg_payment"} */
drop view if exists "postgres"."public"."stg_payment__dbt_backup" cascade
[0m17:16:30.705198 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m17:16:30.711253 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:30.713110 [debug] [Thread-1 (]: On model.test_dbt_project.stg_payment: Close
[0m17:16:30.715119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6872dd0>]}
[0m17:16:30.716697 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.stg_payment ............................ [[32mCREATE VIEW[0m in 0.17s]
[0m17:16:30.718411 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.stg_payment
[0m17:16:30.720566 [debug] [Thread-1 (]: Began running node model.test_dbt_project.int_revenue_by_date
[0m17:16:30.722100 [info ] [Thread-1 (]: 3 of 4 START sql view model public.int_revenue_by_date ......................... [RUN]
[0m17:16:30.723949 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.725550 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.int_revenue_by_date
[0m17:16:30.727284 [debug] [Thread-1 (]: Compiling model.test_dbt_project.int_revenue_by_date
[0m17:16:30.732312 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.738477 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:30.740031 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.int_revenue_by_date
[0m17:16:30.766446 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.773535 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.775064 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: BEGIN
[0m17:16:30.776611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:30.808084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:16:30.812133 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.814127 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    "postgres"."public"."stg_payment"
GROUP BY
    1
  );
[0m17:16:30.841761 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m17:16:30.850546 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.852793 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date__dbt_tmp" rename to "int_revenue_by_date"
[0m17:16:30.857914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:30.860261 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m17:16:30.861713 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.867100 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: COMMIT
[0m17:16:30.871527 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:16:30.874519 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.int_revenue_by_date"
[0m17:16:30.875758 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.int_revenue_by_date"} */
drop view if exists "postgres"."public"."int_revenue_by_date__dbt_backup" cascade
[0m17:16:30.878097 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:16:30.880366 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:30.881859 [debug] [Thread-1 (]: On model.test_dbt_project.int_revenue_by_date: Close
[0m17:16:30.883877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb688a0b0>]}
[0m17:16:30.885728 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.int_revenue_by_date .................... [[32mCREATE VIEW[0m in 0.16s]
[0m17:16:30.887600 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.int_revenue_by_date
[0m17:16:30.891713 [debug] [Thread-1 (]: Began running node model.test_dbt_project.cumulative_revenue
[0m17:16:30.893461 [info ] [Thread-1 (]: 4 of 4 START sql table model public.cumulative_revenue ......................... [RUN]
[0m17:16:30.895327 [debug] [Thread-1 (]: Acquiring new postgres connection "model.test_dbt_project.cumulative_revenue"
[0m17:16:30.897214 [debug] [Thread-1 (]: Began compiling node model.test_dbt_project.cumulative_revenue
[0m17:16:30.898775 [debug] [Thread-1 (]: Compiling model.test_dbt_project.cumulative_revenue
[0m17:16:30.922774 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_dbt_project.cumulative_revenue"
[0m17:16:30.929959 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:30.932254 [debug] [Thread-1 (]: Began executing node model.test_dbt_project.cumulative_revenue
[0m17:16:30.944981 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_dbt_project.cumulative_revenue"
[0m17:16:30.957911 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m17:16:30.959779 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: BEGIN
[0m17:16:30.965734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:36.041553 [debug] [Thread-1 (]: SQL status: BEGIN in 5.08 seconds
[0m17:16:36.046428 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m17:16:36.049556 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */

  
    

  create  table "postgres"."public"."cumulative_revenue__dbt_tmp"
  as (
    

SELECT
    payment_date,
    amount,
    SUM(amount) OVER (ORDER BY payment_date)
FROM
    "postgres"."public"."int_revenue_by_date"
ORDER BY
    payment_date
  );
  
[0m17:16:36.145784 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.09 seconds
[0m17:16:36.149999 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m17:16:36.153827 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue" rename to "cumulative_revenue__dbt_backup"
[0m17:16:36.157266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:36.160334 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m17:16:36.161829 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue__dbt_tmp" rename to "cumulative_revenue"
[0m17:16:36.164968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:36.190139 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m17:16:36.191696 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m17:16:36.193631 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: COMMIT
[0m17:16:36.198070 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:16:36.200826 [debug] [Thread-1 (]: Using postgres connection "model.test_dbt_project.cumulative_revenue"
[0m17:16:36.202261 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "model.test_dbt_project.cumulative_revenue"} */
drop table if exists "postgres"."public"."cumulative_revenue__dbt_backup" cascade
[0m17:16:36.211330 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m17:16:36.219074 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:36.221077 [debug] [Thread-1 (]: On model.test_dbt_project.cumulative_revenue: Close
[0m17:16:36.223192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fad642d-40cd-417b-b463-e46b6792cb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68ee8c0>]}
[0m17:16:36.225213 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.cumulative_revenue .................... [[32mSELECT 40[0m in 5.33s]
[0m17:16:36.227167 [debug] [Thread-1 (]: Finished running node model.test_dbt_project.cumulative_revenue
[0m17:16:36.234420 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:16:36.236512 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:36.237782 [debug] [MainThread]: On master: BEGIN
[0m17:16:36.239241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:36.264989 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m17:16:36.271549 [debug] [MainThread]: On master: COMMIT
[0m17:16:36.273274 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:36.274715 [debug] [MainThread]: On master: COMMIT
[0m17:16:36.276625 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:16:36.278121 [debug] [MainThread]: On master: Close
[0m17:16:36.279979 [info ] [MainThread]: 
[0m17:16:36.282131 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 11.40 seconds (11.40s).
[0m17:16:36.284651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:36.286003 [debug] [MainThread]: Connection 'model.test_dbt_project.cumulative_revenue' was properly closed.
[0m17:16:36.347235 [info ] [MainThread]: 
[0m17:16:36.349607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:36.356517 [info ] [MainThread]: 
[0m17:16:36.359880 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:16:36.363104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4757550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb47570d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4757070>]}
[0m17:16:36.366136 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 17:16:48.537084 | af33524e-a528-4e16-9258-ee66e6580eb5 ==============================
[0m17:16:48.537094 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:16:48.538775 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/original_dbt', 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m17:16:48.540293 [debug] [MainThread]: Tracking: tracking
[0m17:16:48.548669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb59e7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb59e67a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb59e69b0>]}
[0m17:16:48.713251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:48.714912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:48.720285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af33524e-a528-4e16-9258-ee66e6580eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57fe440>]}
[0m17:16:48.784484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af33524e-a528-4e16-9258-ee66e6580eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57c5120>]}
[0m17:16:48.786397 [info ] [MainThread]: Found 4 models, 8 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m17:16:48.788077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af33524e-a528-4e16-9258-ee66e6580eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57c4ee0>]}
[0m17:16:48.790686 [info ] [MainThread]: 
[0m17:16:48.792883 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:16:48.795212 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m17:16:48.803608 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:16:48.811216 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:16:48.814629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:48.861024 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.05 seconds
[0m17:16:48.864812 [debug] [ThreadPool]: On list_postgres: Close
[0m17:16:48.869349 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:16:48.875462 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:16:48.877076 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:16:48.900510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:53.931121 [debug] [ThreadPool]: SQL status: BEGIN in 5.03 seconds
[0m17:16:53.945081 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:16:53.951324 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:16:53.993641 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.04 seconds
[0m17:16:53.998320 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:16:54.002191 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:16:54.014277 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:54.017218 [debug] [MainThread]: On master: BEGIN
[0m17:16:54.019684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:54.049748 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m17:16:54.052766 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:54.054717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:54.134468 [debug] [MainThread]: SQL status: SELECT 46 in 0.08 seconds
[0m17:16:54.141261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af33524e-a528-4e16-9258-ee66e6580eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5843760>]}
[0m17:16:54.145140 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:54.150443 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:54.152706 [debug] [MainThread]: On master: BEGIN
[0m17:16:54.156524 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:16:54.159196 [debug] [MainThread]: On master: COMMIT
[0m17:16:54.184784 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:54.187625 [debug] [MainThread]: On master: COMMIT
[0m17:16:54.191271 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:16:54.194093 [debug] [MainThread]: On master: Close
[0m17:16:54.196711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:54.199598 [info ] [MainThread]: 
[0m17:16:54.206385 [debug] [Thread-1 (]: Began running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m17:16:54.214600 [info ] [Thread-1 (]: 1 of 1 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot .. [RUN]
[0m17:16:54.216496 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.217996 [debug] [Thread-1 (]: Began compiling node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m17:16:54.219427 [debug] [Thread-1 (]: Compiling snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m17:16:54.222875 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:54.228630 [debug] [Thread-1 (]: Began executing node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m17:16:54.257188 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.259991 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */
select * from (
            select total_customers from (

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"
) subq
        ) as __dbt_sbq
        where false
        limit 0
    
[0m17:16:54.262254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:54.300979 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.04 seconds
[0m17:16:54.307231 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.308722 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m17:16:54.311082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:16:54.312351 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.313820 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:16:54.379654 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.06 seconds
[0m17:16:54.386457 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.389420 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:16:54.407615 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m17:16:54.423236 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.424807 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

        
  
    

  create temporary table "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp171654416459"
  as (
    with snapshot_query as (

        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"


    ),

    snapshotted_data as (

        select *,
            store_id as dbt_unique_key

        from "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(store_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            store_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m17:16:54.464384 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.04 seconds
[0m17:16:54.488497 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.490624 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp171654416459'
        
      order by ordinal_position

  
[0m17:16:54.510540 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m17:16:54.515102 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.517089 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:16:54.534511 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.02 seconds
[0m17:16:54.539117 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.541599 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp171654416459'
        
      order by ordinal_position

  
[0m17:16:54.560364 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m17:16:54.564371 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.566107 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:16:54.586797 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m17:16:54.593342 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.596726 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp171654416459'
        
      order by ordinal_position

  
[0m17:16:54.616243 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m17:16:54.622426 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.630670 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.632443 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"} */

      update "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp171654416459" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_valid_to is null;

    insert into "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot" ("store_id", "total_customers", "current_date", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."store_id",DBT_INTERNAL_SOURCE."total_customers",DBT_INTERNAL_SOURCE."current_date",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp171654416459" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m17:16:54.640451 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.01 seconds
[0m17:16:54.649482 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m17:16:54.672517 [debug] [Thread-1 (]: Using postgres connection "snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot"
[0m17:16:54.675280 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m17:16:54.680124 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:16:54.683437 [debug] [Thread-1 (]: finished collecting timing info
[0m17:16:54.684871 [debug] [Thread-1 (]: On snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m17:16:54.686548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af33524e-a528-4e16-9258-ee66e6580eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb585ce20>]}
[0m17:16:54.687875 [info ] [Thread-1 (]: 1 of 1 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot .. [[32mINSERT 0 0[0m in 0.47s]
[0m17:16:54.690249 [debug] [Thread-1 (]: Finished running node snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot
[0m17:16:54.697351 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:16:54.699340 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:54.701047 [debug] [MainThread]: On master: BEGIN
[0m17:16:54.702666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:54.728767 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m17:16:54.731080 [debug] [MainThread]: On master: COMMIT
[0m17:16:54.732510 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:54.734150 [debug] [MainThread]: On master: COMMIT
[0m17:16:54.736202 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:16:54.741665 [debug] [MainThread]: On master: Close
[0m17:16:54.743621 [info ] [MainThread]: 
[0m17:16:54.744726 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.95 seconds (5.95s).
[0m17:16:54.746535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:54.748310 [debug] [MainThread]: Connection 'snapshot.test_dbt_project.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m17:16:54.804294 [info ] [MainThread]: 
[0m17:16:54.806197 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:54.807844 [info ] [MainThread]: 
[0m17:16:54.815770 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:16:54.817902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5722a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5721c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5721e40>]}
[0m17:16:54.819631 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 17:17:05.484409 | f078b56e-de00-4c2f-8082-1761bcf24931 ==============================
[0m17:17:05.484419 [info ] [MainThread]: Running with dbt=1.3.1
[0m17:17:05.485372 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/src/dbt/dbt_project/original_dbt', 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:17:05.487688 [debug] [MainThread]: Tracking: tracking
[0m17:17:05.491297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e15c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be32a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be32a70>]}
[0m17:17:05.663636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:17:05.665012 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:17:05.670366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f078b56e-de00-4c2f-8082-1761bcf24931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1b6440>]}
[0m17:17:05.725994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f078b56e-de00-4c2f-8082-1761bcf24931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b17d120>]}
[0m17:17:05.727780 [info ] [MainThread]: Found 4 models, 8 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m17:17:05.734973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f078b56e-de00-4c2f-8082-1761bcf24931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b17cee0>]}
[0m17:17:05.739134 [info ] [MainThread]: 
[0m17:17:05.740939 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:17:05.743396 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m17:17:05.751043 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:17:05.752706 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:17:05.754500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:10.829288 [debug] [ThreadPool]: SQL status: BEGIN in 5.07 seconds
[0m17:17:10.832445 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:17:10.835306 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:17:10.883059 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.04 seconds
[0m17:17:10.886067 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:17:10.888515 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:17:10.894196 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:10.896807 [debug] [MainThread]: On master: BEGIN
[0m17:17:10.898526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:10.924150 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m17:17:10.926821 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:10.933937 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:17:11.007045 [debug] [MainThread]: SQL status: SELECT 46 in 0.07 seconds
[0m17:17:11.010835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f078b56e-de00-4c2f-8082-1761bcf24931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b17cdf0>]}
[0m17:17:11.012796 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:11.020109 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:11.021905 [debug] [MainThread]: On master: BEGIN
[0m17:17:11.024248 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:11.026206 [debug] [MainThread]: On master: COMMIT
[0m17:17:11.028084 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:11.033716 [debug] [MainThread]: On master: COMMIT
[0m17:17:11.036283 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:11.038182 [debug] [MainThread]: On master: Close
[0m17:17:11.040169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:11.042199 [info ] [MainThread]: 
[0m17:17:11.046463 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m17:17:11.047909 [info ] [Thread-1 (]: 1 of 8 START test not_null_customer_base_customer_id ........................... [RUN]
[0m17:17:11.049655 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m17:17:11.051661 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m17:17:11.054820 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m17:17:11.063268 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m17:17:11.091049 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:11.093257 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m17:17:11.102442 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m17:17:11.108689 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m17:17:11.115956 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m17:17:11.117586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:11.142418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m17:17:11.144879 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"
[0m17:17:11.151258 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m17:17:11.172085 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m17:17:11.175375 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:11.177217 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m17:17:11.179906 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb: Close
[0m17:17:11.185881 [info ] [Thread-1 (]: 1 of 8 PASS not_null_customer_base_customer_id ................................. [[32mPASS[0m in 0.14s]
[0m17:17:11.188948 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_customer_id.9682b15dfb
[0m17:17:11.190918 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m17:17:11.192659 [info ] [Thread-1 (]: 2 of 8 START test not_null_customer_base_store_id .............................. [RUN]
[0m17:17:11.194815 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m17:17:11.196292 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m17:17:11.197807 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m17:17:11.201582 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m17:17:11.208309 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:11.210498 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m17:17:11.213145 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m17:17:11.239867 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m17:17:11.242078 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: BEGIN
[0m17:17:11.243773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:16.314264 [debug] [Thread-1 (]: SQL status: BEGIN in 5.07 seconds
[0m17:17:16.323289 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_customer_base_store_id.e159464168"
[0m17:17:16.325873 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m17:17:16.349074 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m17:17:16.351655 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.357053 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m17:17:16.359620 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_customer_base_store_id.e159464168: Close
[0m17:17:16.361548 [info ] [Thread-1 (]: 2 of 8 PASS not_null_customer_base_store_id .................................... [[32mPASS[0m in 5.17s]
[0m17:17:16.363682 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_customer_base_store_id.e159464168
[0m17:17:16.365806 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m17:17:16.367349 [info ] [Thread-1 (]: 3 of 8 START test not_null_int_customers_per_store_store_id .................... [RUN]
[0m17:17:16.369305 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m17:17:16.370777 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m17:17:16.372731 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m17:17:16.376698 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m17:17:16.384906 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.386204 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m17:17:16.410156 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m17:17:16.418407 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m17:17:16.420410 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m17:17:16.422352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:16.452779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:17:16.455066 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m17:17:16.456682 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."int_customers_per_store"
where store_id is null



      
    ) dbt_internal_test
[0m17:17:16.484584 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m17:17:16.487199 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.493886 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m17:17:16.496691 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m17:17:16.498350 [info ] [Thread-1 (]: 3 of 8 PASS not_null_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.13s]
[0m17:17:16.499880 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m17:17:16.501925 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m17:17:16.507300 [info ] [Thread-1 (]: 4 of 8 START test not_null_int_customers_per_store_total_customers ............. [RUN]
[0m17:17:16.509329 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m17:17:16.511092 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m17:17:16.512455 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m17:17:16.516307 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m17:17:16.520994 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.522548 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m17:17:16.525769 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m17:17:16.532385 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m17:17:16.534096 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m17:17:16.535419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:16.581242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m17:17:16.583342 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m17:17:16.584989 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_customers
from "postgres"."public"."int_customers_per_store"
where total_customers is null



      
    ) dbt_internal_test
[0m17:17:16.612109 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m17:17:16.614839 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.616506 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m17:17:16.618898 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m17:17:16.626114 [info ] [Thread-1 (]: 4 of 8 PASS not_null_int_customers_per_store_total_customers ................... [[32mPASS[0m in 0.12s]
[0m17:17:16.627824 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m17:17:16.629330 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m17:17:16.630804 [info ] [Thread-1 (]: 5 of 8 START test not_null_stg_payment_customer_id ............................. [RUN]
[0m17:17:16.632701 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m17:17:16.639078 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m17:17:16.640616 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m17:17:16.644301 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m17:17:16.654985 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.657029 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m17:17:16.659557 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m17:17:16.666242 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m17:17:16.667557 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: BEGIN
[0m17:17:16.670782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:16.695875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:17:16.698296 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"
[0m17:17:16.700905 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_payment"
where customer_id is null



      
    ) dbt_internal_test
[0m17:17:16.727488 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m17:17:16.750394 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.753067 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: ROLLBACK
[0m17:17:16.756067 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce: Close
[0m17:17:16.757896 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stg_payment_customer_id ................................... [[32mPASS[0m in 0.13s]
[0m17:17:16.759792 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_customer_id.baf680fcce
[0m17:17:16.762040 [debug] [Thread-1 (]: Began running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m17:17:16.764652 [info ] [Thread-1 (]: 6 of 8 START test not_null_stg_payment_payment_id .............................. [RUN]
[0m17:17:16.771764 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m17:17:16.773641 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m17:17:16.775306 [debug] [Thread-1 (]: Compiling test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m17:17:16.779527 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m17:17:16.789690 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.791162 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m17:17:16.793577 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m17:17:16.803156 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m17:17:16.805075 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: BEGIN
[0m17:17:16.806516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:16.832156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:17:16.834850 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"
[0m17:17:16.836670 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payment"
where payment_id is null



      
    ) dbt_internal_test
[0m17:17:16.863901 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m17:17:16.866709 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.869433 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: ROLLBACK
[0m17:17:16.871940 [debug] [Thread-1 (]: On test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72: Close
[0m17:17:16.873479 [info ] [Thread-1 (]: 6 of 8 PASS not_null_stg_payment_payment_id .................................... [[32mPASS[0m in 0.10s]
[0m17:17:16.874879 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.not_null_stg_payment_payment_id.a464b8cd72
[0m17:17:16.876412 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m17:17:16.899575 [info ] [Thread-1 (]: 7 of 8 START test unique_int_customers_per_store_store_id ...................... [RUN]
[0m17:17:16.902328 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m17:17:16.904382 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m17:17:16.906331 [debug] [Thread-1 (]: Compiling test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m17:17:16.911945 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m17:17:16.923222 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:16.925490 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m17:17:16.928536 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m17:17:16.939032 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m17:17:16.941546 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m17:17:16.942832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:16.966920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m17:17:16.972662 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m17:17:16.974477 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "postgres"."public"."int_customers_per_store"
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:17:17.003863 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m17:17:17.007151 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:17.009406 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m17:17:17.012559 [debug] [Thread-1 (]: On test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m17:17:17.015971 [info ] [Thread-1 (]: 7 of 8 PASS unique_int_customers_per_store_store_id ............................ [[32mPASS[0m in 0.11s]
[0m17:17:17.019317 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_int_customers_per_store_store_id.b975e6cb6d
[0m17:17:17.023982 [debug] [Thread-1 (]: Began running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m17:17:17.028429 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_payment_payment_id ................................ [RUN]
[0m17:17:17.030833 [debug] [Thread-1 (]: Acquiring new postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m17:17:17.036055 [debug] [Thread-1 (]: Began compiling node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m17:17:17.038121 [debug] [Thread-1 (]: Compiling test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m17:17:17.044786 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m17:17:17.074401 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:17.077260 [debug] [Thread-1 (]: Began executing node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m17:17:17.082076 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m17:17:17.096987 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m17:17:17.099841 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: BEGIN
[0m17:17:17.102958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:17.131933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m17:17:17.135259 [debug] [Thread-1 (]: Using postgres connection "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"
[0m17:17:17.137520 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "original_dbt", "target_name": "dev", "node_id": "test.test_dbt_project.unique_stg_payment_payment_id.7398e70184"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payment"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:17:17.220668 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.08 seconds
[0m17:17:17.224988 [debug] [Thread-1 (]: finished collecting timing info
[0m17:17:17.230904 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: ROLLBACK
[0m17:17:17.234397 [debug] [Thread-1 (]: On test.test_dbt_project.unique_stg_payment_payment_id.7398e70184: Close
[0m17:17:17.237562 [info ] [Thread-1 (]: 8 of 8 PASS unique_stg_payment_payment_id ...................................... [[32mPASS[0m in 0.21s]
[0m17:17:17.240506 [debug] [Thread-1 (]: Finished running node test.test_dbt_project.unique_stg_payment_payment_id.7398e70184
[0m17:17:17.244238 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m17:17:17.247126 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.249418 [debug] [MainThread]: On master: BEGIN
[0m17:17:17.251850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:17.281208 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m17:17:17.285795 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.288098 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.291317 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.294010 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:17.295496 [debug] [MainThread]: On master: Close
[0m17:17:17.322047 [info ] [MainThread]: 
[0m17:17:17.325513 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 11.58 seconds (11.58s).
[0m17:17:17.328590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:17.331444 [debug] [MainThread]: Connection 'test.test_dbt_project.unique_stg_payment_payment_id.7398e70184' was properly closed.
[0m17:17:17.377870 [info ] [MainThread]: 
[0m17:17:17.380923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:17.383455 [info ] [MainThread]: 
[0m17:17:17.387657 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:17:17.389811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b0099c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b008f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b008d30>]}
[0m17:17:17.394039 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 22:28:19.833168 | c5c38760-786f-4224-89fd-79ba89725f0e ==============================
[0m22:28:19.833182 [info ] [MainThread]: Running with dbt=1.3.1
[0m22:28:19.834462 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m22:28:19.836386 [debug] [MainThread]: Tracking: tracking
[0m22:28:19.839557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98e5f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98e6080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98e6020>]}
[0m22:28:19.849276 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mzrlqfx2'
[0m22:28:19.851043 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:28:20.620707 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:28:20.632249 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:28:21.274339 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:28:21.373913 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:28:27.141699 [info ] [MainThread]:   Installed from version 1.0.0
[0m22:28:27.144717 [info ] [MainThread]:   Up to date!
[0m22:28:27.146105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c5c38760-786f-4224-89fd-79ba89725f0e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98e6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98e61a0>]}
[0m22:28:27.147567 [info ] [MainThread]: Installing ../shared_models
[0m22:28:27.149728 [debug] [MainThread]:   Creating symlink to local dependency.
[0m22:28:27.176658 [info ] [MainThread]:   Installed from <local @ ../shared_models>
[0m22:28:27.179325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c5c38760-786f-4224-89fd-79ba89725f0e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa974d330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa974d1e0>]}
[0m22:28:27.181558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa974bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98e4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98e5a50>]}
[0m22:28:27.183439 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 22:28:46.805826 | d37f02a6-6172-47fb-b8be-d377555d7ced ==============================
[0m22:28:46.805838 [info ] [MainThread]: Running with dbt=1.3.1
[0m22:28:46.807450 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:28:46.808931 [debug] [MainThread]: Tracking: tracking
[0m22:28:46.811750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89446740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89446650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894466b0>]}
[0m22:28:46.928460 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:28:46.930601 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m22:28:46.932906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd37f02a6-6172-47fb-b8be-d377555d7ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb7f550>]}
[0m22:28:47.549521 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m22:28:47.552130 [debug] [MainThread]: Parsing macros/relations.sql
[0m22:28:47.554502 [debug] [MainThread]: Parsing macros/adapters.sql
[0m22:28:47.567544 [debug] [MainThread]: Parsing macros/catalog.sql
[0m22:28:47.570521 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m22:28:47.577683 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m22:28:47.580090 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m22:28:47.585067 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m22:28:47.587014 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m22:28:47.588330 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m22:28:47.590025 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m22:28:47.592107 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m22:28:47.594888 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m22:28:47.598997 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m22:28:47.600847 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m22:28:47.604550 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m22:28:47.607243 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m22:28:47.609187 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m22:28:47.611340 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m22:28:47.613246 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m22:28:47.637496 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m22:28:47.639754 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m22:28:47.641861 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m22:28:47.644333 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m22:28:47.649265 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m22:28:47.651264 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m22:28:47.653495 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m22:28:47.655448 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m22:28:47.662646 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m22:28:47.664608 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m22:28:47.666762 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m22:28:47.668992 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m22:28:47.671129 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m22:28:47.678206 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m22:28:47.680215 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m22:28:47.682235 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m22:28:47.684105 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m22:28:47.686057 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m22:28:47.697534 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m22:28:47.700222 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m22:28:47.704652 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m22:28:47.707584 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m22:28:47.710638 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m22:28:47.718330 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m22:28:47.720952 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m22:28:47.729229 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m22:28:47.736751 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m22:28:47.739766 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m22:28:47.741955 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m22:28:47.745842 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m22:28:47.749726 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m22:28:47.755279 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m22:28:47.757696 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m22:28:47.761308 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m22:28:47.790740 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m22:28:47.793314 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m22:28:47.802261 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m22:28:47.809928 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m22:28:47.814128 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m22:28:47.817406 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m22:28:47.819482 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m22:28:47.825556 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m22:28:47.835204 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m22:28:47.840014 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m22:28:47.849262 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m22:28:47.853761 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m22:28:47.861429 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m22:28:47.865942 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m22:28:47.868851 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m22:28:47.870984 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m22:28:47.873166 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m22:28:47.882054 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m22:28:47.884460 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m22:28:47.888784 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m22:28:47.898799 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m22:28:47.901039 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m22:28:47.903006 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m22:28:47.904955 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m22:28:47.906700 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m22:28:47.909628 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m22:28:47.912287 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m22:28:47.916436 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m22:28:47.919497 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m22:28:47.922690 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m22:28:47.926136 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m22:28:47.928534 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m22:28:47.954511 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m22:28:47.961208 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m22:28:47.963423 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m22:28:47.966078 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m22:28:47.968875 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m22:28:47.971747 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m22:28:47.974931 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m22:28:47.977262 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m22:28:47.980715 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m22:28:47.986755 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m22:28:47.989264 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m22:28:47.991208 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m22:28:47.993280 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m22:28:48.000075 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m22:28:48.002348 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m22:28:48.004380 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m22:28:48.008109 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m22:28:48.011416 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m22:28:48.014541 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m22:28:48.022549 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m22:28:48.027321 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m22:28:48.029926 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m22:28:48.032394 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m22:28:48.035135 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m22:28:48.038057 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m22:28:48.040907 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m22:28:48.042824 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m22:28:48.047300 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m22:28:48.049174 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m22:28:48.051012 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m22:28:48.056644 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m22:28:48.059227 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m22:28:48.061773 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m22:28:48.065695 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m22:28:48.068206 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m22:28:48.092527 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m22:28:48.096991 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m22:28:48.099253 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m22:28:48.107272 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m22:28:48.111625 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m22:28:48.115394 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m22:28:48.117651 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m22:28:48.119538 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m22:28:48.263986 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m22:28:48.277546 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m22:28:48.281643 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m22:28:48.336426 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m22:28:48.339988 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_category.sql
[0m22:28:48.342807 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customer.sql
[0m22:28:48.345539 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_film.sql
[0m22:28:48.353788 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payment.sql
[0m22:28:48.356663 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_rental.sql
[0m22:28:48.376863 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m22:28:48.382350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892868f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b319c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b33eb0>]}
[0m22:28:48.384496 [debug] [MainThread]: Flushing usage events
[0m22:28:49.132731 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named int_revenue_by_date. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for int_revenue_by_date in this file:
   - models/intermediate/_intermediate_models.yml
  


============================== 2023-02-20 22:30:27.334109 | e4e3ec13-877c-45a4-beab-2baa0dae0d56 ==============================
[0m22:30:27.334122 [info ] [MainThread]: Running with dbt=1.3.1
[0m22:30:27.337182 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:30:27.341082 [debug] [MainThread]: Tracking: tracking
[0m22:30:27.348150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d1a680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d1a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d1a5f0>]}
[0m22:30:27.439039 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:30:27.445772 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m22:30:27.447593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e4e3ec13-877c-45a4-beab-2baa0dae0d56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8454160>]}
[0m22:30:27.813312 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m22:30:27.816784 [debug] [MainThread]: Parsing macros/relations.sql
[0m22:30:27.842411 [debug] [MainThread]: Parsing macros/adapters.sql
[0m22:30:27.855746 [debug] [MainThread]: Parsing macros/catalog.sql
[0m22:30:27.858689 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m22:30:27.860527 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m22:30:27.862704 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m22:30:27.867940 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m22:30:27.870565 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m22:30:27.877586 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m22:30:27.880015 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m22:30:27.882046 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m22:30:27.884514 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m22:30:27.888475 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m22:30:27.890302 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m22:30:27.896885 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m22:30:27.899498 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m22:30:27.901259 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m22:30:27.902778 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m22:30:27.905015 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m22:30:27.912586 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m22:30:27.914637 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m22:30:27.916538 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m22:30:27.918595 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m22:30:27.922784 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m22:30:27.924782 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m22:30:27.926903 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m22:30:27.928912 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m22:30:27.931184 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m22:30:27.933265 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m22:30:27.935109 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m22:30:27.938508 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m22:30:27.941210 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m22:30:27.943722 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m22:30:27.945652 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m22:30:27.948907 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m22:30:27.974198 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m22:30:27.977080 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m22:30:27.983267 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m22:30:27.985725 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m22:30:27.991298 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m22:30:27.995487 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m22:30:27.999202 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m22:30:28.013909 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m22:30:28.017766 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m22:30:28.026632 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m22:30:28.030178 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m22:30:28.032822 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m22:30:28.039632 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m22:30:28.041900 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m22:30:28.046055 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m22:30:28.051758 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m22:30:28.054565 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m22:30:28.057917 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m22:30:28.068175 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m22:30:28.071041 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m22:30:28.079536 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m22:30:28.086855 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m22:30:28.090736 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m22:30:28.093389 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m22:30:28.095704 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m22:30:28.101607 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m22:30:28.110464 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m22:30:28.115492 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m22:30:28.126704 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m22:30:28.131357 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m22:30:28.134264 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m22:30:28.138372 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m22:30:28.140777 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m22:30:28.142752 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m22:30:28.167687 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m22:30:28.171795 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m22:30:28.173885 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m22:30:28.178719 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m22:30:28.188788 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m22:30:28.190757 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m22:30:28.192394 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m22:30:28.194400 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m22:30:28.201577 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m22:30:28.204247 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m22:30:28.207396 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m22:30:28.210258 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m22:30:28.217348 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m22:30:28.221236 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m22:30:28.224391 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m22:30:28.227096 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m22:30:28.230636 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m22:30:28.241968 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m22:30:28.244986 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m22:30:28.247336 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m22:30:28.249620 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m22:30:28.252435 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m22:30:28.255544 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m22:30:28.258245 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m22:30:28.261201 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m22:30:28.263654 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m22:30:28.266009 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m22:30:28.267794 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m22:30:28.271658 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m22:30:28.273497 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m22:30:28.276007 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m22:30:28.279034 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m22:30:28.283181 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m22:30:28.309218 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m22:30:28.313202 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m22:30:28.315959 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m22:30:28.320368 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m22:30:28.323266 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m22:30:28.326524 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m22:30:28.329340 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m22:30:28.338011 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m22:30:28.341091 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m22:30:28.343505 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m22:30:28.348603 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m22:30:28.350703 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m22:30:28.358184 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m22:30:28.362470 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m22:30:28.364507 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m22:30:28.366522 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m22:30:28.370157 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m22:30:28.372500 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m22:30:28.379924 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m22:30:28.384146 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m22:30:28.386366 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m22:30:28.394077 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m22:30:28.397971 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m22:30:28.402191 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m22:30:28.404319 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m22:30:28.407338 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m22:30:28.588327 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m22:30:28.598060 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m22:30:28.677506 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m22:30:28.681053 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_category.sql
[0m22:30:28.689354 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customer.sql
[0m22:30:28.692587 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_film.sql
[0m22:30:28.695217 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payment.sql
[0m22:30:28.697893 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_rental.sql
[0m22:30:28.725491 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m22:30:28.730704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5bf0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa53f3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5416fb0>]}
[0m22:30:28.732637 [debug] [MainThread]: Flushing usage events
[0m22:30:29.691086 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named int_revenue_by_date. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for int_revenue_by_date in this file:
   - models/intermediate/_intermediate_models.yml
  


============================== 2023-02-20 22:30:38.766156 | 8912c8f8-abc7-41c4-bc6f-299a1e6cfc1a ==============================
[0m22:30:38.766168 [info ] [MainThread]: Running with dbt=1.3.1
[0m22:30:38.766970 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m22:30:38.768554 [debug] [MainThread]: Tracking: tracking
[0m22:30:38.771152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925d1ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925d1f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925d1f30>]}
[0m22:30:38.779153 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x8dbf303'
[0m22:30:38.781181 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:30:39.438034 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:30:39.441657 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:30:40.017043 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:30:40.126292 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:30:45.677663 [info ] [MainThread]:   Installed from version 1.0.0
[0m22:30:45.684755 [info ] [MainThread]:   Up to date!
[0m22:30:45.686689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8912c8f8-abc7-41c4-bc6f-299a1e6cfc1a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925d1ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925d1750>]}
[0m22:30:45.688763 [info ] [MainThread]: Installing ../shared_models
[0m22:30:45.696285 [debug] [MainThread]:   Creating symlink to local dependency.
[0m22:30:45.701119 [info ] [MainThread]:   Installed from <local @ ../shared_models>
[0m22:30:45.703939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8912c8f8-abc7-41c4-bc6f-299a1e6cfc1a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92648fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92649300>]}
[0m22:30:45.711113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925d0640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925d25f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925d04f0>]}
[0m22:30:45.712619 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 22:30:49.225574 | ebe38c2d-cb1d-4bcc-a72f-9bf354a851e4 ==============================
[0m22:30:49.225584 [info ] [MainThread]: Running with dbt=1.3.1
[0m22:30:49.226667 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:30:49.228135 [debug] [MainThread]: Tracking: tracking
[0m22:30:49.231308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd2a680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd2a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd2a5f0>]}
[0m22:30:49.292716 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:30:49.295146 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m22:30:49.297173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ebe38c2d-cb1d-4bcc-a72f-9bf354a851e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81988160>]}
[0m22:30:49.816744 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m22:30:49.819765 [debug] [MainThread]: Parsing macros/relations.sql
[0m22:30:49.822240 [debug] [MainThread]: Parsing macros/adapters.sql
[0m22:30:49.834901 [debug] [MainThread]: Parsing macros/catalog.sql
[0m22:30:49.837950 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m22:30:49.844284 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m22:30:49.846279 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m22:30:49.851055 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m22:30:49.853008 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m22:30:49.854258 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m22:30:49.860881 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m22:30:49.862928 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m22:30:49.865595 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m22:30:49.869931 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m22:30:49.871707 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m22:30:49.879458 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m22:30:49.882213 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m22:30:49.884140 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m22:30:49.886543 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m22:30:49.888514 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m22:30:49.890529 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m22:30:49.892584 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m22:30:49.894591 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m22:30:49.896978 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m22:30:49.901518 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m22:30:49.905369 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m22:30:49.907455 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m22:30:49.909285 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m22:30:49.911176 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m22:30:49.913009 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m22:30:49.915023 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m22:30:49.939046 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m22:30:49.941726 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m22:30:49.944456 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m22:30:49.947123 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m22:30:49.949024 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m22:30:49.951186 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m22:30:49.953087 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m22:30:49.959075 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m22:30:49.962104 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m22:30:49.966801 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m22:30:49.969972 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m22:30:49.972306 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m22:30:49.979515 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m22:30:49.986436 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m22:30:49.994827 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m22:30:49.998334 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m22:30:50.000875 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m22:30:50.002562 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m22:30:50.009867 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m22:30:50.013993 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m22:30:50.019529 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m22:30:50.022295 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m22:30:50.025462 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m22:30:50.032962 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m22:30:50.035041 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m22:30:50.043570 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m22:30:50.050903 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m22:30:50.055291 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m22:30:50.058372 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m22:30:50.061072 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m22:30:50.067323 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m22:30:50.076110 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m22:30:50.081333 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m22:30:50.090952 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m22:30:50.110985 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m22:30:50.114737 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m22:30:50.119005 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m22:30:50.122089 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m22:30:50.124421 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m22:30:50.126329 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m22:30:50.129772 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m22:30:50.137468 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m22:30:50.142247 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m22:30:50.151847 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m22:30:50.153733 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m22:30:50.155607 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m22:30:50.162342 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m22:30:50.164450 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m22:30:50.167353 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m22:30:50.170034 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m22:30:50.172278 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m22:30:50.174554 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m22:30:50.184089 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m22:30:50.193822 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m22:30:50.196927 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m22:30:50.200319 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m22:30:50.206755 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m22:30:50.209645 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m22:30:50.212118 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m22:30:50.214620 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m22:30:50.217593 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m22:30:50.222491 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m22:30:50.225220 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m22:30:50.228387 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m22:30:50.231219 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m22:30:50.233902 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m22:30:50.259299 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m22:30:50.261823 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m22:30:50.263923 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m22:30:50.266325 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m22:30:50.268378 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m22:30:50.271814 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m22:30:50.275456 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m22:30:50.278678 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m22:30:50.281371 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m22:30:50.289930 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m22:30:50.292519 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m22:30:50.295054 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m22:30:50.297922 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m22:30:50.300884 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m22:30:50.308922 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m22:30:50.311522 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m22:30:50.316374 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m22:30:50.318918 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m22:30:50.321326 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m22:30:50.331230 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m22:30:50.333728 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m22:30:50.336121 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m22:30:50.339663 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m22:30:50.342094 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m22:30:50.343986 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m22:30:50.347660 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m22:30:50.349985 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m22:30:50.357587 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m22:30:50.361894 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m22:30:50.367465 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m22:30:50.370120 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m22:30:50.372514 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m22:30:50.515523 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m22:30:50.524359 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m22:30:50.599213 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m22:30:50.603312 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_category.sql
[0m22:30:50.606201 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customer.sql
[0m22:30:50.609123 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_film.sql
[0m22:30:50.611673 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payment.sql
[0m22:30:50.619627 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_rental.sql
[0m22:30:50.638654 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m22:30:50.644551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f08a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e96fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e992fb0>]}
[0m22:30:50.650886 [debug] [MainThread]: Flushing usage events
[0m22:30:51.436945 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named int_revenue_by_date. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for int_revenue_by_date in this file:
   - models/intermediate/_intermediate_models.yml
  


============================== 2023-02-20 22:31:27.762087 | a24ad7ee-e9b7-4284-bc45-c945a3ba4077 ==============================
[0m22:31:27.762100 [info ] [MainThread]: Running with dbt=1.3.1
[0m22:31:27.763887 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m22:31:27.767695 [debug] [MainThread]: Tracking: tracking
[0m22:31:27.770863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af51f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af52050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af51ff0>]}
[0m22:31:27.774753 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-c7x2ay48'
[0m22:31:27.776542 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:31:28.476668 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:31:28.485828 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:31:29.062844 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:31:29.157628 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:31:34.591795 [info ] [MainThread]:   Installed from version 1.0.0
[0m22:31:34.593379 [info ] [MainThread]:   Up to date!
[0m22:31:34.594963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a24ad7ee-e9b7-4284-bc45-c945a3ba4077', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af520b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af516f0>]}
[0m22:31:34.596683 [info ] [MainThread]: Installing ../shared_models
[0m22:31:34.599701 [debug] [MainThread]:   Creating symlink to local dependency.
[0m22:31:34.604850 [info ] [MainThread]:   Installed from <local @ ../shared_models>
[0m22:31:34.606882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a24ad7ee-e9b7-4284-bc45-c945a3ba4077', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9adb5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9adb53c0>]}
[0m22:31:34.608596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af504f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af526b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af50dc0>]}
[0m22:31:34.610540 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 22:31:40.234653 | 89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58 ==============================
[0m22:31:40.234663 [info ] [MainThread]: Running with dbt=1.3.1
[0m22:31:40.235895 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:31:40.237242 [debug] [MainThread]: Tracking: tracking
[0m22:31:40.239921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849929e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84992740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849927a0>]}
[0m22:31:40.331265 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:31:40.333603 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m22:31:40.335425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff870cb0a0>]}
[0m22:31:40.830907 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m22:31:40.834054 [debug] [MainThread]: Parsing macros/relations.sql
[0m22:31:40.836662 [debug] [MainThread]: Parsing macros/adapters.sql
[0m22:31:40.849975 [debug] [MainThread]: Parsing macros/catalog.sql
[0m22:31:40.852299 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m22:31:40.855689 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m22:31:40.857783 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m22:31:40.862692 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m22:31:40.864943 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m22:31:40.866563 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m22:31:40.868238 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m22:31:40.892602 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m22:31:40.895216 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m22:31:40.900016 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m22:31:40.902151 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m22:31:40.904256 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m22:31:40.906930 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m22:31:40.908840 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m22:31:40.910615 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m22:31:40.917464 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m22:31:40.919467 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m22:31:40.921774 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m22:31:40.923855 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m22:31:40.926023 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m22:31:40.934750 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m22:31:40.936709 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m22:31:40.938789 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m22:31:40.940787 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m22:31:40.942623 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m22:31:40.950119 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m22:31:40.952320 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m22:31:40.954781 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m22:31:40.957058 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m22:31:40.959303 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m22:31:40.961120 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m22:31:40.963213 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m22:31:40.964968 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m22:31:40.967033 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m22:31:40.973600 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m22:31:40.977484 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m22:31:40.981945 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m22:31:40.985053 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m22:31:40.987726 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m22:31:40.995283 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m22:31:41.020340 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m22:31:41.028724 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m22:31:41.032226 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m22:31:41.034827 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m22:31:41.037256 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m22:31:41.039312 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m22:31:41.043041 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m22:31:41.048421 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m22:31:41.053790 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m22:31:41.057528 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m22:31:41.064445 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m22:31:41.066755 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m22:31:41.075452 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m22:31:41.082845 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m22:31:41.087244 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m22:31:41.090071 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m22:31:41.092114 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m22:31:41.098433 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m22:31:41.108089 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m22:31:41.113386 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m22:31:41.122110 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m22:31:41.126325 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m22:31:41.129154 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m22:31:41.133416 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m22:31:41.135997 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m22:31:41.138096 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m22:31:41.140352 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m22:31:41.144086 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m22:31:41.148038 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m22:31:41.153207 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m22:31:41.163076 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m22:31:41.165035 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m22:31:41.166866 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m22:31:41.168663 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m22:31:41.197343 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m22:31:41.203096 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m22:31:41.206181 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m22:31:41.208861 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m22:31:41.211673 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m22:31:41.215738 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m22:31:41.219137 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m22:31:41.221081 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m22:31:41.230310 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m22:31:41.236608 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m22:31:41.239064 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m22:31:41.241428 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m22:31:41.248341 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m22:31:41.251501 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m22:31:41.254518 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m22:31:41.257056 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m22:31:41.260294 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m22:31:41.269802 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m22:31:41.272379 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m22:31:41.274307 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m22:31:41.276659 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m22:31:41.278717 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m22:31:41.280941 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m22:31:41.283132 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m22:31:41.286827 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m22:31:41.290190 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m22:31:41.293435 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m22:31:41.297810 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m22:31:41.302158 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m22:31:41.304916 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m22:31:41.307573 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m22:31:41.310546 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m22:31:41.336130 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m22:31:41.339311 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m22:31:41.341603 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m22:31:41.346841 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m22:31:41.349138 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m22:31:41.350948 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m22:31:41.355422 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m22:31:41.357451 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m22:31:41.359532 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m22:31:41.368038 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m22:31:41.370715 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m22:31:41.372764 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m22:31:41.376898 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m22:31:41.379439 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m22:31:41.391525 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m22:31:41.395539 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m22:31:41.399332 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m22:31:41.401730 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m22:31:41.404249 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m22:31:41.553803 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m22:31:41.562605 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m22:31:41.614073 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m22:31:41.617661 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_category.sql
[0m22:31:41.620301 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customer.sql
[0m22:31:41.623313 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_film.sql
[0m22:31:41.625810 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payment.sql
[0m22:31:41.630441 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_rental.sql
[0m22:31:41.647616 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m22:31:41.670739 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.customer.not_null_int_customers_per_store_snapshot_total_customers.6745de9a0e' (snapshots/_snapshots.yml) depends on a node named 'int_customers_per_store_snapshot' which was not found
[0m22:31:41.745066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8477b190>]}
[0m22:31:41.802617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8477b190>]}
[0m22:31:41.804872 [info ] [MainThread]: Found 8 models, 16 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 5 sources, 0 exposures, 0 metrics
[0m22:31:41.806301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a3caf0>]}
[0m22:31:41.809044 [info ] [MainThread]: 
[0m22:31:41.814147 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m22:31:41.816676 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m22:31:41.824003 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:31:41.825769 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:31:41.832794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:41.879077 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.05 seconds
[0m22:31:41.882203 [debug] [ThreadPool]: On list_postgres: Close
[0m22:31:41.885134 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m22:31:41.890297 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:31:41.892192 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:31:41.893692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:31:41.921372 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m22:31:41.923677 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:31:41.926977 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:31:41.974399 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.05 seconds
[0m22:31:41.978550 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:31:41.981109 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:31:41.986156 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:42.011417 [debug] [MainThread]: On master: BEGIN
[0m22:31:42.013026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:31:47.085215 [debug] [MainThread]: SQL status: BEGIN in 5.07 seconds
[0m22:31:47.088582 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:47.091291 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:31:47.187618 [debug] [MainThread]: SQL status: SELECT 50 in 0.09 seconds
[0m22:31:47.191690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849acdf0>]}
[0m22:31:47.194915 [debug] [MainThread]: On master: ROLLBACK
[0m22:31:47.199226 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:47.205344 [debug] [MainThread]: On master: BEGIN
[0m22:31:47.208880 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:31:47.210715 [debug] [MainThread]: On master: COMMIT
[0m22:31:47.212199 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:47.213832 [debug] [MainThread]: On master: COMMIT
[0m22:31:47.216148 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:31:47.218106 [debug] [MainThread]: On master: Close
[0m22:31:47.220904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:31:47.223737 [info ] [MainThread]: 
[0m22:31:47.230893 [debug] [Thread-1 (]: Began running node model.shared_models.stg_category
[0m22:31:47.233287 [info ] [Thread-1 (]: 1 of 26 START sql view model public.stg_category ............................... [RUN]
[0m22:31:47.236134 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_category"
[0m22:31:47.238301 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_category
[0m22:31:47.264305 [debug] [Thread-1 (]: Compiling model.shared_models.stg_category
[0m22:31:47.268316 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_category"
[0m22:31:47.291397 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:47.292764 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_category
[0m22:31:47.316735 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_category"
[0m22:31:47.338980 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m22:31:47.340466 [debug] [Thread-1 (]: On model.shared_models.stg_category: BEGIN
[0m22:31:47.341906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:52.409189 [debug] [Thread-1 (]: SQL status: BEGIN in 5.07 seconds
[0m22:31:52.412632 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m22:31:52.416641 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */

  create view "postgres"."public"."stg_category__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."category"
  );
[0m22:31:52.449524 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m22:31:52.460334 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m22:31:52.462391 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */
alter table "postgres"."public"."stg_category" rename to "stg_category__dbt_backup"
[0m22:31:52.466334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:52.469981 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m22:31:52.471298 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */
alter table "postgres"."public"."stg_category__dbt_tmp" rename to "stg_category"
[0m22:31:52.479630 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:52.490977 [debug] [Thread-1 (]: On model.shared_models.stg_category: COMMIT
[0m22:31:52.492991 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m22:31:52.494685 [debug] [Thread-1 (]: On model.shared_models.stg_category: COMMIT
[0m22:31:52.498827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:52.508613 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m22:31:52.510154 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */
drop view if exists "postgres"."public"."stg_category__dbt_backup" cascade
[0m22:31:52.518018 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m22:31:52.520248 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:52.521828 [debug] [Thread-1 (]: On model.shared_models.stg_category: Close
[0m22:31:52.523832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83eeec80>]}
[0m22:31:52.526193 [info ] [Thread-1 (]: 1 of 26 OK created sql view model public.stg_category .......................... [[32mCREATE VIEW[0m in 5.29s]
[0m22:31:52.528340 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_category
[0m22:31:52.530278 [debug] [Thread-1 (]: Began running node model.shared_models.stg_customer
[0m22:31:52.531921 [info ] [Thread-1 (]: 2 of 26 START sql view model public.stg_customer ............................... [RUN]
[0m22:31:52.533781 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_customer"
[0m22:31:52.536864 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_customer
[0m22:31:52.538541 [debug] [Thread-1 (]: Compiling model.shared_models.stg_customer
[0m22:31:52.542445 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_customer"
[0m22:31:52.571135 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:52.572564 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_customer
[0m22:31:52.576891 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_customer"
[0m22:31:52.587707 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m22:31:52.589415 [debug] [Thread-1 (]: On model.shared_models.stg_customer: BEGIN
[0m22:31:52.590940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:52.618423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:52.626575 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m22:31:52.629443 [debug] [Thread-1 (]: On model.shared_models.stg_customer: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_customer"} */

  create view "postgres"."public"."stg_customer__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."customer"
  );
[0m22:31:52.663199 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m22:31:52.669228 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m22:31:52.671141 [debug] [Thread-1 (]: On model.shared_models.stg_customer: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_customer"} */
alter table "postgres"."public"."stg_customer" rename to "stg_customer__dbt_backup"
[0m22:31:52.680050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:52.683335 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m22:31:52.685295 [debug] [Thread-1 (]: On model.shared_models.stg_customer: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_customer"} */
alter table "postgres"."public"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m22:31:52.688746 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:52.691459 [debug] [Thread-1 (]: On model.shared_models.stg_customer: COMMIT
[0m22:31:52.693186 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m22:31:52.694594 [debug] [Thread-1 (]: On model.shared_models.stg_customer: COMMIT
[0m22:31:52.698188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:52.700931 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m22:31:52.702273 [debug] [Thread-1 (]: On model.shared_models.stg_customer: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_customer"} */
drop view if exists "postgres"."public"."stg_customer__dbt_backup" cascade
[0m22:31:52.711406 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m22:31:52.713922 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:52.715453 [debug] [Thread-1 (]: On model.shared_models.stg_customer: Close
[0m22:31:52.717050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e6c5e0>]}
[0m22:31:52.742638 [info ] [Thread-1 (]: 2 of 26 OK created sql view model public.stg_customer .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m22:31:52.745039 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_customer
[0m22:31:52.747057 [debug] [Thread-1 (]: Began running node model.shared_models.stg_film
[0m22:31:52.748865 [info ] [Thread-1 (]: 3 of 26 START sql view model public.stg_film ................................... [RUN]
[0m22:31:52.750792 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_film"
[0m22:31:52.752814 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_film
[0m22:31:52.754326 [debug] [Thread-1 (]: Compiling model.shared_models.stg_film
[0m22:31:52.757734 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_film"
[0m22:31:52.768931 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:52.770358 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_film
[0m22:31:52.779126 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_film"
[0m22:31:52.784428 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m22:31:52.785710 [debug] [Thread-1 (]: On model.shared_models.stg_film: BEGIN
[0m22:31:52.792851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:52.817567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m22:31:52.819374 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m22:31:52.821198 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */

  create view "postgres"."public"."stg_film__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."film"
  );
[0m22:31:52.847981 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m22:31:52.851590 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m22:31:52.853702 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */
alter table "postgres"."public"."stg_film" rename to "stg_film__dbt_backup"
[0m22:31:52.857924 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:52.861395 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m22:31:52.864639 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */
alter table "postgres"."public"."stg_film__dbt_tmp" rename to "stg_film"
[0m22:31:52.868327 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:52.870719 [debug] [Thread-1 (]: On model.shared_models.stg_film: COMMIT
[0m22:31:52.872060 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m22:31:52.873532 [debug] [Thread-1 (]: On model.shared_models.stg_film: COMMIT
[0m22:31:52.877402 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:52.902817 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m22:31:52.904233 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */
drop view if exists "postgres"."public"."stg_film__dbt_backup" cascade
[0m22:31:52.912613 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m22:31:52.915208 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:52.916816 [debug] [Thread-1 (]: On model.shared_models.stg_film: Close
[0m22:31:52.918822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83d46f50>]}
[0m22:31:52.920408 [info ] [Thread-1 (]: 3 of 26 OK created sql view model public.stg_film .............................. [[32mCREATE VIEW[0m in 0.17s]
[0m22:31:52.927589 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_film
[0m22:31:52.929867 [debug] [Thread-1 (]: Began running node model.shared_models.stg_payment
[0m22:31:52.931829 [info ] [Thread-1 (]: 4 of 26 START sql view model public.stg_payment ................................ [RUN]
[0m22:31:52.933562 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_payment"
[0m22:31:52.935360 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_payment
[0m22:31:52.936891 [debug] [Thread-1 (]: Compiling model.shared_models.stg_payment
[0m22:31:52.945947 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_payment"
[0m22:31:52.950932 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:52.958274 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_payment
[0m22:31:52.962433 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_payment"
[0m22:31:52.967141 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m22:31:52.969402 [debug] [Thread-1 (]: On model.shared_models.stg_payment: BEGIN
[0m22:31:52.970716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:52.996545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:53.000291 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m22:31:53.002014 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */

  create view "postgres"."public"."stg_payment__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m22:31:53.025816 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m22:31:53.029383 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m22:31:53.031010 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */
alter table "postgres"."public"."stg_payment" rename to "stg_payment__dbt_backup"
[0m22:31:53.057607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:53.061396 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m22:31:53.063508 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */
alter table "postgres"."public"."stg_payment__dbt_tmp" rename to "stg_payment"
[0m22:31:53.067163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:53.069464 [debug] [Thread-1 (]: On model.shared_models.stg_payment: COMMIT
[0m22:31:53.070968 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m22:31:53.072185 [debug] [Thread-1 (]: On model.shared_models.stg_payment: COMMIT
[0m22:31:53.076377 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:53.084400 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m22:31:53.086304 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */
drop view if exists "postgres"."public"."stg_payment__dbt_backup" cascade
[0m22:31:53.094605 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m22:31:53.096895 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:53.102804 [debug] [Thread-1 (]: On model.shared_models.stg_payment: Close
[0m22:31:53.104905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83d66230>]}
[0m22:31:53.107066 [info ] [Thread-1 (]: 4 of 26 OK created sql view model public.stg_payment ........................... [[32mCREATE VIEW[0m in 0.17s]
[0m22:31:53.109047 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_payment
[0m22:31:53.110547 [debug] [Thread-1 (]: Began running node model.shared_models.stg_rental
[0m22:31:53.117947 [info ] [Thread-1 (]: 5 of 26 START sql view model public.stg_rental ................................. [RUN]
[0m22:31:53.119616 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_rental"
[0m22:31:53.121028 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_rental
[0m22:31:53.122707 [debug] [Thread-1 (]: Compiling model.shared_models.stg_rental
[0m22:31:53.126002 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_rental"
[0m22:31:53.131564 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:53.133091 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_rental
[0m22:31:53.138528 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_rental"
[0m22:31:53.181981 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m22:31:53.184782 [debug] [Thread-1 (]: On model.shared_models.stg_rental: BEGIN
[0m22:31:53.186683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:53.212360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:53.214661 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m22:31:53.216616 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */

  create view "postgres"."public"."stg_rental__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."rental"
  );
[0m22:31:53.240636 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m22:31:53.249192 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m22:31:53.251001 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */
alter table "postgres"."public"."stg_rental" rename to "stg_rental__dbt_backup"
[0m22:31:53.256540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:53.259869 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m22:31:53.261620 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */
alter table "postgres"."public"."stg_rental__dbt_tmp" rename to "stg_rental"
[0m22:31:53.269676 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:53.272417 [debug] [Thread-1 (]: On model.shared_models.stg_rental: COMMIT
[0m22:31:53.274312 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m22:31:53.276068 [debug] [Thread-1 (]: On model.shared_models.stg_rental: COMMIT
[0m22:31:53.285402 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:53.288526 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m22:31:53.290075 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */
drop view if exists "postgres"."public"."stg_rental__dbt_backup" cascade
[0m22:31:53.296636 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m22:31:53.299035 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:53.300369 [debug] [Thread-1 (]: On model.shared_models.stg_rental: Close
[0m22:31:53.302142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f19240>]}
[0m22:31:53.303518 [info ] [Thread-1 (]: 5 of 26 OK created sql view model public.stg_rental ............................ [[32mCREATE VIEW[0m in 0.18s]
[0m22:31:53.305386 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_rental
[0m22:31:53.307250 [debug] [Thread-1 (]: Began running node seed.customer.customer_base
[0m22:31:53.310595 [info ] [Thread-1 (]: 6 of 26 START seed file public.customer_base ................................... [RUN]
[0m22:31:53.312357 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.customer.customer_base"
[0m22:31:53.313823 [debug] [Thread-1 (]: Began compiling node seed.customer.customer_base
[0m22:31:53.315281 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:53.316603 [debug] [Thread-1 (]: Began executing node seed.customer.customer_base
[0m22:31:53.378573 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m22:31:53.380413 [debug] [Thread-1 (]: On seed.customer.customer_base: BEGIN
[0m22:31:53.382691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:53.407536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m22:31:53.409760 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m22:31:53.416849 [debug] [Thread-1 (]: On seed.customer.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "seed.customer.customer_base"} */
truncate table "postgres"."public"."customer_base"
[0m22:31:53.434344 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.02 seconds
[0m22:31:53.939796 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m22:31:53.942450 [debug] [Thread-1 (]: On seed.customer.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m22:31:54.004340 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.06 seconds
[0m22:31:54.011041 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.customer.customer_base"
[0m22:31:54.031190 [debug] [Thread-1 (]: On seed.customer.customer_base: COMMIT
[0m22:31:54.032907 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m22:31:54.034254 [debug] [Thread-1 (]: On seed.customer.customer_base: COMMIT
[0m22:31:54.041304 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m22:31:54.044987 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:54.046592 [debug] [Thread-1 (]: On seed.customer.customer_base: Close
[0m22:31:54.048328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84993640>]}
[0m22:31:54.049645 [info ] [Thread-1 (]: 6 of 26 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 0.74s]
[0m22:31:54.076399 [debug] [Thread-1 (]: Finished running node seed.customer.customer_base
[0m22:31:54.079659 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m22:31:54.083228 [info ] [Thread-1 (]: 7 of 26 START test not_null_stg_category_category_id ........................... [RUN]
[0m22:31:54.085938 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m22:31:54.087609 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m22:31:54.089456 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m22:31:54.098576 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m22:31:54.120186 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:54.123192 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m22:31:54.132985 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m22:31:54.149813 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m22:31:54.151597 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: BEGIN
[0m22:31:54.153104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:54.178078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m22:31:54.180033 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m22:31:54.182129 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_category_category_id.d4eb91c268"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select category_id
from "postgres"."public"."stg_category"
where category_id is null



      
    ) dbt_internal_test
[0m22:31:54.211444 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:31:54.214261 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:54.215745 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: ROLLBACK
[0m22:31:54.217861 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: Close
[0m22:31:54.219860 [info ] [Thread-1 (]: 7 of 26 PASS not_null_stg_category_category_id ................................. [[32mPASS[0m in 0.13s]
[0m22:31:54.245738 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m22:31:54.248164 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m22:31:54.250341 [info ] [Thread-1 (]: 8 of 26 START test unique_stg_category_category_id ............................. [RUN]
[0m22:31:54.253310 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m22:31:54.255339 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m22:31:54.257412 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m22:31:54.263646 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m22:31:54.276420 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:54.278239 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m22:31:54.283250 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m22:31:54.307009 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m22:31:54.311397 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: BEGIN
[0m22:31:54.318953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:54.345140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:54.347013 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m22:31:54.348385 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    category_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_category"
where category_id is not null
group by category_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:31:54.378911 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:31:54.381774 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:54.383643 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: ROLLBACK
[0m22:31:54.386082 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: Close
[0m22:31:54.388054 [info ] [Thread-1 (]: 8 of 26 PASS unique_stg_category_category_id ................................... [[32mPASS[0m in 0.13s]
[0m22:31:54.389506 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m22:31:54.393965 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m22:31:54.395648 [info ] [Thread-1 (]: 9 of 26 START test not_null_stg_customer_customer_id ........................... [RUN]
[0m22:31:54.397584 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m22:31:54.399218 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m22:31:54.400844 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m22:31:54.428350 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m22:31:54.434594 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:54.436452 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m22:31:54.440189 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m22:31:54.452163 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m22:31:54.453454 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: BEGIN
[0m22:31:54.459445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:54.485080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:54.486952 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m22:31:54.488797 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_customer"
where customer_id is null



      
    ) dbt_internal_test
[0m22:31:54.514091 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m22:31:54.522176 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:54.524144 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: ROLLBACK
[0m22:31:54.526740 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: Close
[0m22:31:54.529121 [info ] [Thread-1 (]: 9 of 26 PASS not_null_stg_customer_customer_id ................................. [[32mPASS[0m in 0.13s]
[0m22:31:54.531033 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m22:31:54.533222 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m22:31:54.535395 [info ] [Thread-1 (]: 10 of 26 START test unique_stg_customer_customer_id ............................ [RUN]
[0m22:31:54.537293 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m22:31:54.538895 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m22:31:54.540590 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m22:31:54.546672 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m22:31:54.552363 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:54.554415 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m22:31:54.580168 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m22:31:54.587087 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m22:31:54.589110 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: BEGIN
[0m22:31:54.590747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:54.620940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:54.623552 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m22:31:54.626561 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_customer_customer_id.310773d0ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:31:54.659499 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:31:54.662421 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:54.668812 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: ROLLBACK
[0m22:31:54.671235 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: Close
[0m22:31:54.672972 [info ] [Thread-1 (]: 10 of 26 PASS unique_stg_customer_customer_id .................................. [[32mPASS[0m in 0.14s]
[0m22:31:54.674842 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m22:31:54.676617 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m22:31:54.683661 [info ] [Thread-1 (]: 11 of 26 START test not_null_stg_film_film_id .................................. [RUN]
[0m22:31:54.685244 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m22:31:54.686570 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m22:31:54.688198 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m22:31:54.692034 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m22:31:54.697176 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:54.699087 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m22:31:54.701638 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m22:31:54.708568 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m22:31:54.710429 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: BEGIN
[0m22:31:54.711881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:54.761605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m22:31:54.763813 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m22:31:54.765562 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select film_id
from "postgres"."public"."stg_film"
where film_id is null



      
    ) dbt_internal_test
[0m22:31:54.792431 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:31:54.795524 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:54.797106 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: ROLLBACK
[0m22:31:54.805619 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: Close
[0m22:31:54.807597 [info ] [Thread-1 (]: 11 of 26 PASS not_null_stg_film_film_id ........................................ [[32mPASS[0m in 0.12s]
[0m22:31:54.809090 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m22:31:54.810902 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m22:31:54.812437 [info ] [Thread-1 (]: 12 of 26 START test unique_stg_film_film_id .................................... [RUN]
[0m22:31:54.819240 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m22:31:54.821053 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m22:31:54.823270 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m22:31:54.827614 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m22:31:54.839301 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:54.840944 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m22:31:54.843617 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m22:31:54.848172 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m22:31:54.849847 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: BEGIN
[0m22:31:54.852945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:54.878809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:54.881230 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m22:31:54.883178 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_film_film_id.1cbe88695a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    film_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_film"
where film_id is not null
group by film_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:31:54.917711 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:31:54.942930 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:54.944762 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: ROLLBACK
[0m22:31:54.947289 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: Close
[0m22:31:54.949979 [info ] [Thread-1 (]: 12 of 26 PASS unique_stg_film_film_id .......................................... [[32mPASS[0m in 0.13s]
[0m22:31:54.951798 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m22:31:54.953967 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m22:31:54.955950 [info ] [Thread-1 (]: 13 of 26 START test not_null_stg_payment_customer_id ........................... [RUN]
[0m22:31:54.958191 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m22:31:54.965196 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m22:31:54.966656 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m22:31:54.971578 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m22:31:54.982999 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:54.985814 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m22:31:54.988779 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m22:31:55.000010 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m22:31:55.001709 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: BEGIN
[0m22:31:55.003236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:55.027953 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m22:31:55.030603 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m22:31:55.031799 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_payment"
where customer_id is null



      
    ) dbt_internal_test
[0m22:31:55.059006 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:31:55.063446 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:55.065831 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: ROLLBACK
[0m22:31:55.068600 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: Close
[0m22:31:55.071334 [info ] [Thread-1 (]: 13 of 26 PASS not_null_stg_payment_customer_id ................................. [[32mPASS[0m in 0.11s]
[0m22:31:55.075225 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m22:31:55.099969 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m22:31:55.101991 [info ] [Thread-1 (]: 14 of 26 START test not_null_stg_payment_payment_id ............................ [RUN]
[0m22:31:55.104017 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m22:31:55.106251 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m22:31:55.108414 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m22:31:55.113230 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m22:31:55.123979 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:55.125985 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m22:31:55.129104 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m22:31:55.139164 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m22:31:55.140781 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: BEGIN
[0m22:31:55.147852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:55.173802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:55.175763 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m22:31:55.177666 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payment"
where payment_id is null



      
    ) dbt_internal_test
[0m22:31:55.205951 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:31:55.208897 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:55.210774 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: ROLLBACK
[0m22:31:55.213115 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: Close
[0m22:31:55.214814 [info ] [Thread-1 (]: 14 of 26 PASS not_null_stg_payment_payment_id .................................. [[32mPASS[0m in 0.11s]
[0m22:31:55.217702 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m22:31:55.219606 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m22:31:55.222718 [info ] [Thread-1 (]: 15 of 26 START test unique_stg_payment_payment_id .............................. [RUN]
[0m22:31:55.224878 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m22:31:55.226569 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m22:31:55.228256 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m22:31:55.255666 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m22:31:55.262880 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:55.264612 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m22:31:55.267591 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m22:31:55.278668 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m22:31:55.280317 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: BEGIN
[0m22:31:55.281789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:55.311798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:55.313985 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m22:31:55.315465 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_payment_payment_id.7398e70184"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payment"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:31:55.392065 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.07 seconds
[0m22:31:55.400727 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:55.402660 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: ROLLBACK
[0m22:31:55.405231 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: Close
[0m22:31:55.407652 [info ] [Thread-1 (]: 15 of 26 PASS unique_stg_payment_payment_id .................................... [[32mPASS[0m in 0.18s]
[0m22:31:55.409716 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m22:31:55.412149 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m22:31:55.414175 [info ] [Thread-1 (]: 16 of 26 START test not_null_stg_rental_rental_id .............................. [RUN]
[0m22:31:55.415833 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m22:31:55.417298 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m22:31:55.419311 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m22:31:55.423723 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m22:31:55.428713 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:55.430426 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m22:31:55.456760 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m22:31:55.463460 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m22:31:55.465820 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: BEGIN
[0m22:31:55.467299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:55.491608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m22:31:55.498214 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m22:31:55.500182 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rental_id
from "postgres"."public"."stg_rental"
where rental_id is null



      
    ) dbt_internal_test
[0m22:31:55.526042 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m22:31:55.528712 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:55.530604 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: ROLLBACK
[0m22:31:55.538376 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: Close
[0m22:31:55.540290 [info ] [Thread-1 (]: 16 of 26 PASS not_null_stg_rental_rental_id .................................... [[32mPASS[0m in 0.12s]
[0m22:31:55.541988 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m22:31:55.543742 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m22:31:55.545300 [info ] [Thread-1 (]: 17 of 26 START test unique_stg_rental_rental_id ................................ [RUN]
[0m22:31:55.547219 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m22:31:55.554090 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m22:31:55.555706 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_rental_rental_id.b263207352
[0m22:31:55.560618 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m22:31:55.566161 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:55.567613 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m22:31:55.570759 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m22:31:55.578694 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m22:31:55.580388 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: BEGIN
[0m22:31:55.581772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:55.629589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m22:31:55.631446 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m22:31:55.632949 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_rental_rental_id.b263207352"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    rental_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_rental"
where rental_id is not null
group by rental_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:31:55.710618 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.08 seconds
[0m22:31:55.714803 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:55.717957 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: ROLLBACK
[0m22:31:55.721542 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: Close
[0m22:31:55.730461 [info ] [Thread-1 (]: 17 of 26 PASS unique_stg_rental_rental_id ...................................... [[32mPASS[0m in 0.18s]
[0m22:31:55.739210 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m22:31:55.743236 [debug] [Thread-1 (]: Began running node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m22:31:55.750599 [info ] [Thread-1 (]: 18 of 26 START test not_null_customer_base_customer_id ......................... [RUN]
[0m22:31:55.753429 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m22:31:55.756654 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m22:31:55.758827 [debug] [Thread-1 (]: Compiling test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m22:31:55.765972 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m22:31:55.790804 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:55.816626 [debug] [Thread-1 (]: Began executing node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m22:31:55.820175 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m22:31:55.830354 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m22:31:55.837360 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m22:31:55.838962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:55.864051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:55.866754 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m22:31:55.868920 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m22:31:55.896638 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m22:31:55.899677 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:55.901806 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m22:31:55.904556 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: Close
[0m22:31:55.906941 [info ] [Thread-1 (]: 18 of 26 PASS not_null_customer_base_customer_id ............................... [[32mPASS[0m in 0.15s]
[0m22:31:55.914702 [debug] [Thread-1 (]: Finished running node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m22:31:55.916675 [debug] [Thread-1 (]: Began running node test.customer.not_null_customer_base_store_id.e159464168
[0m22:31:55.918526 [info ] [Thread-1 (]: 19 of 26 START test not_null_customer_base_store_id ............................ [RUN]
[0m22:31:55.920780 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_customer_base_store_id.e159464168"
[0m22:31:55.922613 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_customer_base_store_id.e159464168
[0m22:31:55.924278 [debug] [Thread-1 (]: Compiling test.customer.not_null_customer_base_store_id.e159464168
[0m22:31:55.928515 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_customer_base_store_id.e159464168"
[0m22:31:55.936397 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:55.938136 [debug] [Thread-1 (]: Began executing node test.customer.not_null_customer_base_store_id.e159464168
[0m22:31:55.940880 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_customer_base_store_id.e159464168"
[0m22:31:55.968733 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_store_id.e159464168"
[0m22:31:55.970883 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: BEGIN
[0m22:31:55.972613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:55.997815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:56.000709 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_store_id.e159464168"
[0m22:31:56.002312 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m22:31:56.029142 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m22:31:56.032194 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:56.033673 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m22:31:56.035974 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: Close
[0m22:31:56.037746 [info ] [Thread-1 (]: 19 of 26 PASS not_null_customer_base_store_id .................................. [[32mPASS[0m in 0.12s]
[0m22:31:56.044385 [debug] [Thread-1 (]: Finished running node test.customer.not_null_customer_base_store_id.e159464168
[0m22:31:56.045896 [debug] [Thread-1 (]: Began running node model.shared_models.int_revenue_by_date
[0m22:31:56.047300 [info ] [Thread-1 (]: 20 of 26 START sql view model public.int_revenue_by_date ....................... [RUN]
[0m22:31:56.048971 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.int_revenue_by_date"
[0m22:31:56.050392 [debug] [Thread-1 (]: Began compiling node model.shared_models.int_revenue_by_date
[0m22:31:56.057757 [debug] [Thread-1 (]: Compiling model.shared_models.int_revenue_by_date
[0m22:31:56.060944 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.int_revenue_by_date"
[0m22:31:56.069029 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:56.070637 [debug] [Thread-1 (]: Began executing node model.shared_models.int_revenue_by_date
[0m22:31:56.075950 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.int_revenue_by_date"
[0m22:31:56.109679 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m22:31:56.111726 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: BEGIN
[0m22:31:56.113572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:56.138441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m22:31:56.140522 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m22:31:56.143704 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    "postgres"."public"."stg_payment"
GROUP BY
    1
  );
[0m22:31:56.172270 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m22:31:56.201502 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m22:31:56.203749 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date__dbt_tmp" rename to "int_revenue_by_date"
[0m22:31:56.208113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:56.211128 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: COMMIT
[0m22:31:56.212989 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m22:31:56.219356 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: COMMIT
[0m22:31:56.223539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:56.226509 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m22:31:56.227749 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.int_revenue_by_date"} */
drop view if exists "postgres"."public"."int_revenue_by_date__dbt_backup" cascade
[0m22:31:56.230047 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:31:56.238215 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:56.239828 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: Close
[0m22:31:56.242249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8198b2b0>]}
[0m22:31:56.243465 [info ] [Thread-1 (]: 20 of 26 OK created sql view model public.int_revenue_by_date .................. [[32mCREATE VIEW[0m in 0.19s]
[0m22:31:56.245143 [debug] [Thread-1 (]: Finished running node model.shared_models.int_revenue_by_date
[0m22:31:56.247382 [debug] [Thread-1 (]: Began running node model.customer.int_customers_per_store
[0m22:31:56.249069 [info ] [Thread-1 (]: 21 of 26 START sql view model public.int_customers_per_store ................... [RUN]
[0m22:31:56.251191 [debug] [Thread-1 (]: Acquiring new postgres connection "model.customer.int_customers_per_store"
[0m22:31:56.252947 [debug] [Thread-1 (]: Began compiling node model.customer.int_customers_per_store
[0m22:31:56.254244 [debug] [Thread-1 (]: Compiling model.customer.int_customers_per_store
[0m22:31:56.258651 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer.int_customers_per_store"
[0m22:31:56.295298 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:56.297600 [debug] [Thread-1 (]: Began executing node model.customer.int_customers_per_store
[0m22:31:56.302138 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer.int_customers_per_store"
[0m22:31:56.328956 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m22:31:56.330894 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: BEGIN
[0m22:31:56.332230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:56.363073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:56.365299 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m22:31:56.367027 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */

  create view "postgres"."public"."int_customers_per_store__dbt_tmp" as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    "postgres"."public"."customer_base"
GROUP BY
    1
  );
[0m22:31:56.395065 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m22:31:56.398767 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m22:31:56.400359 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store" rename to "int_customers_per_store__dbt_backup"
[0m22:31:56.403787 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:56.406848 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m22:31:56.408541 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store__dbt_tmp" rename to "int_customers_per_store"
[0m22:31:56.413452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:56.416114 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: COMMIT
[0m22:31:56.417679 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m22:31:56.419263 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: COMMIT
[0m22:31:56.423298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:56.426030 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m22:31:56.449456 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */
drop view if exists "postgres"."public"."int_customers_per_store__dbt_backup" cascade
[0m22:31:56.457049 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m22:31:56.459113 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:56.460361 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: Close
[0m22:31:56.461983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84897e20>]}
[0m22:31:56.463439 [info ] [Thread-1 (]: 21 of 26 OK created sql view model public.int_customers_per_store .............. [[32mCREATE VIEW[0m in 0.21s]
[0m22:31:56.464958 [debug] [Thread-1 (]: Finished running node model.customer.int_customers_per_store
[0m22:31:56.471864 [debug] [Thread-1 (]: Began running node model.customer.cumulative_revenue
[0m22:31:56.473791 [info ] [Thread-1 (]: 22 of 26 START sql table model public.cumulative_revenue ....................... [RUN]
[0m22:31:56.475976 [debug] [Thread-1 (]: Acquiring new postgres connection "model.customer.cumulative_revenue"
[0m22:31:56.477670 [debug] [Thread-1 (]: Began compiling node model.customer.cumulative_revenue
[0m22:31:56.479164 [debug] [Thread-1 (]: Compiling model.customer.cumulative_revenue
[0m22:31:56.488119 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer.cumulative_revenue"
[0m22:31:56.501404 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:56.503182 [debug] [Thread-1 (]: Began executing node model.customer.cumulative_revenue
[0m22:31:56.515697 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer.cumulative_revenue"
[0m22:31:56.524180 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m22:31:56.525784 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: BEGIN
[0m22:31:56.528893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:56.555111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:56.556753 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m22:31:56.558030 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */

  
    

  create  table "postgres"."public"."cumulative_revenue__dbt_tmp"
  as (
    

SELECT
    payment_date,
    amount,
    SUM(amount) OVER (ORDER BY payment_date)
FROM
    "postgres"."public"."int_revenue_by_date"
ORDER BY
    payment_date
  );
  
[0m22:31:56.669265 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.09 seconds
[0m22:31:56.673035 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m22:31:56.674936 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue" rename to "cumulative_revenue__dbt_backup"
[0m22:31:56.678745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:56.682258 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m22:31:56.683883 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue__dbt_tmp" rename to "cumulative_revenue"
[0m22:31:56.686823 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:31:56.697153 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: COMMIT
[0m22:31:56.699329 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m22:31:56.700962 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: COMMIT
[0m22:31:56.705154 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:56.707717 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m22:31:56.713909 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
drop table if exists "postgres"."public"."cumulative_revenue__dbt_backup" cascade
[0m22:31:56.723399 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m22:31:56.726095 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:56.727399 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: Close
[0m22:31:56.728974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849311b0>]}
[0m22:31:56.736464 [info ] [Thread-1 (]: 22 of 26 OK created sql table model public.cumulative_revenue .................. [[32mSELECT 40[0m in 0.25s]
[0m22:31:56.738467 [debug] [Thread-1 (]: Finished running node model.customer.cumulative_revenue
[0m22:31:56.740255 [debug] [Thread-1 (]: Began running node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m22:31:56.742224 [info ] [Thread-1 (]: 23 of 26 START test not_null_int_customers_per_store_store_id .................. [RUN]
[0m22:31:56.744738 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m22:31:56.746033 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m22:31:56.747295 [debug] [Thread-1 (]: Compiling test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m22:31:56.751216 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m22:31:56.761855 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:56.763720 [debug] [Thread-1 (]: Began executing node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m22:31:56.790165 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m22:31:56.800412 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m22:31:56.807031 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m22:31:56.808592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:56.835618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:56.838148 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m22:31:56.839792 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."int_customers_per_store"
where store_id is null



      
    ) dbt_internal_test
[0m22:31:56.869733 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m22:31:56.872113 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:56.874338 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m22:31:56.876870 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m22:31:56.879249 [info ] [Thread-1 (]: 23 of 26 PASS not_null_int_customers_per_store_store_id ........................ [[32mPASS[0m in 0.14s]
[0m22:31:56.886751 [debug] [Thread-1 (]: Finished running node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m22:31:56.888553 [debug] [Thread-1 (]: Began running node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m22:31:56.890059 [info ] [Thread-1 (]: 24 of 26 START test not_null_int_customers_per_store_total_customers ........... [RUN]
[0m22:31:56.891844 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m22:31:56.893430 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m22:31:56.895219 [debug] [Thread-1 (]: Compiling test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m22:31:56.900074 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m22:31:56.907088 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:56.908521 [debug] [Thread-1 (]: Began executing node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m22:31:56.911578 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m22:31:56.940255 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m22:31:56.942014 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m22:31:56.943763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:56.970932 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:56.972829 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m22:31:56.974275 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_customers
from "postgres"."public"."int_customers_per_store"
where total_customers is null



      
    ) dbt_internal_test
[0m22:31:57.006536 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m22:31:57.009064 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:57.010551 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m22:31:57.013312 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m22:31:57.015027 [info ] [Thread-1 (]: 24 of 26 PASS not_null_int_customers_per_store_total_customers ................. [[32mPASS[0m in 0.12s]
[0m22:31:57.021601 [debug] [Thread-1 (]: Finished running node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m22:31:57.023321 [debug] [Thread-1 (]: Began running node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m22:31:57.024943 [info ] [Thread-1 (]: 25 of 26 START test unique_int_customers_per_store_store_id .................... [RUN]
[0m22:31:57.026748 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m22:31:57.028670 [debug] [Thread-1 (]: Began compiling node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m22:31:57.035562 [debug] [Thread-1 (]: Compiling test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m22:31:57.039714 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m22:31:57.044743 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:57.046091 [debug] [Thread-1 (]: Began executing node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m22:31:57.048674 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m22:31:57.054834 [debug] [Thread-1 (]: Using postgres connection "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m22:31:57.056940 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m22:31:57.058455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:57.083931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:31:57.109225 [debug] [Thread-1 (]: Using postgres connection "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m22:31:57.111240 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "postgres"."public"."int_customers_per_store"
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:31:57.143117 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:31:57.146377 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:57.148320 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m22:31:57.151401 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m22:31:57.153396 [info ] [Thread-1 (]: 25 of 26 PASS unique_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.13s]
[0m22:31:57.161184 [debug] [Thread-1 (]: Finished running node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m22:31:57.163285 [debug] [Thread-1 (]: Began running node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m22:31:57.165416 [info ] [Thread-1 (]: 26 of 26 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot  [RUN]
[0m22:31:57.167514 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:31:57.169285 [debug] [Thread-1 (]: Began compiling node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m22:31:57.175129 [debug] [Thread-1 (]: Compiling snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m22:31:57.178604 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:57.180057 [debug] [Thread-1 (]: Began executing node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m22:31:57.207425 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:31:57.210130 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */
select * from (
            select total_customers from (

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"
) subq
        ) as __dbt_sbq
        where false
        limit 0
    
[0m22:31:57.217156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:57.257175 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.04 seconds
[0m22:31:57.263823 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:31:57.265637 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m22:31:57.268197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:57.269646 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:31:57.271023 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:31:57.339947 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.07 seconds
[0m22:31:57.347114 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:31:57.350447 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:31:57.366987 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m22:31:57.376899 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:31:57.378580 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

        
  
    

  create temporary table "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp223157373230"
  as (
    with snapshot_query as (

        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"


    ),

    snapshotted_data as (

        select *,
            store_id as dbt_unique_key

        from "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(store_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            store_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m22:31:57.440169 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.04 seconds
[0m22:31:57.444771 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:31:57.448414 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp223157373230'
        
      order by ordinal_position

  
[0m22:31:57.466240 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.01 seconds
[0m22:31:57.470586 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:31:57.472388 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:31:57.488462 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m22:31:57.497441 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:31:57.498850 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp223157373230'
        
      order by ordinal_position

  
[0m22:31:57.515319 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m22:31:57.519453 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:31:57.521046 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:31:57.540915 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m22:31:57.546578 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:31:57.548142 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp223157373230'
        
      order by ordinal_position

  
[0m22:31:57.564319 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.01 seconds
[0m22:31:57.569912 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:31:57.584246 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:31:57.586024 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      update "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp223157373230" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_valid_to is null;

    insert into "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot" ("store_id", "total_customers", "current_date", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."store_id",DBT_INTERNAL_SOURCE."total_customers",DBT_INTERNAL_SOURCE."current_date",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp223157373230" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m22:31:57.593914 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.01 seconds
[0m22:31:57.596776 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m22:31:57.598581 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:31:57.601809 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m22:31:57.605754 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:57.608941 [debug] [Thread-1 (]: finished collecting timing info
[0m22:31:57.610581 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m22:31:57.635678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89e63d21-f0ca-49ef-bb08-3ac2fe4d5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83dd8100>]}
[0m22:31:57.638270 [info ] [Thread-1 (]: 26 of 26 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot  [[32mINSERT 0 0[0m in 0.47s]
[0m22:31:57.640678 [debug] [Thread-1 (]: Finished running node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m22:31:57.644388 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m22:31:57.646499 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:57.648070 [debug] [MainThread]: On master: BEGIN
[0m22:31:57.649778 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:31:57.674393 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m22:31:57.681683 [debug] [MainThread]: On master: COMMIT
[0m22:31:57.683614 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:57.685684 [debug] [MainThread]: On master: COMMIT
[0m22:31:57.688167 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:31:57.694923 [debug] [MainThread]: On master: Close
[0m22:31:57.697295 [info ] [MainThread]: 
[0m22:31:57.699410 [info ] [MainThread]: Finished running 7 view models, 1 seed, 16 tests, 1 table model, 1 snapshot in 0 hours 0 minutes and 15.88 seconds (15.88s).
[0m22:31:57.701302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:31:57.702788 [debug] [MainThread]: Connection 'snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m22:31:57.769595 [info ] [MainThread]: 
[0m22:31:57.771737 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:31:57.778625 [info ] [MainThread]: 
[0m22:31:57.780792 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=0 SKIP=0 TOTAL=26
[0m22:31:57.782846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e6d060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e6d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e6d5a0>]}
[0m22:31:57.784211 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 22:35:37.654701 | 0c7ced85-2bb4-44f9-a9ea-a58b8f6b1d39 ==============================
[0m22:35:37.654712 [info ] [MainThread]: Running with dbt=1.3.1
[0m22:35:37.656999 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m22:35:37.658679 [debug] [MainThread]: Tracking: tracking
[0m22:35:37.685812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dade680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dade590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dade5f0>]}
[0m22:35:38.126454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:35:38.128054 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:35:38.135416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c7ced85-2bb4-44f9-a9ea-a58b8f6b1d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce894e0>]}
[0m22:35:38.205555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c7ced85-2bb4-44f9-a9ea-a58b8f6b1d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce4c3a0>]}
[0m22:35:38.208147 [info ] [MainThread]: Found 8 models, 16 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 5 sources, 0 exposures, 0 metrics
[0m22:35:38.210288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c7ced85-2bb4-44f9-a9ea-a58b8f6b1d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce4c040>]}
[0m22:35:38.213223 [info ] [MainThread]: 
[0m22:35:38.220426 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m22:35:38.223312 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m22:35:38.231211 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m22:35:38.232905 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m22:35:38.238984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:43.339857 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.1 seconds
[0m22:35:43.343158 [debug] [ThreadPool]: On list_postgres: Close
[0m22:35:43.346648 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m22:35:43.352509 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:35:43.354374 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:35:43.358155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:35:48.409627 [debug] [ThreadPool]: SQL status: BEGIN in 5.05 seconds
[0m22:35:48.417294 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:35:48.430014 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:35:48.482158 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.05 seconds
[0m22:35:48.485506 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:35:48.488100 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:35:48.497749 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:48.499788 [debug] [MainThread]: On master: BEGIN
[0m22:35:48.501320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:35:53.570858 [debug] [MainThread]: SQL status: BEGIN in 5.07 seconds
[0m22:35:53.573990 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:53.577584 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:35:53.659279 [debug] [MainThread]: SQL status: SELECT 49 in 0.08 seconds
[0m22:35:53.664573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c7ced85-2bb4-44f9-a9ea-a58b8f6b1d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce33a60>]}
[0m22:35:53.667168 [debug] [MainThread]: On master: ROLLBACK
[0m22:35:53.669538 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:53.671588 [debug] [MainThread]: On master: BEGIN
[0m22:35:53.696565 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:35:53.698892 [debug] [MainThread]: On master: COMMIT
[0m22:35:53.700451 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:53.702435 [debug] [MainThread]: On master: COMMIT
[0m22:35:53.704637 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:35:53.706121 [debug] [MainThread]: On master: Close
[0m22:35:53.707701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:35:53.709207 [info ] [MainThread]: 
[0m22:35:53.718940 [debug] [Thread-1 (]: Began running node model.shared_models.stg_category
[0m22:35:53.720696 [info ] [Thread-1 (]: 1 of 26 START sql view model public.stg_category ............................... [RUN]
[0m22:35:53.722848 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_category"
[0m22:35:53.724575 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_category
[0m22:35:53.726005 [debug] [Thread-1 (]: Compiling model.shared_models.stg_category
[0m22:35:53.734349 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_category"
[0m22:35:53.740742 [debug] [Thread-1 (]: finished collecting timing info
[0m22:35:53.748215 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_category
[0m22:35:53.768228 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_category"
[0m22:35:53.776439 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m22:35:53.778389 [debug] [Thread-1 (]: On model.shared_models.stg_category: BEGIN
[0m22:35:53.780009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:53.807566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:35:53.812390 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m22:35:53.815312 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */

  create view "postgres"."public"."stg_category__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."category"
  );
[0m22:35:53.843254 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m22:35:53.849588 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m22:35:53.874077 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */
alter table "postgres"."public"."stg_category" rename to "stg_category__dbt_backup"
[0m22:35:53.878342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:53.881698 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m22:35:53.883702 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */
alter table "postgres"."public"."stg_category__dbt_tmp" rename to "stg_category"
[0m22:35:53.887484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:53.898152 [debug] [Thread-1 (]: On model.shared_models.stg_category: COMMIT
[0m22:35:53.899544 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m22:35:53.901023 [debug] [Thread-1 (]: On model.shared_models.stg_category: COMMIT
[0m22:35:53.911350 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:35:53.915930 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m22:35:53.917589 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */
drop view if exists "postgres"."public"."stg_category__dbt_backup" cascade
[0m22:35:53.926724 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m22:35:53.928951 [debug] [Thread-1 (]: finished collecting timing info
[0m22:35:53.934570 [debug] [Thread-1 (]: On model.shared_models.stg_category: Close
[0m22:35:53.936605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c7ced85-2bb4-44f9-a9ea-a58b8f6b1d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc2d030>]}
[0m22:35:53.937982 [info ] [Thread-1 (]: 1 of 26 OK created sql view model public.stg_category .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m22:35:53.939739 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_category
[0m22:35:53.946802 [debug] [Thread-1 (]: Began running node model.shared_models.stg_customer
[0m22:35:53.948632 [info ] [Thread-1 (]: 2 of 26 START sql view model public.stg_customer ............................... [RUN]
[0m22:35:53.950425 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_customer"
[0m22:35:53.951939 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_customer
[0m22:35:53.953714 [debug] [Thread-1 (]: Compiling model.shared_models.stg_customer
[0m22:35:53.957119 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_customer"
[0m22:35:53.962546 [debug] [Thread-1 (]: finished collecting timing info
[0m22:35:53.965588 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_customer
[0m22:35:53.969657 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_customer"
[0m22:35:53.974131 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m22:35:53.998515 [debug] [Thread-1 (]: On model.shared_models.stg_customer: BEGIN
[0m22:35:54.000632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:54.026233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:35:54.027898 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m22:35:54.029859 [debug] [Thread-1 (]: On model.shared_models.stg_customer: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_customer"} */

  create view "postgres"."public"."stg_customer__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."customer"
  );
[0m22:35:54.054483 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m22:35:54.058523 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m22:35:54.064352 [debug] [Thread-1 (]: On model.shared_models.stg_customer: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_customer"} */
alter table "postgres"."public"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m22:35:54.071397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m22:35:54.074161 [debug] [Thread-1 (]: On model.shared_models.stg_customer: COMMIT
[0m22:35:54.075832 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m22:35:54.082423 [debug] [Thread-1 (]: On model.shared_models.stg_customer: COMMIT
[0m22:35:54.087231 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:35:54.089725 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m22:35:54.090943 [debug] [Thread-1 (]: On model.shared_models.stg_customer: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_customer"} */
drop view if exists "postgres"."public"."stg_customer__dbt_backup" cascade
[0m22:35:54.093190 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:35:54.100849 [debug] [Thread-1 (]: finished collecting timing info
[0m22:35:54.102649 [debug] [Thread-1 (]: On model.shared_models.stg_customer: Close
[0m22:35:54.104378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c7ced85-2bb4-44f9-a9ea-a58b8f6b1d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cbdc5e0>]}
[0m22:35:54.106641 [info ] [Thread-1 (]: 2 of 26 OK created sql view model public.stg_customer .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m22:35:54.108309 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_customer
[0m22:35:54.110370 [debug] [Thread-1 (]: Began running node model.shared_models.stg_film
[0m22:35:54.111767 [info ] [Thread-1 (]: 3 of 26 START sql view model public.stg_film ................................... [RUN]
[0m22:35:54.113708 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_film"
[0m22:35:54.115277 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_film
[0m22:35:54.117883 [debug] [Thread-1 (]: Compiling model.shared_models.stg_film
[0m22:35:54.122329 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_film"
[0m22:35:54.127167 [debug] [Thread-1 (]: finished collecting timing info
[0m22:35:54.151905 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_film
[0m22:35:54.157079 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_film"
[0m22:35:54.163461 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m22:35:54.165019 [debug] [Thread-1 (]: On model.shared_models.stg_film: BEGIN
[0m22:35:54.166440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:54.196836 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:35:54.216252 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m22:35:54.218243 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */

  create view "postgres"."public"."stg_film__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."film"
  );
[0m22:35:54.243833 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m22:35:54.247726 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m22:35:54.252398 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */
alter table "postgres"."public"."stg_film" rename to "stg_film__dbt_backup"
[0m22:35:54.256994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:54.260534 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m22:35:54.262402 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */
alter table "postgres"."public"."stg_film__dbt_tmp" rename to "stg_film"
[0m22:35:54.272987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:54.277303 [debug] [Thread-1 (]: On model.shared_models.stg_film: COMMIT
[0m22:35:54.280372 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m22:35:54.282122 [debug] [Thread-1 (]: On model.shared_models.stg_film: COMMIT
[0m22:35:54.286079 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:35:54.289679 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m22:35:54.291405 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */
drop view if exists "postgres"."public"."stg_film__dbt_backup" cascade
[0m22:35:54.299165 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m22:35:54.302131 [debug] [Thread-1 (]: finished collecting timing info
[0m22:35:54.305510 [debug] [Thread-1 (]: On model.shared_models.stg_film: Close
[0m22:35:54.315510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c7ced85-2bb4-44f9-a9ea-a58b8f6b1d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c2a2f20>]}
[0m22:35:54.321302 [info ] [Thread-1 (]: 3 of 26 OK created sql view model public.stg_film .............................. [[32mCREATE VIEW[0m in 0.20s]
[0m22:35:54.325972 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_film
[0m22:35:54.327938 [debug] [Thread-1 (]: Began running node model.shared_models.stg_payment
[0m22:35:54.353460 [info ] [Thread-1 (]: 4 of 26 START sql view model public.stg_payment ................................ [RUN]
[0m22:35:54.355557 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_payment"
[0m22:35:54.357179 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_payment
[0m22:35:54.359318 [debug] [Thread-1 (]: Compiling model.shared_models.stg_payment
[0m22:35:54.362685 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_payment"
[0m22:35:54.367263 [debug] [Thread-1 (]: finished collecting timing info
[0m22:35:54.374414 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_payment
[0m22:35:54.378575 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_payment"
[0m22:35:54.383216 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m22:35:54.389463 [debug] [Thread-1 (]: On model.shared_models.stg_payment: BEGIN
[0m22:35:54.390940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:54.415688 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m22:35:54.417517 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m22:35:54.424895 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */

  create view "postgres"."public"."stg_payment__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m22:35:54.450833 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m22:35:54.455151 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m22:35:54.457371 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */
alter table "postgres"."public"."stg_payment" rename to "stg_payment__dbt_backup"
[0m22:35:54.460506 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:54.463542 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m22:35:54.465159 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */
alter table "postgres"."public"."stg_payment__dbt_tmp" rename to "stg_payment"
[0m22:35:54.469567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:54.472185 [debug] [Thread-1 (]: On model.shared_models.stg_payment: COMMIT
[0m22:35:54.473727 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m22:35:54.476517 [debug] [Thread-1 (]: On model.shared_models.stg_payment: COMMIT
[0m22:35:54.480284 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:35:54.482685 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m22:35:54.484272 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */
drop view if exists "postgres"."public"."stg_payment__dbt_backup" cascade
[0m22:35:54.492581 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m22:35:54.495176 [debug] [Thread-1 (]: finished collecting timing info
[0m22:35:54.518997 [debug] [Thread-1 (]: On model.shared_models.stg_payment: Close
[0m22:35:54.522566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c7ced85-2bb4-44f9-a9ea-a58b8f6b1d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c29af50>]}
[0m22:35:54.524627 [info ] [Thread-1 (]: 4 of 26 OK created sql view model public.stg_payment ........................... [[32mCREATE VIEW[0m in 0.17s]
[0m22:35:54.527407 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_payment
[0m22:35:54.529296 [debug] [Thread-1 (]: Began running node model.shared_models.stg_rental
[0m22:35:54.531410 [info ] [Thread-1 (]: 5 of 26 START sql view model public.stg_rental ................................. [RUN]
[0m22:35:54.538805 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_rental"
[0m22:35:54.540432 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_rental
[0m22:35:54.541958 [debug] [Thread-1 (]: Compiling model.shared_models.stg_rental
[0m22:35:54.545553 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_rental"
[0m22:35:54.556125 [debug] [Thread-1 (]: finished collecting timing info
[0m22:35:54.558211 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_rental
[0m22:35:54.562490 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_rental"
[0m22:35:54.573452 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m22:35:54.575559 [debug] [Thread-1 (]: On model.shared_models.stg_rental: BEGIN
[0m22:35:54.577362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:54.602479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:35:54.605389 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m22:35:54.606919 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */

  create view "postgres"."public"."stg_rental__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."rental"
  );
[0m22:35:54.631639 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m22:35:54.635240 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m22:35:54.637232 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */
alter table "postgres"."public"."stg_rental" rename to "stg_rental__dbt_backup"
[0m22:35:54.642603 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:54.646450 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m22:35:54.648155 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */
alter table "postgres"."public"."stg_rental__dbt_tmp" rename to "stg_rental"
[0m22:35:54.651560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:54.654085 [debug] [Thread-1 (]: On model.shared_models.stg_rental: COMMIT
[0m22:35:54.678406 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m22:35:54.680363 [debug] [Thread-1 (]: On model.shared_models.stg_rental: COMMIT
[0m22:35:54.684826 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:35:54.687490 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m22:35:54.688819 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */
drop view if exists "postgres"."public"."stg_rental__dbt_backup" cascade
[0m22:35:54.695761 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m22:35:54.697847 [debug] [Thread-1 (]: finished collecting timing info
[0m22:35:54.705253 [debug] [Thread-1 (]: On model.shared_models.stg_rental: Close
[0m22:35:54.707891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c7ced85-2bb4-44f9-a9ea-a58b8f6b1d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c2ec3d0>]}
[0m22:35:54.710239 [info ] [Thread-1 (]: 5 of 26 OK created sql view model public.stg_rental ............................ [[32mCREATE VIEW[0m in 0.17s]
[0m22:35:54.712311 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_rental
[0m22:35:54.714454 [debug] [Thread-1 (]: Began running node seed.customer.customer_base
[0m22:35:54.720812 [info ] [Thread-1 (]: 6 of 26 START seed file public.customer_base ................................... [RUN]
[0m22:35:54.722865 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.customer.customer_base"
[0m22:35:54.724897 [debug] [Thread-1 (]: Began compiling node seed.customer.customer_base
[0m22:35:54.726255 [debug] [Thread-1 (]: finished collecting timing info
[0m22:35:54.727588 [debug] [Thread-1 (]: Began executing node seed.customer.customer_base
[0m22:35:54.774636 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m22:35:54.776869 [debug] [Thread-1 (]: On seed.customer.customer_base: BEGIN
[0m22:35:54.778684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:54.805193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:35:54.807483 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m22:35:54.808710 [debug] [Thread-1 (]: On seed.customer.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "seed.customer.customer_base"} */
truncate table "postgres"."public"."customer_base"
[0m22:35:54.824971 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m22:35:55.333179 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m22:35:55.336889 [debug] [Thread-1 (]: On seed.customer.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m22:35:55.390220 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.05 seconds
[0m22:35:55.396098 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.customer.customer_base"
[0m22:35:55.426089 [debug] [Thread-1 (]: On seed.customer.customer_base: COMMIT
[0m22:35:55.428026 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m22:35:55.430803 [debug] [Thread-1 (]: On seed.customer.customer_base: COMMIT
[0m22:35:55.437500 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:35:55.439651 [debug] [Thread-1 (]: finished collecting timing info
[0m22:35:55.446130 [debug] [Thread-1 (]: On seed.customer.customer_base: Close
[0m22:35:55.447737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c7ced85-2bb4-44f9-a9ea-a58b8f6b1d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f6ee4d0>]}
[0m22:35:55.449252 [info ] [Thread-1 (]: 6 of 26 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 0.73s]
[0m22:35:55.450910 [debug] [Thread-1 (]: Finished running node seed.customer.customer_base
[0m22:35:55.457694 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m22:35:55.459237 [info ] [Thread-1 (]: 7 of 26 START test not_null_stg_category_category_id ........................... [RUN]
[0m22:35:55.462293 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m22:35:55.464087 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m22:35:55.471189 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m22:35:55.479857 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m22:35:55.485023 [debug] [Thread-1 (]: finished collecting timing info
[0m22:35:55.486544 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m22:35:55.495183 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m22:35:55.502177 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m22:35:55.503949 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: BEGIN
[0m22:35:55.505287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:00.576893 [debug] [Thread-1 (]: SQL status: BEGIN in 5.07 seconds
[0m22:36:00.587143 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m22:36:00.589494 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_category_category_id.d4eb91c268"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select category_id
from "postgres"."public"."stg_category"
where category_id is null



      
    ) dbt_internal_test
[0m22:36:00.618916 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:36:00.622537 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:00.628685 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: ROLLBACK
[0m22:36:00.631649 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: Close
[0m22:36:00.634220 [info ] [Thread-1 (]: 7 of 26 PASS not_null_stg_category_category_id ................................. [[32mPASS[0m in 5.17s]
[0m22:36:00.635917 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m22:36:00.638143 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m22:36:00.645477 [info ] [Thread-1 (]: 8 of 26 START test unique_stg_category_category_id ............................. [RUN]
[0m22:36:00.647657 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m22:36:00.649174 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m22:36:00.650455 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m22:36:00.655298 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m22:36:00.660292 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:00.661992 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m22:36:00.664612 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m22:36:00.670778 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m22:36:00.672600 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: BEGIN
[0m22:36:00.673914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:00.723872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m22:36:00.725893 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m22:36:00.727658 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    category_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_category"
where category_id is not null
group by category_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:36:00.758707 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:36:00.761576 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:00.763019 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: ROLLBACK
[0m22:36:00.765963 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: Close
[0m22:36:00.773757 [info ] [Thread-1 (]: 8 of 26 PASS unique_stg_category_category_id ................................... [[32mPASS[0m in 0.13s]
[0m22:36:00.775652 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m22:36:00.777598 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m22:36:00.779103 [info ] [Thread-1 (]: 9 of 26 START test not_null_stg_customer_customer_id ........................... [RUN]
[0m22:36:00.785807 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m22:36:00.787899 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m22:36:00.789232 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m22:36:00.793017 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m22:36:00.803616 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:00.805822 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m22:36:00.808588 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m22:36:00.813262 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m22:36:00.814406 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: BEGIN
[0m22:36:00.816156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:00.841141 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m22:36:00.844274 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m22:36:00.846065 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_customer"
where customer_id is null



      
    ) dbt_internal_test
[0m22:36:00.871534 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m22:36:00.874169 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:00.875736 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: ROLLBACK
[0m22:36:00.878619 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: Close
[0m22:36:00.903678 [info ] [Thread-1 (]: 9 of 26 PASS not_null_stg_customer_customer_id ................................. [[32mPASS[0m in 0.12s]
[0m22:36:00.906238 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m22:36:00.908301 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m22:36:00.910515 [info ] [Thread-1 (]: 10 of 26 START test unique_stg_customer_customer_id ............................ [RUN]
[0m22:36:00.912679 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m22:36:00.915085 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m22:36:00.917277 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m22:36:00.926541 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m22:36:00.931464 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:00.933017 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m22:36:00.936675 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m22:36:00.943807 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m22:36:00.945522 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: BEGIN
[0m22:36:00.952729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:00.977751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:36:00.980423 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m22:36:00.982247 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_customer_customer_id.310773d0ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:36:01.015470 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:36:01.018556 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:01.020920 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: ROLLBACK
[0m22:36:01.023598 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: Close
[0m22:36:01.025270 [info ] [Thread-1 (]: 10 of 26 PASS unique_stg_customer_customer_id .................................. [[32mPASS[0m in 0.11s]
[0m22:36:01.026622 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m22:36:01.030161 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m22:36:01.031807 [info ] [Thread-1 (]: 11 of 26 START test not_null_stg_film_film_id .................................. [RUN]
[0m22:36:01.033584 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m22:36:01.035106 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m22:36:01.059904 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m22:36:01.063995 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m22:36:01.069499 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:01.071834 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m22:36:01.075589 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m22:36:01.084404 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m22:36:01.086521 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: BEGIN
[0m22:36:01.092850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:01.117308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m22:36:01.119231 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m22:36:01.121059 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select film_id
from "postgres"."public"."stg_film"
where film_id is null



      
    ) dbt_internal_test
[0m22:36:01.149684 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:36:01.158264 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:01.160218 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: ROLLBACK
[0m22:36:01.162856 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: Close
[0m22:36:01.164565 [info ] [Thread-1 (]: 11 of 26 PASS not_null_stg_film_film_id ........................................ [[32mPASS[0m in 0.13s]
[0m22:36:01.166154 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m22:36:01.167472 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m22:36:01.169197 [info ] [Thread-1 (]: 12 of 26 START test unique_stg_film_film_id .................................... [RUN]
[0m22:36:01.170737 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m22:36:01.172515 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m22:36:01.174106 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m22:36:01.178105 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m22:36:01.184327 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:01.185880 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m22:36:01.188415 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m22:36:01.217522 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m22:36:01.219493 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: BEGIN
[0m22:36:01.220845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:01.246662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:36:01.249190 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m22:36:01.250593 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_film_film_id.1cbe88695a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    film_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_film"
where film_id is not null
group by film_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:36:01.290418 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:36:01.293056 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:01.295822 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: ROLLBACK
[0m22:36:01.299249 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: Close
[0m22:36:01.305974 [info ] [Thread-1 (]: 12 of 26 PASS unique_stg_film_film_id .......................................... [[32mPASS[0m in 0.14s]
[0m22:36:01.308395 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m22:36:01.310182 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m22:36:01.311784 [info ] [Thread-1 (]: 13 of 26 START test not_null_stg_payment_customer_id ........................... [RUN]
[0m22:36:01.313860 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m22:36:01.321362 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m22:36:01.323301 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m22:36:01.327202 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m22:36:01.332397 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:01.333823 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m22:36:01.336702 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m22:36:01.342300 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m22:36:01.344224 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: BEGIN
[0m22:36:01.345681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:01.370795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:36:01.373175 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m22:36:01.397338 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_payment"
where customer_id is null



      
    ) dbt_internal_test
[0m22:36:01.424813 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:36:01.427680 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:01.429206 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: ROLLBACK
[0m22:36:01.431993 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: Close
[0m22:36:01.433894 [info ] [Thread-1 (]: 13 of 26 PASS not_null_stg_payment_customer_id ................................. [[32mPASS[0m in 0.12s]
[0m22:36:01.435419 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m22:36:01.442674 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m22:36:01.444241 [info ] [Thread-1 (]: 14 of 26 START test not_null_stg_payment_payment_id ............................ [RUN]
[0m22:36:01.446404 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m22:36:01.447941 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m22:36:01.449278 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m22:36:01.453246 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m22:36:01.461161 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:01.462734 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m22:36:01.472368 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m22:36:01.477176 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m22:36:01.478853 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: BEGIN
[0m22:36:01.480724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:01.505208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m22:36:01.507451 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m22:36:01.508904 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payment"
where payment_id is null



      
    ) dbt_internal_test
[0m22:36:01.536826 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m22:36:01.539786 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:01.541822 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: ROLLBACK
[0m22:36:01.544336 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: Close
[0m22:36:01.546515 [info ] [Thread-1 (]: 14 of 26 PASS not_null_stg_payment_payment_id .................................. [[32mPASS[0m in 0.10s]
[0m22:36:01.573212 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m22:36:01.575741 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m22:36:01.577688 [info ] [Thread-1 (]: 15 of 26 START test unique_stg_payment_payment_id .............................. [RUN]
[0m22:36:01.579532 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m22:36:01.580900 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m22:36:01.582681 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m22:36:01.586648 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m22:36:01.596355 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:01.597771 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m22:36:01.600434 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m22:36:01.609653 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m22:36:01.611095 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: BEGIN
[0m22:36:01.612373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:01.642806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:36:01.645151 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m22:36:01.647085 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_payment_payment_id.7398e70184"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payment"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:36:01.724150 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.07 seconds
[0m22:36:01.727597 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:01.729365 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: ROLLBACK
[0m22:36:01.731780 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: Close
[0m22:36:01.733714 [info ] [Thread-1 (]: 15 of 26 PASS unique_stg_payment_payment_id .................................... [[32mPASS[0m in 0.15s]
[0m22:36:01.735728 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m22:36:01.739614 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m22:36:01.741858 [info ] [Thread-1 (]: 16 of 26 START test not_null_stg_rental_rental_id .............................. [RUN]
[0m22:36:01.744541 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m22:36:01.746358 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m22:36:01.748299 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m22:36:01.775681 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m22:36:01.781467 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:01.783887 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m22:36:01.786982 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m22:36:01.797885 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m22:36:01.799319 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: BEGIN
[0m22:36:01.800683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:01.831418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:36:01.833508 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m22:36:01.835311 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rental_id
from "postgres"."public"."stg_rental"
where rental_id is null



      
    ) dbt_internal_test
[0m22:36:01.861129 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m22:36:01.864140 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:01.871465 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: ROLLBACK
[0m22:36:01.873969 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: Close
[0m22:36:01.876264 [info ] [Thread-1 (]: 16 of 26 PASS not_null_stg_rental_rental_id .................................... [[32mPASS[0m in 0.13s]
[0m22:36:01.878512 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m22:36:01.880347 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m22:36:01.882172 [info ] [Thread-1 (]: 17 of 26 START test unique_stg_rental_rental_id ................................ [RUN]
[0m22:36:01.883839 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m22:36:01.886261 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m22:36:01.887912 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_rental_rental_id.b263207352
[0m22:36:01.891652 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m22:36:01.896922 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:01.898463 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m22:36:01.900878 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m22:36:01.929577 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m22:36:01.931515 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: BEGIN
[0m22:36:01.933339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:01.959904 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:36:01.962368 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m22:36:01.969652 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_rental_rental_id.b263207352"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    rental_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_rental"
where rental_id is not null
group by rental_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:36:02.037441 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.07 seconds
[0m22:36:02.040179 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:02.046104 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: ROLLBACK
[0m22:36:02.048658 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: Close
[0m22:36:02.050637 [info ] [Thread-1 (]: 17 of 26 PASS unique_stg_rental_rental_id ...................................... [[32mPASS[0m in 0.17s]
[0m22:36:02.053553 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m22:36:02.055499 [debug] [Thread-1 (]: Began running node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m22:36:02.065018 [info ] [Thread-1 (]: 18 of 26 START test not_null_customer_base_customer_id ......................... [RUN]
[0m22:36:02.067738 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m22:36:02.069842 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m22:36:02.071561 [debug] [Thread-1 (]: Compiling test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m22:36:02.076792 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m22:36:02.083678 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:02.085369 [debug] [Thread-1 (]: Began executing node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m22:36:02.088165 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m22:36:02.123098 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m22:36:02.124625 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m22:36:02.131227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:02.157282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:36:02.159515 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m22:36:02.162148 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m22:36:02.185738 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m22:36:02.193180 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:02.195078 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m22:36:02.197921 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: Close
[0m22:36:02.200242 [info ] [Thread-1 (]: 18 of 26 PASS not_null_customer_base_customer_id ............................... [[32mPASS[0m in 0.13s]
[0m22:36:02.202011 [debug] [Thread-1 (]: Finished running node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m22:36:02.209621 [debug] [Thread-1 (]: Began running node test.customer.not_null_customer_base_store_id.e159464168
[0m22:36:02.211529 [info ] [Thread-1 (]: 19 of 26 START test not_null_customer_base_store_id ............................ [RUN]
[0m22:36:02.213579 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_customer_base_store_id.e159464168"
[0m22:36:02.215328 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_customer_base_store_id.e159464168
[0m22:36:02.218349 [debug] [Thread-1 (]: Compiling test.customer.not_null_customer_base_store_id.e159464168
[0m22:36:02.224199 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_customer_base_store_id.e159464168"
[0m22:36:02.233296 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:02.236921 [debug] [Thread-1 (]: Began executing node test.customer.not_null_customer_base_store_id.e159464168
[0m22:36:02.240563 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_customer_base_store_id.e159464168"
[0m22:36:02.245735 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_store_id.e159464168"
[0m22:36:02.281388 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: BEGIN
[0m22:36:02.284984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:02.315928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:36:02.318363 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_store_id.e159464168"
[0m22:36:02.319752 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m22:36:02.343566 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m22:36:02.346392 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:02.353166 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m22:36:02.355656 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: Close
[0m22:36:02.357575 [info ] [Thread-1 (]: 19 of 26 PASS not_null_customer_base_store_id .................................. [[32mPASS[0m in 0.14s]
[0m22:36:02.358995 [debug] [Thread-1 (]: Finished running node test.customer.not_null_customer_base_store_id.e159464168
[0m22:36:02.365677 [debug] [Thread-1 (]: Began running node model.shared_models.int_revenue_by_date
[0m22:36:02.368376 [info ] [Thread-1 (]: 20 of 26 START sql view model public.int_revenue_by_date ....................... [RUN]
[0m22:36:02.370502 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.int_revenue_by_date"
[0m22:36:02.372202 [debug] [Thread-1 (]: Began compiling node model.shared_models.int_revenue_by_date
[0m22:36:02.373948 [debug] [Thread-1 (]: Compiling model.shared_models.int_revenue_by_date
[0m22:36:02.383394 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.int_revenue_by_date"
[0m22:36:02.388824 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:02.390446 [debug] [Thread-1 (]: Began executing node model.shared_models.int_revenue_by_date
[0m22:36:02.394660 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.int_revenue_by_date"
[0m22:36:02.400658 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m22:36:02.402928 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: BEGIN
[0m22:36:02.405122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:02.430509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:36:02.433525 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m22:36:02.457712 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    "postgres"."public"."stg_payment"
GROUP BY
    1
  );
[0m22:36:02.486513 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m22:36:02.490353 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m22:36:02.492368 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date__dbt_tmp" rename to "int_revenue_by_date"
[0m22:36:02.496665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:36:02.499220 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: COMMIT
[0m22:36:02.500771 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m22:36:02.507646 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: COMMIT
[0m22:36:02.512395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:36:02.515098 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m22:36:02.516778 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.int_revenue_by_date"} */
drop view if exists "postgres"."public"."int_revenue_by_date__dbt_backup" cascade
[0m22:36:02.519191 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:36:02.526559 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:02.528182 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: Close
[0m22:36:02.529988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c7ced85-2bb4-44f9-a9ea-a58b8f6b1d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cba4fd0>]}
[0m22:36:02.531532 [info ] [Thread-1 (]: 20 of 26 OK created sql view model public.int_revenue_by_date .................. [[32mCREATE VIEW[0m in 0.16s]
[0m22:36:02.533381 [debug] [Thread-1 (]: Finished running node model.shared_models.int_revenue_by_date
[0m22:36:02.535121 [debug] [Thread-1 (]: Began running node model.customer.int_customers_per_store
[0m22:36:02.542702 [info ] [Thread-1 (]: 21 of 26 START sql view model public.int_customers_per_store ................... [RUN]
[0m22:36:02.545222 [debug] [Thread-1 (]: Acquiring new postgres connection "model.customer.int_customers_per_store"
[0m22:36:02.546930 [debug] [Thread-1 (]: Began compiling node model.customer.int_customers_per_store
[0m22:36:02.548655 [debug] [Thread-1 (]: Compiling model.customer.int_customers_per_store
[0m22:36:02.553324 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer.int_customers_per_store"
[0m22:36:02.559678 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:02.562637 [debug] [Thread-1 (]: Began executing node model.customer.int_customers_per_store
[0m22:36:02.566815 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer.int_customers_per_store"
[0m22:36:02.571648 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m22:36:02.598534 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: BEGIN
[0m22:36:02.600515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:02.625710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:36:02.627999 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m22:36:02.629762 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */

  create view "postgres"."public"."int_customers_per_store__dbt_tmp" as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    "postgres"."public"."customer_base"
GROUP BY
    1
  );
[0m22:36:02.657252 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m22:36:02.661253 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m22:36:02.668777 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store" rename to "int_customers_per_store__dbt_backup"
[0m22:36:02.672407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:36:02.675838 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m22:36:02.677369 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store__dbt_tmp" rename to "int_customers_per_store"
[0m22:36:02.681690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:36:02.686485 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: COMMIT
[0m22:36:02.688308 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m22:36:02.689955 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: COMMIT
[0m22:36:02.694677 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:36:02.702935 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m22:36:02.704447 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */
drop view if exists "postgres"."public"."int_customers_per_store__dbt_backup" cascade
[0m22:36:02.711202 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m22:36:02.713958 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:02.716303 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: Close
[0m22:36:02.717832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c7ced85-2bb4-44f9-a9ea-a58b8f6b1d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb7ba90>]}
[0m22:36:02.719906 [info ] [Thread-1 (]: 21 of 26 OK created sql view model public.int_customers_per_store .............. [[32mCREATE VIEW[0m in 0.17s]
[0m22:36:02.722167 [debug] [Thread-1 (]: Finished running node model.customer.int_customers_per_store
[0m22:36:02.723515 [debug] [Thread-1 (]: Began running node model.customer.cumulative_revenue
[0m22:36:02.725348 [info ] [Thread-1 (]: 22 of 26 START sql table model public.cumulative_revenue ....................... [RUN]
[0m22:36:02.728920 [debug] [Thread-1 (]: Acquiring new postgres connection "model.customer.cumulative_revenue"
[0m22:36:02.730849 [debug] [Thread-1 (]: Began compiling node model.customer.cumulative_revenue
[0m22:36:02.732259 [debug] [Thread-1 (]: Compiling model.customer.cumulative_revenue
[0m22:36:02.735606 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer.cumulative_revenue"
[0m22:36:02.766817 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:02.768728 [debug] [Thread-1 (]: Began executing node model.customer.cumulative_revenue
[0m22:36:02.782206 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer.cumulative_revenue"
[0m22:36:02.794234 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m22:36:02.795630 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: BEGIN
[0m22:36:02.796801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:02.829391 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:36:02.842136 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m22:36:02.845564 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */

  
    

  create  table "postgres"."public"."cumulative_revenue__dbt_tmp"
  as (
    

SELECT
    payment_date,
    amount,
    SUM(amount) OVER (ORDER BY payment_date)
FROM
    "postgres"."public"."int_revenue_by_date"
ORDER BY
    payment_date
  );
  
[0m22:36:02.948325 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.1 seconds
[0m22:36:02.955726 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m22:36:02.964491 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue" rename to "cumulative_revenue__dbt_backup"
[0m22:36:02.970524 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:36:02.974883 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m22:36:02.978638 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue__dbt_tmp" rename to "cumulative_revenue"
[0m22:36:02.982299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:36:02.987514 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: COMMIT
[0m22:36:02.990683 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m22:36:02.994094 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: COMMIT
[0m22:36:02.999347 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:36:03.005275 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m22:36:03.007916 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
drop table if exists "postgres"."public"."cumulative_revenue__dbt_backup" cascade
[0m22:36:03.018526 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m22:36:03.021371 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:03.048063 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: Close
[0m22:36:03.051120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c7ced85-2bb4-44f9-a9ea-a58b8f6b1d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cba5e10>]}
[0m22:36:03.053356 [info ] [Thread-1 (]: 22 of 26 OK created sql table model public.cumulative_revenue .................. [[32mSELECT 40[0m in 0.32s]
[0m22:36:03.057426 [debug] [Thread-1 (]: Finished running node model.customer.cumulative_revenue
[0m22:36:03.060187 [debug] [Thread-1 (]: Began running node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m22:36:03.062012 [info ] [Thread-1 (]: 23 of 26 START test not_null_int_customers_per_store_store_id .................. [RUN]
[0m22:36:03.064261 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m22:36:03.072162 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m22:36:03.074295 [debug] [Thread-1 (]: Compiling test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m22:36:03.078476 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m22:36:03.091545 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:03.093380 [debug] [Thread-1 (]: Began executing node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m22:36:03.096199 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m22:36:03.108743 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m22:36:03.110800 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m22:36:03.112471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:03.138993 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:36:03.142268 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m22:36:03.143726 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."int_customers_per_store"
where store_id is null



      
    ) dbt_internal_test
[0m22:36:03.171608 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:36:03.176349 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:03.186282 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m22:36:03.189786 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m22:36:03.191847 [info ] [Thread-1 (]: 23 of 26 PASS not_null_int_customers_per_store_store_id ........................ [[32mPASS[0m in 0.13s]
[0m22:36:03.193978 [debug] [Thread-1 (]: Finished running node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m22:36:03.220273 [debug] [Thread-1 (]: Began running node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m22:36:03.221458 [info ] [Thread-1 (]: 24 of 26 START test not_null_int_customers_per_store_total_customers ........... [RUN]
[0m22:36:03.223752 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m22:36:03.225352 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m22:36:03.227884 [debug] [Thread-1 (]: Compiling test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m22:36:03.232342 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m22:36:05.259016 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:05.267304 [debug] [Thread-1 (]: Began executing node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m22:36:05.292106 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m22:36:05.303573 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m22:36:05.305973 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m22:36:05.317929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:05.351866 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:36:05.358192 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m22:36:05.359954 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_customers
from "postgres"."public"."int_customers_per_store"
where total_customers is null



      
    ) dbt_internal_test
[0m22:36:05.387467 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:36:05.390597 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:05.394415 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m22:36:05.399229 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m22:36:05.402785 [info ] [Thread-1 (]: 24 of 26 PASS not_null_int_customers_per_store_total_customers ................. [[32mPASS[0m in 2.18s]
[0m22:36:05.407280 [debug] [Thread-1 (]: Finished running node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m22:36:05.409544 [debug] [Thread-1 (]: Began running node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m22:36:05.411301 [info ] [Thread-1 (]: 25 of 26 START test unique_int_customers_per_store_store_id .................... [RUN]
[0m22:36:05.413732 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m22:36:05.415699 [debug] [Thread-1 (]: Began compiling node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m22:36:05.442204 [debug] [Thread-1 (]: Compiling test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m22:36:05.448175 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m22:36:05.455527 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:05.457105 [debug] [Thread-1 (]: Began executing node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m22:36:05.466293 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m22:36:05.471421 [debug] [Thread-1 (]: Using postgres connection "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m22:36:05.473127 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m22:36:05.479414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:05.506160 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m22:36:05.508190 [debug] [Thread-1 (]: Using postgres connection "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m22:36:05.510313 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "postgres"."public"."int_customers_per_store"
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:36:05.540689 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m22:36:05.543796 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:05.546110 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m22:36:05.549336 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m22:36:05.551251 [info ] [Thread-1 (]: 25 of 26 PASS unique_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.14s]
[0m22:36:05.552838 [debug] [Thread-1 (]: Finished running node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m22:36:05.555216 [debug] [Thread-1 (]: Began running node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m22:36:05.556962 [info ] [Thread-1 (]: 26 of 26 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot  [RUN]
[0m22:36:05.559148 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:36:05.560615 [debug] [Thread-1 (]: Began compiling node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m22:36:05.563644 [debug] [Thread-1 (]: Compiling snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m22:36:05.567751 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:05.569670 [debug] [Thread-1 (]: Began executing node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m22:36:05.596238 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:36:05.598612 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */
select * from (
            select total_customers from (

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"
) subq
        ) as __dbt_sbq
        where false
        limit 0
    
[0m22:36:05.623324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:36:05.665562 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.04 seconds
[0m22:36:05.672136 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:36:05.675316 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m22:36:05.679251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:36:05.681528 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:36:05.683905 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:36:05.760854 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.07 seconds
[0m22:36:05.767819 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:36:05.769590 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:36:05.786253 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m22:36:05.802704 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:36:05.804515 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

        
  
    

  create temporary table "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp223605799197"
  as (
    with snapshot_query as (

        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"


    ),

    snapshotted_data as (

        select *,
            store_id as dbt_unique_key

        from "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(store_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            store_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m22:36:05.843632 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.04 seconds
[0m22:36:05.848490 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:36:05.854696 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp223605799197'
        
      order by ordinal_position

  
[0m22:36:05.871911 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m22:36:05.876935 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:36:05.879159 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:36:05.896627 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.02 seconds
[0m22:36:05.901705 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:36:05.904159 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp223605799197'
        
      order by ordinal_position

  
[0m22:36:05.923143 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m22:36:05.928648 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:36:05.933559 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m22:36:05.951814 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.02 seconds
[0m22:36:05.958756 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:36:05.960753 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp223605799197'
        
      order by ordinal_position

  
[0m22:36:06.008179 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m22:36:06.017257 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:36:06.032571 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:36:06.036226 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      update "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp223605799197" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_valid_to is null;

    insert into "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot" ("store_id", "total_customers", "current_date", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."store_id",DBT_INTERNAL_SOURCE."total_customers",DBT_INTERNAL_SOURCE."current_date",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp223605799197" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m22:36:06.051640 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.01 seconds
[0m22:36:06.057646 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m22:36:06.062376 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:36:06.067635 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m22:36:06.072711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:36:06.081674 [debug] [Thread-1 (]: finished collecting timing info
[0m22:36:06.083498 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m22:36:06.085439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c7ced85-2bb4-44f9-a9ea-a58b8f6b1d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cbc1a50>]}
[0m22:36:06.087054 [info ] [Thread-1 (]: 26 of 26 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot  [[32mINSERT 0 0[0m in 0.53s]
[0m22:36:06.089247 [debug] [Thread-1 (]: Finished running node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m22:36:06.099387 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m22:36:06.101265 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:06.102849 [debug] [MainThread]: On master: BEGIN
[0m22:36:06.104349 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:36:06.131880 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m22:36:06.137717 [debug] [MainThread]: On master: COMMIT
[0m22:36:06.139803 [debug] [MainThread]: Using postgres connection "master"
[0m22:36:06.142316 [debug] [MainThread]: On master: COMMIT
[0m22:36:06.144852 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:36:06.146588 [debug] [MainThread]: On master: Close
[0m22:36:06.150119 [info ] [MainThread]: 
[0m22:36:06.151711 [info ] [MainThread]: Finished running 7 view models, 1 seed, 16 tests, 1 table model, 1 snapshot in 0 hours 0 minutes and 27.93 seconds (27.93s).
[0m22:36:06.153373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:36:06.155072 [debug] [MainThread]: Connection 'snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m22:36:06.223622 [info ] [MainThread]: 
[0m22:36:06.225195 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:36:06.228518 [info ] [MainThread]: 
[0m22:36:06.230730 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=0 SKIP=0 TOTAL=26
[0m22:36:06.232907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce33dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8672e320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8672e8f0>]}
[0m22:36:06.234377 [debug] [MainThread]: Flushing usage events


============================== 2023-02-20 22:41:39.599321 | 4ca31972-3400-4c4c-bd10-6b81ff83c461 ==============================
[0m22:41:39.599333 [info ] [MainThread]: Running with dbt=1.3.1
[0m22:41:39.601449 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m22:41:39.603625 [debug] [MainThread]: Tracking: tracking
[0m22:41:39.606901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d96eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d96e860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d96ea70>]}
[0m22:41:39.970469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:41:39.971958 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:41:39.979604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ca31972-3400-4c4c-bd10-6b81ff83c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd19540>]}
[0m22:41:40.046451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ca31972-3400-4c4c-bd10-6b81ff83c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ccdc220>]}
[0m22:41:40.048254 [info ] [MainThread]: Found 8 models, 16 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 5 sources, 0 exposures, 0 metrics
[0m22:41:40.049465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ca31972-3400-4c4c-bd10-6b81ff83c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ccdc070>]}
[0m22:41:40.052336 [info ] [MainThread]: 
[0m22:41:40.054066 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m22:41:40.055956 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m22:41:40.063381 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:41:40.065124 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:41:40.068205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:47.168166 [debug] [ThreadPool]: SQL status: BEGIN in 7.1 seconds
[0m22:41:47.170912 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:41:47.174186 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:41:47.231213 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.05 seconds
[0m22:41:47.234654 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:41:47.237596 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:41:47.242343 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:47.244824 [debug] [MainThread]: On master: BEGIN
[0m22:41:47.251467 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:41:52.328248 [debug] [MainThread]: SQL status: BEGIN in 5.08 seconds
[0m22:41:52.331214 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:52.334003 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:41:52.415846 [debug] [MainThread]: SQL status: SELECT 50 in 0.08 seconds
[0m22:41:52.419517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ca31972-3400-4c4c-bd10-6b81ff83c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd1a5f0>]}
[0m22:41:52.423411 [debug] [MainThread]: On master: ROLLBACK
[0m22:41:52.426469 [debug] [MainThread]: On master: Close
[0m22:41:52.428961 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:41:52.430523 [info ] [MainThread]: 
[0m22:41:52.435342 [debug] [Thread-1 (]: Began running node model.shared_models.stg_category
[0m22:41:52.458404 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_category"
[0m22:41:52.460174 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_category
[0m22:41:52.462443 [debug] [Thread-1 (]: Compiling model.shared_models.stg_category
[0m22:41:52.466035 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_category"
[0m22:41:52.472462 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.479319 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_category
[0m22:41:52.480900 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.482790 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_category
[0m22:41:52.484085 [debug] [Thread-1 (]: Began running node model.shared_models.stg_customer
[0m22:41:52.485560 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_customer"
[0m22:41:52.491533 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_customer
[0m22:41:52.493075 [debug] [Thread-1 (]: Compiling model.shared_models.stg_customer
[0m22:41:52.496309 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_customer"
[0m22:41:52.506929 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.508580 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_customer
[0m22:41:52.510006 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.511741 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_customer
[0m22:41:52.513018 [debug] [Thread-1 (]: Began running node model.shared_models.stg_film
[0m22:41:52.514571 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_film"
[0m22:41:52.515734 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_film
[0m22:41:52.517137 [debug] [Thread-1 (]: Compiling model.shared_models.stg_film
[0m22:41:52.520186 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_film"
[0m22:41:52.525914 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.527353 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_film
[0m22:41:52.528658 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.554126 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_film
[0m22:41:52.555658 [debug] [Thread-1 (]: Began running node model.shared_models.stg_payment
[0m22:41:52.557690 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_payment"
[0m22:41:52.559529 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_payment
[0m22:41:52.561503 [debug] [Thread-1 (]: Compiling model.shared_models.stg_payment
[0m22:41:52.564608 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_payment"
[0m22:41:52.574490 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.576239 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_payment
[0m22:41:52.577691 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.579204 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_payment
[0m22:41:52.585792 [debug] [Thread-1 (]: Began running node model.shared_models.stg_rental
[0m22:41:52.587333 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_rental"
[0m22:41:52.589364 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_rental
[0m22:41:52.590817 [debug] [Thread-1 (]: Compiling model.shared_models.stg_rental
[0m22:41:52.594466 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_rental"
[0m22:41:52.604423 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.605934 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_rental
[0m22:41:52.607128 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.608794 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_rental
[0m22:41:52.610061 [debug] [Thread-1 (]: Began running node seed.customer.customer_base
[0m22:41:52.611553 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.customer.customer_base"
[0m22:41:52.612563 [debug] [Thread-1 (]: Began compiling node seed.customer.customer_base
[0m22:41:52.613886 [debug] [Thread-1 (]: Compiling seed.customer.customer_base
[0m22:41:52.618321 [debug] [Thread-1 (]: Writing injected SQL for node "seed.customer.customer_base"
[0m22:41:52.620057 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.621842 [debug] [Thread-1 (]: Began executing node seed.customer.customer_base
[0m22:41:52.623165 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.624763 [debug] [Thread-1 (]: Finished running node seed.customer.customer_base
[0m22:41:52.648767 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m22:41:52.651046 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m22:41:52.652744 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m22:41:52.654742 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m22:41:52.663468 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m22:41:52.669003 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.675828 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m22:41:52.677693 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.679481 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m22:41:52.680674 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m22:41:52.682086 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m22:41:52.688169 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m22:41:52.689783 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m22:41:52.695952 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m22:41:52.706443 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.708533 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m22:41:52.710114 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.711703 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m22:41:52.713099 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m22:41:52.714666 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m22:41:52.715903 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m22:41:52.719963 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m22:41:52.723874 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m22:41:52.730148 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.731556 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m22:41:52.732821 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.757122 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m22:41:52.759111 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m22:41:52.761600 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m22:41:52.763190 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m22:41:52.765304 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m22:41:52.769099 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m22:41:52.778724 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.781105 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m22:41:52.782653 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.784518 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m22:41:52.785956 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m22:41:52.792504 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m22:41:52.794671 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m22:41:52.796480 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m22:41:52.800597 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m22:41:52.810584 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.812228 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m22:41:52.813618 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.815166 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m22:41:52.816573 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m22:41:52.817822 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m22:41:52.819074 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m22:41:52.820333 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m22:41:52.825164 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m22:41:52.831841 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.833503 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m22:41:52.835199 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.859116 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m22:41:52.861289 [debug] [Thread-1 (]: Began running node model.shared_models.int_revenue_by_date
[0m22:41:52.863420 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.int_revenue_by_date"
[0m22:41:52.865284 [debug] [Thread-1 (]: Began compiling node model.shared_models.int_revenue_by_date
[0m22:41:52.867376 [debug] [Thread-1 (]: Compiling model.shared_models.int_revenue_by_date
[0m22:41:52.871747 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.int_revenue_by_date"
[0m22:41:52.881622 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.882983 [debug] [Thread-1 (]: Began executing node model.shared_models.int_revenue_by_date
[0m22:41:52.884103 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.885833 [debug] [Thread-1 (]: Finished running node model.shared_models.int_revenue_by_date
[0m22:41:52.891821 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m22:41:52.894457 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m22:41:52.896363 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m22:41:52.897672 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m22:41:52.901552 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m22:41:52.911506 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.912950 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m22:41:52.914392 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.915891 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m22:41:52.917107 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m22:41:52.918593 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m22:41:52.920067 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m22:41:52.921441 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m22:41:52.925282 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m22:41:52.931423 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.932990 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m22:41:52.934343 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.958808 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m22:41:52.960813 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m22:41:52.963262 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m22:41:52.965306 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m22:41:52.967659 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m22:41:52.972505 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m22:41:52.981995 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.983567 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m22:41:52.985088 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:52.986691 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m22:41:52.993206 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m22:41:52.995414 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m22:41:52.996755 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m22:41:52.998225 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m22:41:53.002686 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m22:41:53.012451 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.013935 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m22:41:53.015409 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.017089 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m22:41:53.018592 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m22:41:53.020456 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m22:41:53.021656 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m22:41:53.022911 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_rental_rental_id.b263207352
[0m22:41:53.029119 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m22:41:53.033898 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.035451 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m22:41:53.060304 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.062617 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m22:41:53.064396 [debug] [Thread-1 (]: Began running node model.customer.int_customers_per_store
[0m22:41:53.066620 [debug] [Thread-1 (]: Acquiring new postgres connection "model.customer.int_customers_per_store"
[0m22:41:53.068038 [debug] [Thread-1 (]: Began compiling node model.customer.int_customers_per_store
[0m22:41:53.069527 [debug] [Thread-1 (]: Compiling model.customer.int_customers_per_store
[0m22:41:53.073682 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer.int_customers_per_store"
[0m22:41:53.083966 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.086080 [debug] [Thread-1 (]: Began executing node model.customer.int_customers_per_store
[0m22:41:53.087498 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.089053 [debug] [Thread-1 (]: Finished running node model.customer.int_customers_per_store
[0m22:41:53.094973 [debug] [Thread-1 (]: Began running node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m22:41:53.097151 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m22:41:53.098843 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m22:41:53.100341 [debug] [Thread-1 (]: Compiling test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m22:41:53.104399 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m22:41:53.112575 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.114019 [debug] [Thread-1 (]: Began executing node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m22:41:53.115263 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.117003 [debug] [Thread-1 (]: Finished running node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m22:41:53.119076 [debug] [Thread-1 (]: Began running node test.customer.not_null_customer_base_store_id.e159464168
[0m22:41:53.120659 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_customer_base_store_id.e159464168"
[0m22:41:53.121990 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_customer_base_store_id.e159464168
[0m22:41:53.123490 [debug] [Thread-1 (]: Compiling test.customer.not_null_customer_base_store_id.e159464168
[0m22:41:53.129452 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_customer_base_store_id.e159464168"
[0m22:41:53.134070 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.160835 [debug] [Thread-1 (]: Began executing node test.customer.not_null_customer_base_store_id.e159464168
[0m22:41:53.163454 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.166420 [debug] [Thread-1 (]: Finished running node test.customer.not_null_customer_base_store_id.e159464168
[0m22:41:53.168384 [debug] [Thread-1 (]: Began running node model.customer.cumulative_revenue
[0m22:41:53.170367 [debug] [Thread-1 (]: Acquiring new postgres connection "model.customer.cumulative_revenue"
[0m22:41:53.171948 [debug] [Thread-1 (]: Began compiling node model.customer.cumulative_revenue
[0m22:41:53.174362 [debug] [Thread-1 (]: Compiling model.customer.cumulative_revenue
[0m22:41:53.184370 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer.cumulative_revenue"
[0m22:41:53.191347 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.193474 [debug] [Thread-1 (]: Began executing node model.customer.cumulative_revenue
[0m22:41:53.200969 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.203623 [debug] [Thread-1 (]: Finished running node model.customer.cumulative_revenue
[0m22:41:53.206030 [debug] [Thread-1 (]: Began running node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m22:41:53.208267 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m22:41:53.209952 [debug] [Thread-1 (]: Began compiling node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m22:41:53.217663 [debug] [Thread-1 (]: Compiling snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m22:41:53.221010 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.222655 [debug] [Thread-1 (]: Began executing node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m22:41:53.224099 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.226086 [debug] [Thread-1 (]: Finished running node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m22:41:53.227279 [debug] [Thread-1 (]: Began running node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m22:41:53.229061 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m22:41:53.230598 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m22:41:53.231826 [debug] [Thread-1 (]: Compiling test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m22:41:53.235246 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m22:41:53.241228 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.242947 [debug] [Thread-1 (]: Began executing node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m22:41:53.244253 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.269275 [debug] [Thread-1 (]: Finished running node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m22:41:53.271488 [debug] [Thread-1 (]: Began running node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m22:41:53.273689 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m22:41:53.275259 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m22:41:53.277016 [debug] [Thread-1 (]: Compiling test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m22:41:53.281725 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m22:41:53.292581 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.294369 [debug] [Thread-1 (]: Began executing node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m22:41:53.296250 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.302819 [debug] [Thread-1 (]: Finished running node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m22:41:53.304434 [debug] [Thread-1 (]: Began running node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m22:41:53.305765 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m22:41:53.306995 [debug] [Thread-1 (]: Began compiling node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m22:41:53.308537 [debug] [Thread-1 (]: Compiling test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m22:41:53.317497 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m22:41:53.322750 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.324284 [debug] [Thread-1 (]: Began executing node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m22:41:53.325476 [debug] [Thread-1 (]: finished collecting timing info
[0m22:41:53.327150 [debug] [Thread-1 (]: Finished running node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m22:41:53.329155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:53.330424 [debug] [MainThread]: Connection 'test.customer.unique_int_customers_per_store_store_id.b975e6cb6d' was properly closed.
[0m22:41:53.396965 [info ] [MainThread]: Done.
[0m22:41:53.542178 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
[0m22:41:53.547424 [info ] [MainThread]: Building catalog
[0m22:41:53.550405 [debug] [ThreadPool]: Acquiring new postgres connection "postgres.information_schema"
[0m22:41:53.555522 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m22:41:53.557220 [debug] [ThreadPool]: On postgres.information_schema: BEGIN
[0m22:41:53.558445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:58.633984 [debug] [ThreadPool]: SQL status: BEGIN in 5.08 seconds
[0m22:41:58.666146 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m22:41:58.668080 [debug] [ThreadPool]: On postgres.information_schema: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "postgres.information_schema"} */

    
    

    select
        'postgres' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m22:41:58.737206 [debug] [ThreadPool]: SQL status: SELECT 229 in 0.07 seconds
[0m22:41:58.756930 [debug] [ThreadPool]: On postgres.information_schema: ROLLBACK
[0m22:41:58.759462 [debug] [ThreadPool]: On postgres.information_schema: Close
[0m22:41:58.810805 [info ] [MainThread]: Catalog written to /usr/src/dbt/dbt_project/customer/target/catalog.json
[0m22:41:58.835505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d96eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb1fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c15f160>]}
[0m22:41:58.837323 [debug] [MainThread]: Flushing usage events
[0m22:41:59.790671 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:41:59.815719 [debug] [MainThread]: Connection 'postgres.information_schema' was properly closed.


============================== 2023-02-20 22:42:44.537780 | 38027eff-edfb-4688-8663-ef2d15ac58f3 ==============================
[0m22:42:44.537794 [info ] [MainThread]: Running with dbt=1.3.1
[0m22:42:44.539931 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m22:42:44.542302 [debug] [MainThread]: Tracking: tracking
[0m22:42:44.546013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea3ea70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea3e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea3e830>]}
[0m22:42:44.689315 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m22:42:44.691677 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m22:42:44.693852 [info ] [MainThread]: 
[0m22:42:44.696290 [info ] [MainThread]: 
[0m22:42:44.698123 [info ] [MainThread]: Press Ctrl+C to exit.
[0m11:08:35.358322 [debug] [MainThread]: Flushing usage events
[0m11:08:35.564640 [info ] [MainThread]: ctrl-c


============================== 2023-02-21 11:11:56.628971 | 7a6c950c-92f0-469e-946f-470a60a90e9c ==============================
[0m11:11:56.628983 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:11:56.631738 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:11:56.634220 [debug] [MainThread]: Tracking: tracking
[0m11:11:56.639586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8667a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8666b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e866710>]}
[0m11:11:57.164459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:57.189180 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:57.195848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a6c950c-92f0-469e-946f-470a60a90e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc114b0>]}
[0m11:11:57.249947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a6c950c-92f0-469e-946f-470a60a90e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dbd4160>]}
[0m11:11:57.251602 [info ] [MainThread]: Found 8 models, 16 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 5 sources, 0 exposures, 0 metrics
[0m11:11:57.252986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a6c950c-92f0-469e-946f-470a60a90e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db57af0>]}
[0m11:11:57.255875 [info ] [MainThread]: 
[0m11:11:57.258413 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:11:57.260640 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:11:57.269126 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:11:57.270952 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:11:57.294516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:02.396387 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.1 seconds
[0m11:12:02.401909 [debug] [ThreadPool]: On list_postgres: Close
[0m11:12:02.406399 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m11:12:02.418096 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:12:02.420635 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m11:12:02.422717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:02.453198 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m11:12:02.455934 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:12:02.464530 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:12:02.510132 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.04 seconds
[0m11:12:02.513118 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:12:02.516328 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:12:02.521284 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:02.523712 [debug] [MainThread]: On master: BEGIN
[0m11:12:02.525225 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:12:07.596465 [debug] [MainThread]: SQL status: BEGIN in 5.07 seconds
[0m11:12:07.599507 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:07.603352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:12:07.690343 [debug] [MainThread]: SQL status: SELECT 49 in 0.08 seconds
[0m11:12:07.695211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a6c950c-92f0-469e-946f-470a60a90e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dbbbf10>]}
[0m11:12:07.697268 [debug] [MainThread]: On master: ROLLBACK
[0m11:12:07.700147 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:07.702087 [debug] [MainThread]: On master: BEGIN
[0m11:12:07.704555 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:12:07.706878 [debug] [MainThread]: On master: COMMIT
[0m11:12:07.709104 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:07.715674 [debug] [MainThread]: On master: COMMIT
[0m11:12:07.717716 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:12:07.719247 [debug] [MainThread]: On master: Close
[0m11:12:07.721263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:12:07.722651 [info ] [MainThread]: 
[0m11:12:07.732353 [debug] [Thread-1 (]: Began running node model.shared_models.stg_category
[0m11:12:07.734193 [info ] [Thread-1 (]: 1 of 26 START sql view model public.stg_category ............................... [RUN]
[0m11:12:07.736063 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_category"
[0m11:12:07.737671 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_category
[0m11:12:07.745221 [debug] [Thread-1 (]: Compiling model.shared_models.stg_category
[0m11:12:07.748653 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_category"
[0m11:12:07.757758 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:07.759581 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_category
[0m11:12:07.779039 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_category"
[0m11:12:07.790765 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m11:12:07.793992 [debug] [Thread-1 (]: On model.shared_models.stg_category: BEGIN
[0m11:12:07.795627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:12.869160 [debug] [Thread-1 (]: SQL status: BEGIN in 5.07 seconds
[0m11:12:12.873323 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m11:12:12.876064 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */

  create view "postgres"."public"."stg_category__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."category"
  );
[0m11:12:12.919355 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m11:12:12.926014 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m11:12:12.927677 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */
alter table "postgres"."public"."stg_category" rename to "stg_category__dbt_backup"
[0m11:12:12.932238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:12.939942 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m11:12:12.941956 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */
alter table "postgres"."public"."stg_category__dbt_tmp" rename to "stg_category"
[0m11:12:12.946056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:12.956686 [debug] [Thread-1 (]: On model.shared_models.stg_category: COMMIT
[0m11:12:12.958253 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m11:12:12.966507 [debug] [Thread-1 (]: On model.shared_models.stg_category: COMMIT
[0m11:12:12.972053 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:12.977001 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m11:12:12.978684 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */
drop view if exists "postgres"."public"."stg_category__dbt_backup" cascade
[0m11:12:12.986565 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m11:12:12.988822 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:12.990209 [debug] [Thread-1 (]: On model.shared_models.stg_category: Close
[0m11:12:12.991915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6c950c-92f0-469e-946f-470a60a90e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dab9000>]}
[0m11:12:12.993233 [info ] [Thread-1 (]: 1 of 26 OK created sql view model public.stg_category .......................... [[32mCREATE VIEW[0m in 5.26s]
[0m11:12:12.997335 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_category
[0m11:12:12.998655 [debug] [Thread-1 (]: Began running node model.shared_models.stg_customer
[0m11:12:13.000313 [info ] [Thread-1 (]: 2 of 26 START sql view model public.stg_customer ............................... [RUN]
[0m11:12:13.002576 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_customer"
[0m11:12:13.005757 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_customer
[0m11:12:13.007438 [debug] [Thread-1 (]: Compiling model.shared_models.stg_customer
[0m11:12:13.010509 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_customer"
[0m11:12:13.039033 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:13.041615 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_customer
[0m11:12:13.046218 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_customer"
[0m11:12:13.052562 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m11:12:13.054682 [debug] [Thread-1 (]: On model.shared_models.stg_customer: BEGIN
[0m11:12:13.061150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:13.088857 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:13.091986 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m11:12:13.093437 [debug] [Thread-1 (]: On model.shared_models.stg_customer: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_customer"} */

  create view "postgres"."public"."stg_customer__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."customer"
  );
[0m11:12:13.124844 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m11:12:13.128392 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m11:12:13.130152 [debug] [Thread-1 (]: On model.shared_models.stg_customer: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_customer"} */
alter table "postgres"."public"."stg_customer" rename to "stg_customer__dbt_backup"
[0m11:12:13.134640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:13.138089 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m11:12:13.146154 [debug] [Thread-1 (]: On model.shared_models.stg_customer: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_customer"} */
alter table "postgres"."public"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m11:12:13.149893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:13.153079 [debug] [Thread-1 (]: On model.shared_models.stg_customer: COMMIT
[0m11:12:13.154737 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m11:12:13.156436 [debug] [Thread-1 (]: On model.shared_models.stg_customer: COMMIT
[0m11:12:13.160400 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:13.163688 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m11:12:13.165046 [debug] [Thread-1 (]: On model.shared_models.stg_customer: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_customer"} */
drop view if exists "postgres"."public"."stg_customer__dbt_backup" cascade
[0m11:12:13.172120 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m11:12:13.174244 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:13.175551 [debug] [Thread-1 (]: On model.shared_models.stg_customer: Close
[0m11:12:13.179121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6c950c-92f0-469e-946f-470a60a90e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8da645e0>]}
[0m11:12:13.180979 [info ] [Thread-1 (]: 2 of 26 OK created sql view model public.stg_customer .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m11:12:13.183523 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_customer
[0m11:12:13.185588 [debug] [Thread-1 (]: Began running node model.shared_models.stg_film
[0m11:12:13.187829 [info ] [Thread-1 (]: 3 of 26 START sql view model public.stg_film ................................... [RUN]
[0m11:12:13.192011 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_film"
[0m11:12:13.193470 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_film
[0m11:12:13.195554 [debug] [Thread-1 (]: Compiling model.shared_models.stg_film
[0m11:12:13.199290 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_film"
[0m11:12:13.231658 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:13.234191 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_film
[0m11:12:13.238314 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_film"
[0m11:12:13.249619 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m11:12:13.252233 [debug] [Thread-1 (]: On model.shared_models.stg_film: BEGIN
[0m11:12:13.253349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:13.279855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:13.286771 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m11:12:13.289327 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */

  create view "postgres"."public"."stg_film__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."film"
  );
[0m11:12:13.320439 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m11:12:13.324272 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m11:12:13.332375 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */
alter table "postgres"."public"."stg_film" rename to "stg_film__dbt_backup"
[0m11:12:13.336177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:13.339392 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m11:12:13.340973 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */
alter table "postgres"."public"."stg_film__dbt_tmp" rename to "stg_film"
[0m11:12:13.345272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:13.347694 [debug] [Thread-1 (]: On model.shared_models.stg_film: COMMIT
[0m11:12:13.349221 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m11:12:13.350661 [debug] [Thread-1 (]: On model.shared_models.stg_film: COMMIT
[0m11:12:13.354895 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:13.357524 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m11:12:13.362036 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */
drop view if exists "postgres"."public"."stg_film__dbt_backup" cascade
[0m11:12:13.370824 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m11:12:13.373013 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:13.374189 [debug] [Thread-1 (]: On model.shared_models.stg_film: Close
[0m11:12:13.376044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6c950c-92f0-469e-946f-470a60a90e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db2d960>]}
[0m11:12:13.379347 [info ] [Thread-1 (]: 3 of 26 OK created sql view model public.stg_film .............................. [[32mCREATE VIEW[0m in 0.18s]
[0m11:12:13.381550 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_film
[0m11:12:13.383500 [debug] [Thread-1 (]: Began running node model.shared_models.stg_payment
[0m11:12:13.384972 [info ] [Thread-1 (]: 4 of 26 START sql view model public.stg_payment ................................ [RUN]
[0m11:12:13.386729 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_payment"
[0m11:12:13.411963 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_payment
[0m11:12:13.413678 [debug] [Thread-1 (]: Compiling model.shared_models.stg_payment
[0m11:12:13.417408 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_payment"
[0m11:12:13.423654 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:13.425947 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_payment
[0m11:12:13.430815 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_payment"
[0m11:12:13.437359 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:12:13.443507 [debug] [Thread-1 (]: On model.shared_models.stg_payment: BEGIN
[0m11:12:13.445191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:13.471511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:13.473604 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:12:13.477029 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */

  create view "postgres"."public"."stg_payment__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m11:12:13.510806 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m11:12:13.514751 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:12:13.516532 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */
alter table "postgres"."public"."stg_payment" rename to "stg_payment__dbt_backup"
[0m11:12:13.520154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:13.523122 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:12:13.525014 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */
alter table "postgres"."public"."stg_payment__dbt_tmp" rename to "stg_payment"
[0m11:12:13.528308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:13.531152 [debug] [Thread-1 (]: On model.shared_models.stg_payment: COMMIT
[0m11:12:13.532619 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:12:13.536165 [debug] [Thread-1 (]: On model.shared_models.stg_payment: COMMIT
[0m11:12:13.540107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:13.542825 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:12:13.544158 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */
drop view if exists "postgres"."public"."stg_payment__dbt_backup" cascade
[0m11:12:13.550721 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m11:12:13.554176 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:13.555709 [debug] [Thread-1 (]: On model.shared_models.stg_payment: Close
[0m11:12:13.557340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6c950c-92f0-469e-946f-470a60a90e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8da650f0>]}
[0m11:12:13.558982 [info ] [Thread-1 (]: 4 of 26 OK created sql view model public.stg_payment ........................... [[32mCREATE VIEW[0m in 0.17s]
[0m11:12:13.560710 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_payment
[0m11:12:13.585316 [debug] [Thread-1 (]: Began running node model.shared_models.stg_rental
[0m11:12:13.587703 [info ] [Thread-1 (]: 5 of 26 START sql view model public.stg_rental ................................. [RUN]
[0m11:12:13.590229 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_rental"
[0m11:12:13.592365 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_rental
[0m11:12:13.593991 [debug] [Thread-1 (]: Compiling model.shared_models.stg_rental
[0m11:12:13.597265 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_rental"
[0m11:12:13.607530 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:13.609233 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_rental
[0m11:12:13.617883 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_rental"
[0m11:12:13.625862 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:12:13.628322 [debug] [Thread-1 (]: On model.shared_models.stg_rental: BEGIN
[0m11:12:13.636740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:13.664894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:13.666922 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:12:13.668826 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */

  create view "postgres"."public"."stg_rental__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."rental"
  );
[0m11:12:13.695755 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m11:12:13.699439 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:12:13.701433 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */
alter table "postgres"."public"."stg_rental" rename to "stg_rental__dbt_backup"
[0m11:12:13.705030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:13.708025 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:12:13.711438 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */
alter table "postgres"."public"."stg_rental__dbt_tmp" rename to "stg_rental"
[0m11:12:13.715697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:13.718145 [debug] [Thread-1 (]: On model.shared_models.stg_rental: COMMIT
[0m11:12:13.719522 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:12:13.720895 [debug] [Thread-1 (]: On model.shared_models.stg_rental: COMMIT
[0m11:12:13.726230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:13.729881 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:12:13.731204 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */
drop view if exists "postgres"."public"."stg_rental__dbt_backup" cascade
[0m11:12:13.738696 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m11:12:13.740751 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:13.764728 [debug] [Thread-1 (]: On model.shared_models.stg_rental: Close
[0m11:12:13.767183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6c950c-92f0-469e-946f-470a60a90e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c164130>]}
[0m11:12:13.769456 [info ] [Thread-1 (]: 5 of 26 OK created sql view model public.stg_rental ............................ [[32mCREATE VIEW[0m in 0.18s]
[0m11:12:13.771824 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_rental
[0m11:12:13.773556 [debug] [Thread-1 (]: Began running node seed.customer.customer_base
[0m11:12:13.775310 [info ] [Thread-1 (]: 6 of 26 START seed file public.customer_base ................................... [RUN]
[0m11:12:13.777597 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.customer.customer_base"
[0m11:12:13.779136 [debug] [Thread-1 (]: Began compiling node seed.customer.customer_base
[0m11:12:13.785275 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:13.787213 [debug] [Thread-1 (]: Began executing node seed.customer.customer_base
[0m11:12:13.827053 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m11:12:13.829107 [debug] [Thread-1 (]: On seed.customer.customer_base: BEGIN
[0m11:12:13.835198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:13.862005 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:13.864730 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m11:12:13.866233 [debug] [Thread-1 (]: On seed.customer.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "seed.customer.customer_base"} */
truncate table "postgres"."public"."customer_base"
[0m11:12:13.888667 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m11:12:14.413586 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m11:12:14.417507 [debug] [Thread-1 (]: On seed.customer.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m11:12:14.474260 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.05 seconds
[0m11:12:14.480697 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.customer.customer_base"
[0m11:12:14.491552 [debug] [Thread-1 (]: On seed.customer.customer_base: COMMIT
[0m11:12:14.493016 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m11:12:14.494399 [debug] [Thread-1 (]: On seed.customer.customer_base: COMMIT
[0m11:12:14.502459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:14.505080 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:14.506661 [debug] [Thread-1 (]: On seed.customer.customer_base: Close
[0m11:12:14.533666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6c950c-92f0-469e-946f-470a60a90e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90477190>]}
[0m11:12:14.535953 [info ] [Thread-1 (]: 6 of 26 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 0.76s]
[0m11:12:14.538358 [debug] [Thread-1 (]: Finished running node seed.customer.customer_base
[0m11:12:14.540563 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m11:12:14.542302 [info ] [Thread-1 (]: 7 of 26 START test not_null_stg_category_category_id ........................... [RUN]
[0m11:12:14.546235 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m11:12:14.554331 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m11:12:14.556515 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m11:12:14.571297 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m11:12:14.576999 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:14.585494 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m11:12:14.595297 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m11:12:14.605050 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m11:12:14.606558 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: BEGIN
[0m11:12:14.609767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:14.637265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:14.639705 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m11:12:14.641579 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_category_category_id.d4eb91c268"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select category_id
from "postgres"."public"."stg_category"
where category_id is null



      
    ) dbt_internal_test
[0m11:12:14.672234 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:12:14.675207 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:14.677321 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: ROLLBACK
[0m11:12:14.679736 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: Close
[0m11:12:14.681528 [info ] [Thread-1 (]: 7 of 26 PASS not_null_stg_category_category_id ................................. [[32mPASS[0m in 0.14s]
[0m11:12:14.683190 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m11:12:14.708314 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m11:12:14.710857 [info ] [Thread-1 (]: 8 of 26 START test unique_stg_category_category_id ............................. [RUN]
[0m11:12:14.713309 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m11:12:14.715263 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m11:12:14.717521 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m11:12:14.723074 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m11:12:14.733380 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:14.735052 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m11:12:14.737691 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m11:12:14.748565 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m11:12:14.749997 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: BEGIN
[0m11:12:14.757169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:14.783660 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:14.786393 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m11:12:14.788309 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    category_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_category"
where category_id is not null
group by category_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:12:14.819904 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:12:14.823123 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:14.824907 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: ROLLBACK
[0m11:12:14.828490 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: Close
[0m11:12:14.831083 [info ] [Thread-1 (]: 8 of 26 PASS unique_stg_category_category_id ................................... [[32mPASS[0m in 0.12s]
[0m11:12:14.836582 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m11:12:14.838691 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m11:12:14.840188 [info ] [Thread-1 (]: 9 of 26 START test not_null_stg_customer_customer_id ........................... [RUN]
[0m11:12:14.842849 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m11:12:14.844405 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m11:12:14.847576 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m11:12:14.851697 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m11:12:14.880335 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:14.882439 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m11:12:14.885214 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m11:12:14.890536 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m11:12:14.897109 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: BEGIN
[0m11:12:14.899232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:14.924931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:14.927085 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m11:12:14.929162 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_customer"
where customer_id is null



      
    ) dbt_internal_test
[0m11:12:14.960204 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:12:14.963033 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:14.964611 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: ROLLBACK
[0m11:12:14.966754 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: Close
[0m11:12:14.968747 [info ] [Thread-1 (]: 9 of 26 PASS not_null_stg_customer_customer_id ................................. [[32mPASS[0m in 0.13s]
[0m11:12:14.976490 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m11:12:14.978287 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m11:12:14.979818 [info ] [Thread-1 (]: 10 of 26 START test unique_stg_customer_customer_id ............................ [RUN]
[0m11:12:14.981725 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m11:12:14.983063 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m11:12:14.984854 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m11:12:14.990272 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m11:12:14.997041 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:14.998469 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m11:12:15.001229 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m11:12:15.007843 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m11:12:15.009891 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: BEGIN
[0m11:12:15.011147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:15.036114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:12:15.061402 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m11:12:15.063284 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_customer_customer_id.310773d0ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:12:15.097370 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:12:15.100473 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:15.102007 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: ROLLBACK
[0m11:12:15.104368 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: Close
[0m11:12:15.106922 [info ] [Thread-1 (]: 10 of 26 PASS unique_stg_customer_customer_id .................................. [[32mPASS[0m in 0.13s]
[0m11:12:15.109291 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m11:12:15.115337 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m11:12:15.117216 [info ] [Thread-1 (]: 11 of 26 START test not_null_stg_film_film_id .................................. [RUN]
[0m11:12:15.119137 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m11:12:15.121096 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m11:12:15.127288 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m11:12:15.131427 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m11:12:15.137519 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:15.146080 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m11:12:15.149020 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m11:12:15.154502 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m11:12:15.156083 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: BEGIN
[0m11:12:15.157609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:15.182689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:15.185031 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m11:12:15.188733 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select film_id
from "postgres"."public"."stg_film"
where film_id is null



      
    ) dbt_internal_test
[0m11:12:15.219386 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:12:15.223452 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:15.227045 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: ROLLBACK
[0m11:12:15.231546 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: Close
[0m11:12:15.234541 [info ] [Thread-1 (]: 11 of 26 PASS not_null_stg_film_film_id ........................................ [[32mPASS[0m in 0.12s]
[0m11:12:15.237648 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m11:12:15.240063 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m11:12:15.241865 [info ] [Thread-1 (]: 12 of 26 START test unique_stg_film_film_id .................................... [RUN]
[0m11:12:15.267925 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m11:12:15.269898 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m11:12:15.271469 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m11:12:15.275535 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m11:12:15.281090 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:15.287049 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m11:12:15.290281 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m11:12:15.295887 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m11:12:15.301931 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: BEGIN
[0m11:12:15.303229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:15.329570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:15.332242 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m11:12:15.334176 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_film_film_id.1cbe88695a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    film_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_film"
where film_id is not null
group by film_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:12:15.381667 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.04 seconds
[0m11:12:15.387033 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:15.389659 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: ROLLBACK
[0m11:12:15.392743 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: Close
[0m11:12:15.395923 [info ] [Thread-1 (]: 12 of 26 PASS unique_stg_film_film_id .......................................... [[32mPASS[0m in 0.13s]
[0m11:12:15.399078 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m11:12:15.400855 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m11:12:15.402727 [info ] [Thread-1 (]: 13 of 26 START test not_null_stg_payment_customer_id ........................... [RUN]
[0m11:12:15.404897 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m11:12:15.408477 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m11:12:15.410497 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m11:12:15.414741 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m11:12:15.422981 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:15.426380 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m11:12:15.431858 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m11:12:15.463559 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m11:12:15.466636 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: BEGIN
[0m11:12:15.468140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:15.493031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m11:12:15.500223 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m11:12:15.502493 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_payment"
where customer_id is null



      
    ) dbt_internal_test
[0m11:12:15.533166 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:12:15.535882 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:15.537547 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: ROLLBACK
[0m11:12:15.545008 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: Close
[0m11:12:15.547269 [info ] [Thread-1 (]: 13 of 26 PASS not_null_stg_payment_customer_id ................................. [[32mPASS[0m in 0.14s]
[0m11:12:15.550445 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m11:12:15.552158 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m11:12:15.553613 [info ] [Thread-1 (]: 14 of 26 START test not_null_stg_payment_payment_id ............................ [RUN]
[0m11:12:15.562254 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m11:12:15.564094 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m11:12:15.566154 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m11:12:15.571222 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m11:12:15.576868 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:15.578410 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m11:12:15.581072 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m11:12:15.589039 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m11:12:15.590353 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: BEGIN
[0m11:12:15.591643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:15.619941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:15.622028 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m11:12:15.623643 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payment"
where payment_id is null



      
    ) dbt_internal_test
[0m11:12:15.653046 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:12:15.678479 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:15.680358 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: ROLLBACK
[0m11:12:15.684557 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: Close
[0m11:12:15.686859 [info ] [Thread-1 (]: 14 of 26 PASS not_null_stg_payment_payment_id .................................. [[32mPASS[0m in 0.12s]
[0m11:12:15.689220 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m11:12:15.691394 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m11:12:15.693360 [info ] [Thread-1 (]: 15 of 26 START test unique_stg_payment_payment_id .............................. [RUN]
[0m11:12:15.700343 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m11:12:15.702388 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m11:12:15.704132 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m11:12:15.708051 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m11:12:15.717913 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:15.720079 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m11:12:15.723248 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m11:12:15.735162 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m11:12:15.736898 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: BEGIN
[0m11:12:15.738126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:15.763278 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:15.765837 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m11:12:15.767224 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_payment_payment_id.7398e70184"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payment"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:12:15.853689 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.09 seconds
[0m11:12:15.859239 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:15.860940 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: ROLLBACK
[0m11:12:15.864128 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: Close
[0m11:12:15.867022 [info ] [Thread-1 (]: 15 of 26 PASS unique_stg_payment_payment_id .................................... [[32mPASS[0m in 0.17s]
[0m11:12:15.869143 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m11:12:15.872146 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m11:12:15.874019 [info ] [Thread-1 (]: 16 of 26 START test not_null_stg_rental_rental_id .............................. [RUN]
[0m11:12:15.876238 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m11:12:15.877831 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m11:12:15.879572 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m11:12:15.906900 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m11:12:15.913081 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:15.915480 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m11:12:15.918234 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m11:12:15.941275 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m11:12:15.943046 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: BEGIN
[0m11:12:15.949624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:15.975391 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:15.987983 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m11:12:15.990455 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rental_id
from "postgres"."public"."stg_rental"
where rental_id is null



      
    ) dbt_internal_test
[0m11:12:16.023133 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:12:16.026439 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:16.028160 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: ROLLBACK
[0m11:12:16.032623 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: Close
[0m11:12:16.035157 [info ] [Thread-1 (]: 16 of 26 PASS not_null_stg_rental_rental_id .................................... [[32mPASS[0m in 0.16s]
[0m11:12:16.037383 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m11:12:16.039549 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m11:12:16.041828 [info ] [Thread-1 (]: 17 of 26 START test unique_stg_rental_rental_id ................................ [RUN]
[0m11:12:16.043972 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m11:12:16.045327 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m11:12:16.048936 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_rental_rental_id.b263207352
[0m11:12:16.053717 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m11:12:16.060634 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:16.062879 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m11:12:16.066765 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m11:12:16.095962 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m11:12:16.099220 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: BEGIN
[0m11:12:16.100999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:16.127720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:16.129669 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m11:12:16.131489 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_rental_rental_id.b263207352"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    rental_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_rental"
where rental_id is not null
group by rental_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:12:16.205833 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.07 seconds
[0m11:12:16.208934 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:16.211148 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: ROLLBACK
[0m11:12:16.213700 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: Close
[0m11:12:16.220462 [info ] [Thread-1 (]: 17 of 26 PASS unique_stg_rental_rental_id ...................................... [[32mPASS[0m in 0.18s]
[0m11:12:16.222259 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m11:12:16.223847 [debug] [Thread-1 (]: Began running node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m11:12:16.226077 [info ] [Thread-1 (]: 18 of 26 START test not_null_customer_base_customer_id ......................... [RUN]
[0m11:12:16.229095 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m11:12:16.236989 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m11:12:16.239027 [debug] [Thread-1 (]: Compiling test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m11:12:16.243247 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m11:12:16.250973 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:16.252382 [debug] [Thread-1 (]: Began executing node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m11:12:16.255263 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m11:12:16.262987 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m11:12:16.264504 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m11:12:16.266047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:16.293555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:16.296085 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m11:12:16.297947 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m11:12:16.318794 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:12:16.344117 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:16.345907 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m11:12:16.348314 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: Close
[0m11:12:16.349964 [info ] [Thread-1 (]: 18 of 26 PASS not_null_customer_base_customer_id ............................... [[32mPASS[0m in 0.12s]
[0m11:12:16.352041 [debug] [Thread-1 (]: Finished running node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m11:12:16.353653 [debug] [Thread-1 (]: Began running node test.customer.not_null_customer_base_store_id.e159464168
[0m11:12:16.356365 [info ] [Thread-1 (]: 19 of 26 START test not_null_customer_base_store_id ............................ [RUN]
[0m11:12:16.358396 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_customer_base_store_id.e159464168"
[0m11:12:16.364554 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_customer_base_store_id.e159464168
[0m11:12:16.366950 [debug] [Thread-1 (]: Compiling test.customer.not_null_customer_base_store_id.e159464168
[0m11:12:16.370465 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_customer_base_store_id.e159464168"
[0m11:12:16.385020 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:16.386545 [debug] [Thread-1 (]: Began executing node test.customer.not_null_customer_base_store_id.e159464168
[0m11:12:16.389588 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_customer_base_store_id.e159464168"
[0m11:12:16.402112 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_store_id.e159464168"
[0m11:12:16.403704 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: BEGIN
[0m11:12:16.405117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:16.430991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:16.433248 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_store_id.e159464168"
[0m11:12:16.434867 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m11:12:16.457090 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:12:16.459950 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:16.461970 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m11:12:16.464994 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: Close
[0m11:12:16.466992 [info ] [Thread-1 (]: 19 of 26 PASS not_null_customer_base_store_id .................................. [[32mPASS[0m in 0.11s]
[0m11:12:16.469273 [debug] [Thread-1 (]: Finished running node test.customer.not_null_customer_base_store_id.e159464168
[0m11:12:16.472340 [debug] [Thread-1 (]: Began running node model.shared_models.int_revenue_by_date
[0m11:12:16.473901 [info ] [Thread-1 (]: 20 of 26 START sql view model public.int_revenue_by_date ....................... [RUN]
[0m11:12:16.476117 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.int_revenue_by_date"
[0m11:12:16.477827 [debug] [Thread-1 (]: Began compiling node model.shared_models.int_revenue_by_date
[0m11:12:16.501612 [debug] [Thread-1 (]: Compiling model.shared_models.int_revenue_by_date
[0m11:12:16.505340 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.int_revenue_by_date"
[0m11:12:16.512423 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:16.514514 [debug] [Thread-1 (]: Began executing node model.shared_models.int_revenue_by_date
[0m11:12:16.519076 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.int_revenue_by_date"
[0m11:12:16.530358 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m11:12:16.531836 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: BEGIN
[0m11:12:16.537990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:16.563428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:16.565453 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m11:12:16.566979 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    "postgres"."public"."stg_payment"
GROUP BY
    1
  );
[0m11:12:16.602842 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m11:12:16.607988 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m11:12:16.609941 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date__dbt_tmp" rename to "int_revenue_by_date"
[0m11:12:16.614599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:16.617025 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: COMMIT
[0m11:12:16.618352 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m11:12:16.620334 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: COMMIT
[0m11:12:16.625091 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:16.627736 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m11:12:16.629010 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.int_revenue_by_date"} */
drop view if exists "postgres"."public"."int_revenue_by_date__dbt_backup" cascade
[0m11:12:16.632495 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:12:16.636562 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:16.638312 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: Close
[0m11:12:16.640582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6c950c-92f0-469e-946f-470a60a90e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908dbfd0>]}
[0m11:12:16.642038 [info ] [Thread-1 (]: 20 of 26 OK created sql view model public.int_revenue_by_date .................. [[32mCREATE VIEW[0m in 0.16s]
[0m11:12:16.643370 [debug] [Thread-1 (]: Finished running node model.shared_models.int_revenue_by_date
[0m11:12:16.647012 [debug] [Thread-1 (]: Began running node model.customer.int_customers_per_store
[0m11:12:16.648694 [info ] [Thread-1 (]: 21 of 26 START sql view model public.int_customers_per_store ................... [RUN]
[0m11:12:16.651171 [debug] [Thread-1 (]: Acquiring new postgres connection "model.customer.int_customers_per_store"
[0m11:12:16.652852 [debug] [Thread-1 (]: Began compiling node model.customer.int_customers_per_store
[0m11:12:16.677407 [debug] [Thread-1 (]: Compiling model.customer.int_customers_per_store
[0m11:12:16.681975 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer.int_customers_per_store"
[0m11:12:16.690558 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:16.692465 [debug] [Thread-1 (]: Began executing node model.customer.int_customers_per_store
[0m11:12:16.701440 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer.int_customers_per_store"
[0m11:12:16.713637 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m11:12:16.716167 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: BEGIN
[0m11:12:16.717825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:16.743095 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:16.745455 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m11:12:16.753011 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */

  create view "postgres"."public"."int_customers_per_store__dbt_tmp" as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    "postgres"."public"."customer_base"
GROUP BY
    1
  );
[0m11:12:16.778981 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m11:12:16.783978 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m11:12:16.785767 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store" rename to "int_customers_per_store__dbt_backup"
[0m11:12:16.789511 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:16.792866 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m11:12:16.794647 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store__dbt_tmp" rename to "int_customers_per_store"
[0m11:12:16.797960 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:16.800453 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: COMMIT
[0m11:12:16.804071 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m11:12:16.805822 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: COMMIT
[0m11:12:16.809431 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:16.812086 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m11:12:16.813290 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */
drop view if exists "postgres"."public"."int_customers_per_store__dbt_backup" cascade
[0m11:12:16.819639 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:12:16.823495 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:16.824764 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: Close
[0m11:12:16.826417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6c950c-92f0-469e-946f-470a60a90e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8da9e6e0>]}
[0m11:12:16.827969 [info ] [Thread-1 (]: 21 of 26 OK created sql view model public.int_customers_per_store .............. [[32mCREATE VIEW[0m in 0.18s]
[0m11:12:16.829876 [debug] [Thread-1 (]: Finished running node model.customer.int_customers_per_store
[0m11:12:16.855908 [debug] [Thread-1 (]: Began running node model.customer.cumulative_revenue
[0m11:12:16.859454 [info ] [Thread-1 (]: 22 of 26 START sql table model public.cumulative_revenue ....................... [RUN]
[0m11:12:16.862646 [debug] [Thread-1 (]: Acquiring new postgres connection "model.customer.cumulative_revenue"
[0m11:12:16.865085 [debug] [Thread-1 (]: Began compiling node model.customer.cumulative_revenue
[0m11:12:16.866940 [debug] [Thread-1 (]: Compiling model.customer.cumulative_revenue
[0m11:12:16.870667 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer.cumulative_revenue"
[0m11:12:16.883023 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:16.885204 [debug] [Thread-1 (]: Began executing node model.customer.cumulative_revenue
[0m11:12:16.899018 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer.cumulative_revenue"
[0m11:12:16.910881 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:12:16.912330 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: BEGIN
[0m11:12:16.920021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:16.945538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:16.947951 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:12:16.949706 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */

  
    

  create  table "postgres"."public"."cumulative_revenue__dbt_tmp"
  as (
    

SELECT
    payment_date,
    amount,
    SUM(amount) OVER (ORDER BY payment_date)
FROM
    "postgres"."public"."int_revenue_by_date"
ORDER BY
    payment_date
  );
  
[0m11:12:17.043176 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.09 seconds
[0m11:12:17.046829 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:12:17.048673 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue" rename to "cumulative_revenue__dbt_backup"
[0m11:12:17.052934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:17.056279 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:12:17.059508 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue__dbt_tmp" rename to "cumulative_revenue"
[0m11:12:17.062290 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:17.066722 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: COMMIT
[0m11:12:17.068862 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:12:17.070428 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: COMMIT
[0m11:12:17.076230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:17.079081 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:12:17.080732 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
drop table if exists "postgres"."public"."cumulative_revenue__dbt_backup" cascade
[0m11:12:17.089064 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m11:12:17.091967 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:17.116298 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: Close
[0m11:12:17.118583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6c950c-92f0-469e-946f-470a60a90e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc2a7a0>]}
[0m11:12:17.123542 [info ] [Thread-1 (]: 22 of 26 OK created sql table model public.cumulative_revenue .................. [[32mSELECT 40[0m in 0.26s]
[0m11:12:17.125467 [debug] [Thread-1 (]: Finished running node model.customer.cumulative_revenue
[0m11:12:17.126901 [debug] [Thread-1 (]: Began running node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m11:12:17.128227 [info ] [Thread-1 (]: 23 of 26 START test not_null_int_customers_per_store_store_id .................. [RUN]
[0m11:12:17.146449 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m11:12:17.153155 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m11:12:17.155161 [debug] [Thread-1 (]: Compiling test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m11:12:17.159470 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m11:12:17.171847 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:17.174067 [debug] [Thread-1 (]: Began executing node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m11:12:17.177153 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m11:12:17.189936 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m11:12:17.191492 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m11:12:17.192846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:17.218195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:17.220521 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m11:12:17.222275 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."int_customers_per_store"
where store_id is null



      
    ) dbt_internal_test
[0m11:12:17.250875 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:12:17.255669 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:17.258039 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m11:12:17.260295 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m11:12:17.262088 [info ] [Thread-1 (]: 23 of 26 PASS not_null_int_customers_per_store_store_id ........................ [[32mPASS[0m in 0.12s]
[0m11:12:17.263445 [debug] [Thread-1 (]: Finished running node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m11:12:17.266168 [debug] [Thread-1 (]: Began running node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m11:12:17.269320 [info ] [Thread-1 (]: 24 of 26 START test not_null_int_customers_per_store_total_customers ........... [RUN]
[0m11:12:17.271218 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m11:12:17.273037 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m11:12:17.274844 [debug] [Thread-1 (]: Compiling test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m11:12:17.279111 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m11:12:17.307971 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:17.310239 [debug] [Thread-1 (]: Began executing node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m11:12:17.314588 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m11:12:17.326298 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m11:12:17.327920 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m11:12:17.329363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:17.354461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:17.361146 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m11:12:17.363040 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_customers
from "postgres"."public"."int_customers_per_store"
where total_customers is null



      
    ) dbt_internal_test
[0m11:12:17.392816 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:12:17.401598 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:17.411058 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m11:12:17.468505 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m11:12:17.471378 [info ] [Thread-1 (]: 24 of 26 PASS not_null_int_customers_per_store_total_customers ................. [[32mPASS[0m in 0.20s]
[0m11:12:17.485637 [debug] [Thread-1 (]: Finished running node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m11:12:17.488933 [debug] [Thread-1 (]: Began running node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m11:12:17.490916 [info ] [Thread-1 (]: 25 of 26 START test unique_int_customers_per_store_store_id .................... [RUN]
[0m11:12:17.493476 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m11:12:17.496262 [debug] [Thread-1 (]: Began compiling node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m11:12:17.498620 [debug] [Thread-1 (]: Compiling test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m11:12:17.502806 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m11:12:17.510626 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:17.512117 [debug] [Thread-1 (]: Began executing node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m11:12:17.514530 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m11:12:17.522835 [debug] [Thread-1 (]: Using postgres connection "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m11:12:17.525425 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m11:12:17.550566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:17.578259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:12:17.580301 [debug] [Thread-1 (]: Using postgres connection "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m11:12:17.581552 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "postgres"."public"."int_customers_per_store"
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:12:17.612289 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:12:17.615695 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:17.617694 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m11:12:17.620853 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m11:12:17.626960 [info ] [Thread-1 (]: 25 of 26 PASS unique_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.13s]
[0m11:12:17.630524 [debug] [Thread-1 (]: Finished running node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m11:12:17.633644 [debug] [Thread-1 (]: Began running node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m11:12:17.635178 [info ] [Thread-1 (]: 26 of 26 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot  [RUN]
[0m11:12:17.637064 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:12:17.644402 [debug] [Thread-1 (]: Began compiling node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m11:12:17.646026 [debug] [Thread-1 (]: Compiling snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m11:12:17.649892 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:17.651695 [debug] [Thread-1 (]: Began executing node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m11:12:17.685578 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:12:17.687993 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */
select * from (
            select total_customers from (

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"
) subq
        ) as __dbt_sbq
        where false
        limit 0
    
[0m11:12:17.690500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:17.732394 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.04 seconds
[0m11:12:17.738549 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:12:17.740173 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m11:12:17.742464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:17.743891 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:12:17.745355 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:12:17.817380 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.07 seconds
[0m11:12:17.825560 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:12:17.827618 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:12:17.844294 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m11:12:17.855345 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:12:17.857129 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

        
  
    

  create temporary table "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp111217851698"
  as (
    with snapshot_query as (

        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"


    ),

    snapshotted_data as (

        select *,
            store_id as dbt_unique_key

        from "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(store_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            store_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m11:12:17.899582 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.04 seconds
[0m11:12:17.903739 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:12:17.928075 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp111217851698'
        
      order by ordinal_position

  
[0m11:12:17.946938 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m11:12:17.950969 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:12:17.952960 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:12:17.970065 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.02 seconds
[0m11:12:17.973939 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:12:17.980436 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp111217851698'
        
      order by ordinal_position

  
[0m11:12:17.996880 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.01 seconds
[0m11:12:18.000454 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:12:18.002156 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:12:18.017966 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m11:12:18.024597 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:12:18.027287 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp111217851698'
        
      order by ordinal_position

  
[0m11:12:18.044734 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m11:12:18.050444 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:12:18.064322 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:12:18.065607 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      update "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp111217851698" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_valid_to is null;

    insert into "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot" ("store_id", "total_customers", "current_date", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."store_id",DBT_INTERNAL_SOURCE."total_customers",DBT_INTERNAL_SOURCE."current_date",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp111217851698" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m11:12:18.074575 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.01 seconds
[0m11:12:18.077409 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m11:12:18.079436 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:12:18.080896 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m11:12:18.084690 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:18.090104 [debug] [Thread-1 (]: finished collecting timing info
[0m11:12:18.091577 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m11:12:18.094236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a6c950c-92f0-469e-946f-470a60a90e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8daf3b50>]}
[0m11:12:18.096175 [info ] [Thread-1 (]: 26 of 26 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot  [[32mINSERT 0 0[0m in 0.46s]
[0m11:12:18.097979 [debug] [Thread-1 (]: Finished running node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m11:12:18.102336 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:12:18.104076 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:18.105892 [debug] [MainThread]: On master: BEGIN
[0m11:12:18.107380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:12:18.133430 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m11:12:18.157814 [debug] [MainThread]: On master: COMMIT
[0m11:12:18.159658 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:18.161364 [debug] [MainThread]: On master: COMMIT
[0m11:12:18.164030 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:12:18.165917 [debug] [MainThread]: On master: Close
[0m11:12:18.168130 [info ] [MainThread]: 
[0m11:12:18.170014 [info ] [MainThread]: Finished running 7 view models, 1 seed, 16 tests, 1 table model, 1 snapshot in 0 hours 0 minutes and 20.91 seconds (20.91s).
[0m11:12:18.176506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:18.178159 [debug] [MainThread]: Connection 'snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m11:12:18.246114 [info ] [MainThread]: 
[0m11:12:18.249022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:12:18.251142 [info ] [MainThread]: 
[0m11:12:18.252746 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=0 SKIP=0 TOTAL=26
[0m11:12:18.255097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f4d2fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f4d1480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f4d1600>]}
[0m11:12:18.257452 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 11:13:26.982265 | 3328dbab-7bf6-4b71-9d32-1c367f2c385a ==============================
[0m11:13:26.982276 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:13:26.983661 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:13:26.987177 [debug] [MainThread]: Tracking: tracking
[0m11:13:26.991832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff958eff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff958ee950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff958ee9b0>]}
[0m11:13:27.376910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:13:27.378624 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:13:27.383932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3328dbab-7bf6-4b71-9d32-1c367f2c385a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c99390>]}
[0m11:13:27.459203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3328dbab-7bf6-4b71-9d32-1c367f2c385a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c60070>]}
[0m11:13:27.462359 [info ] [MainThread]: Found 8 models, 16 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 5 sources, 0 exposures, 0 metrics
[0m11:13:27.469333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3328dbab-7bf6-4b71-9d32-1c367f2c385a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a13fa0>]}
[0m11:13:27.472901 [info ] [MainThread]: 
[0m11:13:27.475158 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:13:27.478135 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:13:27.485799 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:13:27.487542 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:13:27.488990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:27.537265 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.05 seconds
[0m11:13:27.540107 [debug] [ThreadPool]: On list_postgres: Close
[0m11:13:27.545394 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m11:13:27.551003 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:13:27.553144 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m11:13:27.555228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:27.582662 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m11:13:27.586059 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:13:27.587730 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:13:27.637572 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.05 seconds
[0m11:13:27.641177 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:13:27.666789 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:13:27.672387 [debug] [MainThread]: Using postgres connection "master"
[0m11:13:27.675105 [debug] [MainThread]: On master: BEGIN
[0m11:13:27.677292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:13:32.750978 [debug] [MainThread]: SQL status: BEGIN in 5.07 seconds
[0m11:13:32.760720 [debug] [MainThread]: Using postgres connection "master"
[0m11:13:32.764449 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:13:32.844114 [debug] [MainThread]: SQL status: SELECT 50 in 0.08 seconds
[0m11:13:32.847895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3328dbab-7bf6-4b71-9d32-1c367f2c385a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c43bb0>]}
[0m11:13:32.854191 [debug] [MainThread]: On master: ROLLBACK
[0m11:13:32.857181 [debug] [MainThread]: Using postgres connection "master"
[0m11:13:32.859063 [debug] [MainThread]: On master: BEGIN
[0m11:13:32.861180 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:13:32.863172 [debug] [MainThread]: On master: COMMIT
[0m11:13:32.864896 [debug] [MainThread]: Using postgres connection "master"
[0m11:13:32.866298 [debug] [MainThread]: On master: COMMIT
[0m11:13:32.868528 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:13:32.870061 [debug] [MainThread]: On master: Close
[0m11:13:32.872144 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:13:32.875801 [info ] [MainThread]: 
[0m11:13:32.880593 [debug] [Thread-1 (]: Began running node model.shared_models.stg_category
[0m11:13:32.882658 [info ] [Thread-1 (]: 1 of 26 START sql view model public.stg_category ............................... [RUN]
[0m11:13:32.884887 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_category"
[0m11:13:32.886277 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_category
[0m11:13:32.889309 [debug] [Thread-1 (]: Compiling model.shared_models.stg_category
[0m11:13:32.892291 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_category"
[0m11:13:32.898378 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:32.924316 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_category
[0m11:13:32.945963 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_category"
[0m11:13:32.951911 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m11:13:32.953572 [debug] [Thread-1 (]: On model.shared_models.stg_category: BEGIN
[0m11:13:32.960030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:32.985454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:32.987443 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m11:13:32.989060 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */

  create view "postgres"."public"."stg_category__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."category"
  );
[0m11:13:33.014435 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.02 seconds
[0m11:13:33.024939 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m11:13:33.027092 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */
alter table "postgres"."public"."stg_category" rename to "stg_category__dbt_backup"
[0m11:13:33.031065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:13:33.034558 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m11:13:33.036060 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */
alter table "postgres"."public"."stg_category__dbt_tmp" rename to "stg_category"
[0m11:13:33.046187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:13:33.056495 [debug] [Thread-1 (]: On model.shared_models.stg_category: COMMIT
[0m11:13:33.058150 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m11:13:33.059847 [debug] [Thread-1 (]: On model.shared_models.stg_category: COMMIT
[0m11:13:33.065100 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:13:33.069019 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_category"
[0m11:13:33.070620 [debug] [Thread-1 (]: On model.shared_models.stg_category: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_category"} */
drop view if exists "postgres"."public"."stg_category__dbt_backup" cascade
[0m11:13:33.078262 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m11:13:33.080704 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:33.081938 [debug] [Thread-1 (]: On model.shared_models.stg_category: Close
[0m11:13:33.085581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328dbab-7bf6-4b71-9d32-1c367f2c385a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b45030>]}
[0m11:13:33.088222 [info ] [Thread-1 (]: 1 of 26 OK created sql view model public.stg_category .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m11:13:33.090378 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_category
[0m11:13:33.092177 [debug] [Thread-1 (]: Began running node model.shared_models.stg_customer
[0m11:13:33.095442 [info ] [Thread-1 (]: 2 of 26 START sql view model public.stg_customer ............................... [RUN]
[0m11:13:33.097416 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_customer"
[0m11:13:33.099352 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_customer
[0m11:13:33.100916 [debug] [Thread-1 (]: Compiling model.shared_models.stg_customer
[0m11:13:33.104353 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_customer"
[0m11:13:33.135093 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:33.137080 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_customer
[0m11:13:33.141883 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_customer"
[0m11:13:33.151291 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m11:13:33.153201 [debug] [Thread-1 (]: On model.shared_models.stg_customer: BEGIN
[0m11:13:33.154768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:33.182131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:33.184556 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m11:13:33.191691 [debug] [Thread-1 (]: On model.shared_models.stg_customer: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_customer"} */

  create view "postgres"."public"."stg_customer__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."customer"
  );
[0m11:13:33.222958 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m11:13:33.227606 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m11:13:33.230174 [debug] [Thread-1 (]: On model.shared_models.stg_customer: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_customer"} */
alter table "postgres"."public"."stg_customer" rename to "stg_customer__dbt_backup"
[0m11:13:33.239842 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:13:33.243364 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m11:13:33.245229 [debug] [Thread-1 (]: On model.shared_models.stg_customer: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_customer"} */
alter table "postgres"."public"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m11:13:33.248851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:13:33.252056 [debug] [Thread-1 (]: On model.shared_models.stg_customer: COMMIT
[0m11:13:33.253567 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m11:13:33.255286 [debug] [Thread-1 (]: On model.shared_models.stg_customer: COMMIT
[0m11:13:33.258943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:13:33.262963 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_customer"
[0m11:13:33.264554 [debug] [Thread-1 (]: On model.shared_models.stg_customer: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_customer"} */
drop view if exists "postgres"."public"."stg_customer__dbt_backup" cascade
[0m11:13:33.273728 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m11:13:33.276227 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:33.278008 [debug] [Thread-1 (]: On model.shared_models.stg_customer: Close
[0m11:13:33.280496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328dbab-7bf6-4b71-9d32-1c367f2c385a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94af85e0>]}
[0m11:13:33.282144 [info ] [Thread-1 (]: 2 of 26 OK created sql view model public.stg_customer .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m11:13:33.286138 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_customer
[0m11:13:33.288218 [debug] [Thread-1 (]: Began running node model.shared_models.stg_film
[0m11:13:33.289508 [info ] [Thread-1 (]: 3 of 26 START sql view model public.stg_film ................................... [RUN]
[0m11:13:33.291461 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_film"
[0m11:13:33.315902 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_film
[0m11:13:33.319576 [debug] [Thread-1 (]: Compiling model.shared_models.stg_film
[0m11:13:33.323884 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_film"
[0m11:13:33.331038 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:33.333296 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_film
[0m11:13:33.337777 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_film"
[0m11:13:33.345058 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m11:13:33.346775 [debug] [Thread-1 (]: On model.shared_models.stg_film: BEGIN
[0m11:13:33.352924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:33.379823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:33.382529 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m11:13:33.384895 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */

  create view "postgres"."public"."stg_film__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."film"
  );
[0m11:13:33.418355 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m11:13:33.421664 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m11:13:33.423162 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */
alter table "postgres"."public"."stg_film" rename to "stg_film__dbt_backup"
[0m11:13:33.427538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:13:33.430518 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m11:13:33.433004 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */
alter table "postgres"."public"."stg_film__dbt_tmp" rename to "stg_film"
[0m11:13:33.436693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:13:33.439239 [debug] [Thread-1 (]: On model.shared_models.stg_film: COMMIT
[0m11:13:33.440861 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m11:13:33.442551 [debug] [Thread-1 (]: On model.shared_models.stg_film: COMMIT
[0m11:13:33.448826 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:13:33.451480 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_film"
[0m11:13:33.453005 [debug] [Thread-1 (]: On model.shared_models.stg_film: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_film"} */
drop view if exists "postgres"."public"."stg_film__dbt_backup" cascade
[0m11:13:33.459941 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m11:13:33.462055 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:33.465729 [debug] [Thread-1 (]: On model.shared_models.stg_film: Close
[0m11:13:33.467309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328dbab-7bf6-4b71-9d32-1c367f2c385a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94bb50f0>]}
[0m11:13:33.468908 [info ] [Thread-1 (]: 3 of 26 OK created sql view model public.stg_film .............................. [[32mCREATE VIEW[0m in 0.18s]
[0m11:13:33.470352 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_film
[0m11:13:33.494886 [debug] [Thread-1 (]: Began running node model.shared_models.stg_payment
[0m11:13:33.497105 [info ] [Thread-1 (]: 4 of 26 START sql view model public.stg_payment ................................ [RUN]
[0m11:13:33.499247 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_payment"
[0m11:13:33.501484 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_payment
[0m11:13:33.503178 [debug] [Thread-1 (]: Compiling model.shared_models.stg_payment
[0m11:13:33.507132 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_payment"
[0m11:13:33.515921 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:33.517978 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_payment
[0m11:13:33.523245 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_payment"
[0m11:13:33.533238 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:13:33.535109 [debug] [Thread-1 (]: On model.shared_models.stg_payment: BEGIN
[0m11:13:33.537108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:38.606309 [debug] [Thread-1 (]: SQL status: BEGIN in 5.07 seconds
[0m11:13:38.610030 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:13:38.612399 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */

  create view "postgres"."public"."stg_payment__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m11:13:38.643038 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m11:13:38.646714 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:13:38.648883 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */
alter table "postgres"."public"."stg_payment" rename to "stg_payment__dbt_backup"
[0m11:13:38.652880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:13:38.655915 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:13:38.659344 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */
alter table "postgres"."public"."stg_payment__dbt_tmp" rename to "stg_payment"
[0m11:13:38.663620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:13:38.666059 [debug] [Thread-1 (]: On model.shared_models.stg_payment: COMMIT
[0m11:13:38.667658 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:13:38.669185 [debug] [Thread-1 (]: On model.shared_models.stg_payment: COMMIT
[0m11:13:38.695901 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:13:38.699427 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:13:38.701185 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */
drop view if exists "postgres"."public"."stg_payment__dbt_backup" cascade
[0m11:13:38.709931 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m11:13:38.712939 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:38.714168 [debug] [Thread-1 (]: On model.shared_models.stg_payment: Close
[0m11:13:38.715691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328dbab-7bf6-4b71-9d32-1c367f2c385a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94af90f0>]}
[0m11:13:38.721987 [info ] [Thread-1 (]: 4 of 26 OK created sql view model public.stg_payment ........................... [[32mCREATE VIEW[0m in 5.22s]
[0m11:13:38.723614 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_payment
[0m11:13:38.725370 [debug] [Thread-1 (]: Began running node model.shared_models.stg_rental
[0m11:13:38.727536 [info ] [Thread-1 (]: 5 of 26 START sql view model public.stg_rental ................................. [RUN]
[0m11:13:38.729135 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_rental"
[0m11:13:38.735529 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_rental
[0m11:13:38.737000 [debug] [Thread-1 (]: Compiling model.shared_models.stg_rental
[0m11:13:38.740374 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_rental"
[0m11:13:38.752045 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:38.753895 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_rental
[0m11:13:38.757914 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_rental"
[0m11:13:38.762252 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:13:38.763566 [debug] [Thread-1 (]: On model.shared_models.stg_rental: BEGIN
[0m11:13:38.764846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:38.790710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:38.793728 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:13:38.795672 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */

  create view "postgres"."public"."stg_rental__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."rental"
  );
[0m11:13:38.825698 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m11:13:38.830930 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:13:38.833317 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */
alter table "postgres"."public"."stg_rental" rename to "stg_rental__dbt_backup"
[0m11:13:38.837475 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:13:38.841630 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:13:38.843222 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */
alter table "postgres"."public"."stg_rental__dbt_tmp" rename to "stg_rental"
[0m11:13:38.846293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:13:38.871265 [debug] [Thread-1 (]: On model.shared_models.stg_rental: COMMIT
[0m11:13:38.873017 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:13:38.875042 [debug] [Thread-1 (]: On model.shared_models.stg_rental: COMMIT
[0m11:13:38.879591 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:13:38.884141 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:13:38.885466 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */
drop view if exists "postgres"."public"."stg_rental__dbt_backup" cascade
[0m11:13:38.893844 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m11:13:38.895891 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:38.901575 [debug] [Thread-1 (]: On model.shared_models.stg_rental: Close
[0m11:13:38.903507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328dbab-7bf6-4b71-9d32-1c367f2c385a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941f4250>]}
[0m11:13:38.905015 [info ] [Thread-1 (]: 5 of 26 OK created sql view model public.stg_rental ............................ [[32mCREATE VIEW[0m in 0.17s]
[0m11:13:38.907031 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_rental
[0m11:13:38.908634 [debug] [Thread-1 (]: Began running node seed.customer.customer_base
[0m11:13:38.914791 [info ] [Thread-1 (]: 6 of 26 START seed file public.customer_base ................................... [RUN]
[0m11:13:38.916902 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.customer.customer_base"
[0m11:13:38.918081 [debug] [Thread-1 (]: Began compiling node seed.customer.customer_base
[0m11:13:38.919642 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:38.921220 [debug] [Thread-1 (]: Began executing node seed.customer.customer_base
[0m11:13:38.966534 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m11:13:38.969050 [debug] [Thread-1 (]: On seed.customer.customer_base: BEGIN
[0m11:13:38.970996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:38.997971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:39.000180 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m11:13:39.001666 [debug] [Thread-1 (]: On seed.customer.customer_base: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "seed.customer.customer_base"} */
truncate table "postgres"."public"."customer_base"
[0m11:13:39.017875 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.01 seconds
[0m11:13:39.542123 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m11:13:39.546445 [debug] [Thread-1 (]: On seed.customer.customer_base: 
          insert into "postgres"."public"."customer_base" ("customer_id", "store_id", "first_name", "last_name", "email", "address_id", "activebool", "create_date", "last_update", "active") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,...
[0m11:13:39.602328 [debug] [Thread-1 (]: SQL status: INSERT 0 599 in 0.05 seconds
[0m11:13:39.608479 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.customer.customer_base"
[0m11:13:39.617440 [debug] [Thread-1 (]: On seed.customer.customer_base: COMMIT
[0m11:13:39.619601 [debug] [Thread-1 (]: Using postgres connection "seed.customer.customer_base"
[0m11:13:39.643967 [debug] [Thread-1 (]: On seed.customer.customer_base: COMMIT
[0m11:13:39.650792 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:13:39.653087 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:39.654706 [debug] [Thread-1 (]: On seed.customer.customer_base: Close
[0m11:13:39.656783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328dbab-7bf6-4b71-9d32-1c367f2c385a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9420feb0>]}
[0m11:13:39.658260 [info ] [Thread-1 (]: 6 of 26 OK loaded seed file public.customer_base ............................... [[32mINSERT 599[0m in 0.74s]
[0m11:13:39.660009 [debug] [Thread-1 (]: Finished running node seed.customer.customer_base
[0m11:13:39.666268 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m11:13:39.668782 [info ] [Thread-1 (]: 7 of 26 START test not_null_stg_category_category_id ........................... [RUN]
[0m11:13:39.670589 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m11:13:39.672020 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m11:13:39.678517 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m11:13:39.687569 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m11:13:39.692901 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:39.700923 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m11:13:39.709300 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m11:13:39.714457 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m11:13:39.715975 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: BEGIN
[0m11:13:39.717305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:39.743453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:39.745679 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_category_category_id.d4eb91c268"
[0m11:13:39.748931 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_category_category_id.d4eb91c268"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select category_id
from "postgres"."public"."stg_category"
where category_id is null



      
    ) dbt_internal_test
[0m11:13:39.776006 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:13:39.780135 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:39.781611 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: ROLLBACK
[0m11:13:39.785452 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_category_category_id.d4eb91c268: Close
[0m11:13:39.787667 [info ] [Thread-1 (]: 7 of 26 PASS not_null_stg_category_category_id ................................. [[32mPASS[0m in 0.12s]
[0m11:13:39.789442 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_category_category_id.d4eb91c268
[0m11:13:39.791337 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m11:13:39.792686 [info ] [Thread-1 (]: 8 of 26 START test unique_stg_category_category_id ............................. [RUN]
[0m11:13:39.818400 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m11:13:39.820536 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m11:13:39.822935 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m11:13:39.828766 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m11:13:39.834114 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:39.835835 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m11:13:39.843950 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m11:13:39.848973 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m11:13:39.855067 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: BEGIN
[0m11:13:39.857372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:39.883277 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:39.886185 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"
[0m11:13:39.894541 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_category_category_id.4d4b5eefa8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    category_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_category"
where category_id is not null
group by category_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:13:39.926468 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:13:39.929390 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:39.932011 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: ROLLBACK
[0m11:13:39.935177 [debug] [Thread-1 (]: On test.shared_models.unique_stg_category_category_id.4d4b5eefa8: Close
[0m11:13:39.937380 [info ] [Thread-1 (]: 8 of 26 PASS unique_stg_category_category_id ................................... [[32mPASS[0m in 0.12s]
[0m11:13:39.941538 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_category_category_id.4d4b5eefa8
[0m11:13:39.944181 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m11:13:39.945668 [info ] [Thread-1 (]: 9 of 26 START test not_null_stg_customer_customer_id ........................... [RUN]
[0m11:13:39.948107 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m11:13:39.951540 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m11:13:39.953022 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m11:13:39.957307 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m11:13:39.964968 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:39.966369 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m11:13:39.968999 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m11:13:39.998063 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m11:13:40.000166 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: BEGIN
[0m11:13:40.002301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:40.028533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:40.030942 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"
[0m11:13:40.032479 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_customer_customer_id.4721d3b88d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_customer"
where customer_id is null



      
    ) dbt_internal_test
[0m11:13:40.064376 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:13:40.067442 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:40.069402 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: ROLLBACK
[0m11:13:40.073606 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_customer_customer_id.4721d3b88d: Close
[0m11:13:40.075395 [info ] [Thread-1 (]: 9 of 26 PASS not_null_stg_customer_customer_id ................................. [[32mPASS[0m in 0.13s]
[0m11:13:40.082180 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_customer_customer_id.4721d3b88d
[0m11:13:40.083565 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m11:13:40.084979 [info ] [Thread-1 (]: 10 of 26 START test unique_stg_customer_customer_id ............................ [RUN]
[0m11:13:40.087127 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m11:13:40.094921 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m11:13:40.096593 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m11:13:40.101452 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m11:13:40.106861 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:40.108283 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m11:13:40.111081 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m11:13:40.117977 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m11:13:40.119778 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: BEGIN
[0m11:13:40.121420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:40.148195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:40.150579 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_customer_customer_id.310773d0ea"
[0m11:13:40.153845 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_customer_customer_id.310773d0ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:13:40.187380 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:13:40.190073 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:40.192048 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: ROLLBACK
[0m11:13:40.195650 [debug] [Thread-1 (]: On test.shared_models.unique_stg_customer_customer_id.310773d0ea: Close
[0m11:13:40.220269 [info ] [Thread-1 (]: 10 of 26 PASS unique_stg_customer_customer_id .................................. [[32mPASS[0m in 0.13s]
[0m11:13:40.222363 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_customer_customer_id.310773d0ea
[0m11:13:40.224314 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m11:13:40.226711 [info ] [Thread-1 (]: 11 of 26 START test not_null_stg_film_film_id .................................. [RUN]
[0m11:13:40.231174 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m11:13:40.233147 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m11:13:40.234791 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m11:13:40.243527 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m11:13:40.249522 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:40.255968 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m11:13:40.259032 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m11:13:40.270025 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m11:13:40.271717 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: BEGIN
[0m11:13:40.273316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:40.298702 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:40.300293 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"
[0m11:13:40.301855 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_film_film_id.c3f192e5f8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select film_id
from "postgres"."public"."stg_film"
where film_id is null



      
    ) dbt_internal_test
[0m11:13:40.331237 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:13:40.334255 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:40.336158 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: ROLLBACK
[0m11:13:40.341057 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_film_film_id.c3f192e5f8: Close
[0m11:13:40.343388 [info ] [Thread-1 (]: 11 of 26 PASS not_null_stg_film_film_id ........................................ [[32mPASS[0m in 0.11s]
[0m11:13:40.346675 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_film_film_id.c3f192e5f8
[0m11:13:40.356363 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m11:13:40.367541 [info ] [Thread-1 (]: 12 of 26 START test unique_stg_film_film_id .................................... [RUN]
[0m11:13:40.379045 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m11:13:40.382908 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m11:13:40.386183 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m11:13:40.390474 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m11:13:40.419903 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:40.422059 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m11:13:40.425166 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m11:13:40.429556 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m11:13:40.436046 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: BEGIN
[0m11:13:40.437949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:40.463376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:40.465940 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_film_film_id.1cbe88695a"
[0m11:13:40.467447 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_film_film_id.1cbe88695a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    film_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_film"
where film_id is not null
group by film_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:13:40.507936 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:13:40.511005 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:40.512356 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: ROLLBACK
[0m11:13:40.514329 [debug] [Thread-1 (]: On test.shared_models.unique_stg_film_film_id.1cbe88695a: Close
[0m11:13:40.522683 [info ] [Thread-1 (]: 12 of 26 PASS unique_stg_film_film_id .......................................... [[32mPASS[0m in 0.14s]
[0m11:13:40.525279 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_film_film_id.1cbe88695a
[0m11:13:40.527643 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m11:13:40.529318 [info ] [Thread-1 (]: 13 of 26 START test not_null_stg_payment_customer_id ........................... [RUN]
[0m11:13:40.531372 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m11:13:40.532781 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m11:13:40.534334 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m11:13:40.538877 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m11:13:40.545725 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:40.547276 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m11:13:40.550075 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m11:13:40.555814 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m11:13:40.557452 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: BEGIN
[0m11:13:40.558784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:40.585663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:40.587692 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m11:13:40.589560 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_payment"
where customer_id is null



      
    ) dbt_internal_test
[0m11:13:40.618897 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:13:40.621965 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:40.624324 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: ROLLBACK
[0m11:13:40.627223 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: Close
[0m11:13:40.628996 [info ] [Thread-1 (]: 13 of 26 PASS not_null_stg_payment_customer_id ................................. [[32mPASS[0m in 0.10s]
[0m11:13:40.635996 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m11:13:40.637552 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m11:13:40.639121 [info ] [Thread-1 (]: 14 of 26 START test not_null_stg_payment_payment_id ............................ [RUN]
[0m11:13:40.641390 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m11:13:40.642950 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m11:13:40.644222 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m11:13:40.654767 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m11:13:40.659836 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:40.668155 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m11:13:40.670943 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m11:13:40.675547 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m11:13:40.677203 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: BEGIN
[0m11:13:40.679062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:40.705248 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:40.707385 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m11:13:40.711188 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payment"
where payment_id is null



      
    ) dbt_internal_test
[0m11:13:40.739208 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:13:40.742118 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:40.745512 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: ROLLBACK
[0m11:13:40.748692 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: Close
[0m11:13:40.752149 [info ] [Thread-1 (]: 14 of 26 PASS not_null_stg_payment_payment_id .................................. [[32mPASS[0m in 0.11s]
[0m11:13:40.754339 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m11:13:40.756630 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m11:13:40.758461 [info ] [Thread-1 (]: 15 of 26 START test unique_stg_payment_payment_id .............................. [RUN]
[0m11:13:40.760685 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m11:13:40.785501 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m11:13:40.787220 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m11:13:40.791949 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m11:13:40.796980 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:40.798985 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m11:13:40.806947 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m11:13:40.811641 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m11:13:40.817653 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: BEGIN
[0m11:13:40.819131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:40.844858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:40.847170 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m11:13:40.848769 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_payment_payment_id.7398e70184"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payment"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:13:40.932722 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.08 seconds
[0m11:13:40.936960 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:40.939153 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: ROLLBACK
[0m11:13:40.942570 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: Close
[0m11:13:40.944417 [info ] [Thread-1 (]: 15 of 26 PASS unique_stg_payment_payment_id .................................... [[32mPASS[0m in 0.18s]
[0m11:13:40.946888 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m11:13:40.948924 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m11:13:40.950709 [info ] [Thread-1 (]: 16 of 26 START test not_null_stg_rental_rental_id .............................. [RUN]
[0m11:13:40.953088 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m11:13:40.956252 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m11:13:40.957953 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m11:13:40.962059 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m11:13:40.968698 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:40.971041 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m11:13:40.973700 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m11:13:41.001472 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m11:13:41.003158 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: BEGIN
[0m11:13:41.005057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:41.031719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:41.089953 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m11:13:41.091657 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rental_id
from "postgres"."public"."stg_rental"
where rental_id is null



      
    ) dbt_internal_test
[0m11:13:41.117918 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:13:41.120459 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:41.122136 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: ROLLBACK
[0m11:13:41.124646 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: Close
[0m11:13:41.126364 [info ] [Thread-1 (]: 16 of 26 PASS not_null_stg_rental_rental_id .................................... [[32mPASS[0m in 0.17s]
[0m11:13:41.136395 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m11:13:41.138271 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m11:13:41.140042 [info ] [Thread-1 (]: 17 of 26 START test unique_stg_rental_rental_id ................................ [RUN]
[0m11:13:41.142503 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m11:13:41.144160 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m11:13:41.153219 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_rental_rental_id.b263207352
[0m11:13:41.157849 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m11:13:41.163388 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:41.165657 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m11:13:41.170046 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m11:13:41.176217 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m11:13:41.178077 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: BEGIN
[0m11:13:41.179529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:41.205346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:41.207816 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m11:13:41.211380 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_rental_rental_id.b263207352"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    rental_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_rental"
where rental_id is not null
group by rental_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:13:41.281156 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.07 seconds
[0m11:13:41.284818 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:41.286687 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: ROLLBACK
[0m11:13:41.291405 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: Close
[0m11:13:41.293804 [info ] [Thread-1 (]: 17 of 26 PASS unique_stg_rental_rental_id ...................................... [[32mPASS[0m in 0.15s]
[0m11:13:41.295536 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m11:13:41.297201 [debug] [Thread-1 (]: Began running node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m11:13:41.298970 [info ] [Thread-1 (]: 18 of 26 START test not_null_customer_base_customer_id ......................... [RUN]
[0m11:13:41.323323 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m11:13:41.325316 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m11:13:41.327044 [debug] [Thread-1 (]: Compiling test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m11:13:41.331576 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m11:13:41.337408 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:41.344040 [debug] [Thread-1 (]: Began executing node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m11:13:41.347085 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m11:13:41.351884 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m11:13:41.358201 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: BEGIN
[0m11:13:41.359838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:41.385710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:41.392184 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_customer_id.9682b15dfb"
[0m11:13:41.393620 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_customer_base_customer_id.9682b15dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."customer_base"
where customer_id is null



      
    ) dbt_internal_test
[0m11:13:41.422078 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:13:41.424853 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:41.428208 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: ROLLBACK
[0m11:13:41.430694 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_customer_id.9682b15dfb: Close
[0m11:13:41.432374 [info ] [Thread-1 (]: 18 of 26 PASS not_null_customer_base_customer_id ............................... [[32mPASS[0m in 0.11s]
[0m11:13:41.433879 [debug] [Thread-1 (]: Finished running node test.customer.not_null_customer_base_customer_id.9682b15dfb
[0m11:13:41.435362 [debug] [Thread-1 (]: Began running node test.customer.not_null_customer_base_store_id.e159464168
[0m11:13:41.436954 [info ] [Thread-1 (]: 19 of 26 START test not_null_customer_base_store_id ............................ [RUN]
[0m11:13:41.439048 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_customer_base_store_id.e159464168"
[0m11:13:41.442539 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_customer_base_store_id.e159464168
[0m11:13:41.444670 [debug] [Thread-1 (]: Compiling test.customer.not_null_customer_base_store_id.e159464168
[0m11:13:41.448462 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_customer_base_store_id.e159464168"
[0m11:13:41.454788 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:41.456659 [debug] [Thread-1 (]: Began executing node test.customer.not_null_customer_base_store_id.e159464168
[0m11:13:41.459328 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_customer_base_store_id.e159464168"
[0m11:13:41.486220 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_store_id.e159464168"
[0m11:13:41.488571 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: BEGIN
[0m11:13:41.490391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:41.517568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:41.519856 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_customer_base_store_id.e159464168"
[0m11:13:41.522045 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_customer_base_store_id.e159464168"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."customer_base"
where store_id is null



      
    ) dbt_internal_test
[0m11:13:41.545121 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:13:41.553914 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:41.557060 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: ROLLBACK
[0m11:13:41.559720 [debug] [Thread-1 (]: On test.customer.not_null_customer_base_store_id.e159464168: Close
[0m11:13:41.562405 [info ] [Thread-1 (]: 19 of 26 PASS not_null_customer_base_store_id .................................. [[32mPASS[0m in 0.12s]
[0m11:13:41.567877 [debug] [Thread-1 (]: Finished running node test.customer.not_null_customer_base_store_id.e159464168
[0m11:13:41.575951 [debug] [Thread-1 (]: Began running node model.shared_models.int_revenue_by_date
[0m11:13:41.578902 [info ] [Thread-1 (]: 20 of 26 START sql view model public.int_revenue_by_date ....................... [RUN]
[0m11:13:41.581596 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.int_revenue_by_date"
[0m11:13:41.583511 [debug] [Thread-1 (]: Began compiling node model.shared_models.int_revenue_by_date
[0m11:13:41.592096 [debug] [Thread-1 (]: Compiling model.shared_models.int_revenue_by_date
[0m11:13:41.595379 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.int_revenue_by_date"
[0m11:13:41.599897 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:41.601537 [debug] [Thread-1 (]: Began executing node model.shared_models.int_revenue_by_date
[0m11:13:41.605533 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.int_revenue_by_date"
[0m11:13:41.611451 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m11:13:41.614708 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: BEGIN
[0m11:13:41.615957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:41.642501 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:41.644950 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m11:13:41.647673 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    "postgres"."public"."stg_payment"
GROUP BY
    1
  );
[0m11:13:41.677054 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m11:13:41.681728 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m11:13:41.683596 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date__dbt_tmp" rename to "int_revenue_by_date"
[0m11:13:41.688466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:13:41.713022 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: COMMIT
[0m11:13:41.715063 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m11:13:41.716977 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: COMMIT
[0m11:13:41.720503 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:13:41.723205 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m11:13:41.724524 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.int_revenue_by_date"} */
drop view if exists "postgres"."public"."int_revenue_by_date__dbt_backup" cascade
[0m11:13:41.726972 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:13:41.728891 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:41.735273 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: Close
[0m11:13:41.737590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328dbab-7bf6-4b71-9d32-1c367f2c385a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97963ee0>]}
[0m11:13:41.739602 [info ] [Thread-1 (]: 20 of 26 OK created sql view model public.int_revenue_by_date .................. [[32mCREATE VIEW[0m in 0.16s]
[0m11:13:41.741545 [debug] [Thread-1 (]: Finished running node model.shared_models.int_revenue_by_date
[0m11:13:41.750815 [debug] [Thread-1 (]: Began running node model.customer.int_customers_per_store
[0m11:13:41.753500 [info ] [Thread-1 (]: 21 of 26 START sql view model public.int_customers_per_store ................... [RUN]
[0m11:13:41.755898 [debug] [Thread-1 (]: Acquiring new postgres connection "model.customer.int_customers_per_store"
[0m11:13:41.763638 [debug] [Thread-1 (]: Began compiling node model.customer.int_customers_per_store
[0m11:13:41.765408 [debug] [Thread-1 (]: Compiling model.customer.int_customers_per_store
[0m11:13:41.769003 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer.int_customers_per_store"
[0m11:13:41.773252 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:41.774549 [debug] [Thread-1 (]: Began executing node model.customer.int_customers_per_store
[0m11:13:41.778719 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer.int_customers_per_store"
[0m11:13:41.785425 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m11:13:41.787573 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: BEGIN
[0m11:13:41.789881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:41.822103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:41.825024 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m11:13:41.826868 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */

  create view "postgres"."public"."int_customers_per_store__dbt_tmp" as (
    SELECT
    store_id,
    COUNT(*) AS total_customers
FROM
    "postgres"."public"."customer_base"
GROUP BY
    1
  );
[0m11:13:41.879568 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m11:13:41.883180 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m11:13:41.885002 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store" rename to "int_customers_per_store__dbt_backup"
[0m11:13:41.888274 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:13:41.891651 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m11:13:41.898263 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */
alter table "postgres"."public"."int_customers_per_store__dbt_tmp" rename to "int_customers_per_store"
[0m11:13:41.901792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:13:41.904344 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: COMMIT
[0m11:13:41.905902 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m11:13:41.907230 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: COMMIT
[0m11:13:41.916306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:13:41.919106 [debug] [Thread-1 (]: Using postgres connection "model.customer.int_customers_per_store"
[0m11:13:41.921140 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.int_customers_per_store"} */
drop view if exists "postgres"."public"."int_customers_per_store__dbt_backup" cascade
[0m11:13:41.928485 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m11:13:41.930810 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:41.938566 [debug] [Thread-1 (]: On model.customer.int_customers_per_store: Close
[0m11:13:41.940683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328dbab-7bf6-4b71-9d32-1c367f2c385a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9797d270>]}
[0m11:13:41.944074 [info ] [Thread-1 (]: 21 of 26 OK created sql view model public.int_customers_per_store .............. [[32mCREATE VIEW[0m in 0.19s]
[0m11:13:41.946211 [debug] [Thread-1 (]: Finished running node model.customer.int_customers_per_store
[0m11:13:41.947665 [debug] [Thread-1 (]: Began running node model.customer.cumulative_revenue
[0m11:13:41.949323 [info ] [Thread-1 (]: 22 of 26 START sql table model public.cumulative_revenue ....................... [RUN]
[0m11:13:41.951267 [debug] [Thread-1 (]: Acquiring new postgres connection "model.customer.cumulative_revenue"
[0m11:13:41.952999 [debug] [Thread-1 (]: Began compiling node model.customer.cumulative_revenue
[0m11:13:41.954582 [debug] [Thread-1 (]: Compiling model.customer.cumulative_revenue
[0m11:13:41.959974 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer.cumulative_revenue"
[0m11:13:41.964724 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:41.966511 [debug] [Thread-1 (]: Began executing node model.customer.cumulative_revenue
[0m11:13:41.981465 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer.cumulative_revenue"
[0m11:13:41.986814 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:13:41.988434 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: BEGIN
[0m11:13:42.013189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:42.039344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:42.041671 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:13:42.043445 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */

  
    

  create  table "postgres"."public"."cumulative_revenue__dbt_tmp"
  as (
    

SELECT
    payment_date,
    amount,
    SUM(amount) OVER (ORDER BY payment_date)
FROM
    "postgres"."public"."int_revenue_by_date"
ORDER BY
    payment_date
  );
  
[0m11:13:42.136224 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.09 seconds
[0m11:13:42.140054 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:13:42.141563 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue" rename to "cumulative_revenue__dbt_backup"
[0m11:13:42.149508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:13:42.152372 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:13:42.154148 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue__dbt_tmp" rename to "cumulative_revenue"
[0m11:13:42.157490 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:13:42.162439 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: COMMIT
[0m11:13:42.169112 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:13:42.170871 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: COMMIT
[0m11:13:42.174829 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:13:42.177465 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:13:42.179228 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
drop table if exists "postgres"."public"."cumulative_revenue__dbt_backup" cascade
[0m11:13:42.194459 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m11:13:42.197455 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:42.199012 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: Close
[0m11:13:42.201057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328dbab-7bf6-4b71-9d32-1c367f2c385a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b2a2c0>]}
[0m11:13:42.203058 [info ] [Thread-1 (]: 22 of 26 OK created sql table model public.cumulative_revenue .................. [[32mSELECT 40[0m in 0.25s]
[0m11:13:42.205413 [debug] [Thread-1 (]: Finished running node model.customer.cumulative_revenue
[0m11:13:42.207122 [debug] [Thread-1 (]: Began running node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m11:13:42.208497 [info ] [Thread-1 (]: 23 of 26 START test not_null_int_customers_per_store_store_id .................. [RUN]
[0m11:13:42.210147 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m11:13:42.211595 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m11:13:42.215421 [debug] [Thread-1 (]: Compiling test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m11:13:42.219527 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m11:13:42.224672 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:42.229283 [debug] [Thread-1 (]: Began executing node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m11:13:42.232074 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m11:13:42.236907 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m11:13:42.263282 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: BEGIN
[0m11:13:42.265314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:42.294820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:42.296832 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"
[0m11:13:42.298203 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "postgres"."public"."int_customers_per_store"
where store_id is null



      
    ) dbt_internal_test
[0m11:13:42.324658 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.02 seconds
[0m11:13:42.329135 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:42.335571 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: ROLLBACK
[0m11:13:42.338752 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33: Close
[0m11:13:42.340644 [info ] [Thread-1 (]: 23 of 26 PASS not_null_int_customers_per_store_store_id ........................ [[32mPASS[0m in 0.13s]
[0m11:13:42.342652 [debug] [Thread-1 (]: Finished running node test.customer.not_null_int_customers_per_store_store_id.5a3a7c8c33
[0m11:13:42.344280 [debug] [Thread-1 (]: Began running node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m11:13:42.351535 [info ] [Thread-1 (]: 24 of 26 START test not_null_int_customers_per_store_total_customers ........... [RUN]
[0m11:13:42.353690 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m11:13:42.356142 [debug] [Thread-1 (]: Began compiling node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m11:13:42.357927 [debug] [Thread-1 (]: Compiling test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m11:13:42.362846 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m11:13:42.374563 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:42.376284 [debug] [Thread-1 (]: Began executing node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m11:13:42.380098 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m11:13:42.384991 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m11:13:42.386640 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: BEGIN
[0m11:13:42.390165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:42.415933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:42.417774 [debug] [Thread-1 (]: Using postgres connection "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"
[0m11:13:42.419376 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_customers
from "postgres"."public"."int_customers_per_store"
where total_customers is null



      
    ) dbt_internal_test
[0m11:13:42.446671 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:13:42.451665 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:42.454013 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: ROLLBACK
[0m11:13:42.457276 [debug] [Thread-1 (]: On test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc: Close
[0m11:13:42.458915 [info ] [Thread-1 (]: 24 of 26 PASS not_null_int_customers_per_store_total_customers ................. [[32mPASS[0m in 0.11s]
[0m11:13:42.460276 [debug] [Thread-1 (]: Finished running node test.customer.not_null_int_customers_per_store_total_customers.20721b6bcc
[0m11:13:42.486061 [debug] [Thread-1 (]: Began running node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m11:13:42.488121 [info ] [Thread-1 (]: 25 of 26 START test unique_int_customers_per_store_store_id .................... [RUN]
[0m11:13:42.490498 [debug] [Thread-1 (]: Acquiring new postgres connection "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m11:13:42.492633 [debug] [Thread-1 (]: Began compiling node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m11:13:42.494115 [debug] [Thread-1 (]: Compiling test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m11:13:42.498859 [debug] [Thread-1 (]: Writing injected SQL for node "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m11:13:42.509057 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:42.511276 [debug] [Thread-1 (]: Began executing node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m11:13:42.514073 [debug] [Thread-1 (]: Writing runtime sql for node "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m11:13:42.522665 [debug] [Thread-1 (]: Using postgres connection "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m11:13:42.524371 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: BEGIN
[0m11:13:42.526210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:42.551662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:13:42.560239 [debug] [Thread-1 (]: Using postgres connection "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"
[0m11:13:42.562223 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.customer.unique_int_customers_per_store_store_id.b975e6cb6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "postgres"."public"."int_customers_per_store"
where store_id is not null
group by store_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:13:42.592413 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:13:42.595272 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:42.597373 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: ROLLBACK
[0m11:13:42.601534 [debug] [Thread-1 (]: On test.customer.unique_int_customers_per_store_store_id.b975e6cb6d: Close
[0m11:13:42.604202 [info ] [Thread-1 (]: 25 of 26 PASS unique_int_customers_per_store_store_id .......................... [[32mPASS[0m in 0.11s]
[0m11:13:42.605943 [debug] [Thread-1 (]: Finished running node test.customer.unique_int_customers_per_store_store_id.b975e6cb6d
[0m11:13:42.607473 [debug] [Thread-1 (]: Began running node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m11:13:42.608652 [info ] [Thread-1 (]: 26 of 26 START snapshot public.int_stock_balances_daily_grouped_by_day_snapshot  [RUN]
[0m11:13:42.613103 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:13:42.615144 [debug] [Thread-1 (]: Began compiling node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m11:13:42.617388 [debug] [Thread-1 (]: Compiling snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m11:13:42.621663 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:42.623669 [debug] [Thread-1 (]: Began executing node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m11:13:42.651677 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:13:42.654128 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */
select * from (
            select total_customers from (

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"
) subq
        ) as __dbt_sbq
        where false
        limit 0
    
[0m11:13:42.657012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:42.697023 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.04 seconds
[0m11:13:42.703304 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:13:42.727134 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: BEGIN
[0m11:13:42.730075 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:13:42.732157 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:13:42.734146 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:13:42.804944 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.07 seconds
[0m11:13:42.812600 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:13:42.818995 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:13:42.835875 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m11:13:42.845844 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:13:42.847528 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

        
  
    

  create temporary table "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp111342842271"
  as (
    with snapshot_query as (

        

    

    SELECT
        store_id,
        total_customers,
        CURRENT_DATE
    FROM
        "postgres"."public"."int_customers_per_store"


    ),

    snapshotted_data as (

        select *,
            store_id as dbt_unique_key

        from "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            nullif(now()::timestamp without time zone, now()::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(store_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            store_id as dbt_unique_key,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            store_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."total_customers" != source_data."total_customers"
        or
        (
            ((snapshotted_data."total_customers" is null) and not (source_data."total_customers" is null))
            or
            ((not snapshotted_data."total_customers" is null) and (source_data."total_customers" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

  );
  
    
[0m11:13:42.889439 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.03 seconds
[0m11:13:42.893996 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:13:42.910942 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp111342842271'
        
      order by ordinal_position

  
[0m11:13:42.947701 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.02 seconds
[0m11:13:42.968585 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:13:42.970434 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:13:42.986192 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m11:13:42.990327 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:13:42.992038 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp111342842271'
        
      order by ordinal_position

  
[0m11:13:43.008375 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.01 seconds
[0m11:13:43.012399 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:13:43.013992 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:13:43.031602 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.01 seconds
[0m11:13:43.039885 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:13:43.041849 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_stock_balances_daily_grouped_by_day_sn__dbt_tmp111342842271'
        
      order by ordinal_position

  
[0m11:13:43.057225 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.01 seconds
[0m11:13:43.062909 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:13:43.070099 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:13:43.071572 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"} */

      update "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp111342842271" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot".dbt_valid_to is null;

    insert into "postgres"."public"."int_stock_balances_daily_grouped_by_day_snapshot" ("store_id", "total_customers", "current_date", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."store_id",DBT_INTERNAL_SOURCE."total_customers",DBT_INTERNAL_SOURCE."current_date",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "int_stock_balances_daily_grouped_by_day_sn__dbt_tmp111342842271" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m11:13:43.079651 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.01 seconds
[0m11:13:43.104383 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m11:13:43.106616 [debug] [Thread-1 (]: Using postgres connection "snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot"
[0m11:13:43.108860 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: COMMIT
[0m11:13:43.113449 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:13:43.116758 [debug] [Thread-1 (]: finished collecting timing info
[0m11:13:43.118512 [debug] [Thread-1 (]: On snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot: Close
[0m11:13:43.120250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328dbab-7bf6-4b71-9d32-1c367f2c385a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94af3700>]}
[0m11:13:43.122149 [info ] [Thread-1 (]: 26 of 26 OK snapshotted public.int_stock_balances_daily_grouped_by_day_snapshot  [[32mINSERT 0 0[0m in 0.51s]
[0m11:13:43.128288 [debug] [Thread-1 (]: Finished running node snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot
[0m11:13:43.131159 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:13:43.132981 [debug] [MainThread]: Using postgres connection "master"
[0m11:13:43.134779 [debug] [MainThread]: On master: BEGIN
[0m11:13:43.136146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:13:43.167956 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m11:13:43.170453 [debug] [MainThread]: On master: COMMIT
[0m11:13:43.172186 [debug] [MainThread]: Using postgres connection "master"
[0m11:13:43.173959 [debug] [MainThread]: On master: COMMIT
[0m11:13:43.175991 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:13:43.183188 [debug] [MainThread]: On master: Close
[0m11:13:43.185277 [info ] [MainThread]: 
[0m11:13:43.187627 [info ] [MainThread]: Finished running 7 view models, 1 seed, 16 tests, 1 table model, 1 snapshot in 0 hours 0 minutes and 15.71 seconds (15.71s).
[0m11:13:43.189257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:43.190716 [debug] [MainThread]: Connection 'snapshot.customer.int_stock_balances_daily_grouped_by_day_snapshot' was properly closed.
[0m11:13:43.254451 [info ] [MainThread]: 
[0m11:13:43.256260 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:43.258172 [info ] [MainThread]: 
[0m11:13:43.267003 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=0 SKIP=0 TOTAL=26
[0m11:13:43.268948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940ddbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940dca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940ded10>]}
[0m11:13:43.270586 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 11:13:51.642979 | 6615bc14-f1a2-41d1-9537-b037009794d1 ==============================
[0m11:13:51.642991 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:13:51.643909 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m11:13:51.645378 [debug] [MainThread]: Tracking: tracking
[0m11:13:51.648038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b99c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b99d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b99cc0>]}
[0m11:13:52.693557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b9a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b99fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b99ed0>]}
[0m11:13:52.695163 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 11:13:56.985851 | 6e0b1520-0b98-4860-98bb-74dd530097b0 ==============================
[0m11:13:56.985864 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:13:56.986777 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m11:13:56.989008 [debug] [MainThread]: Tracking: tracking
[0m11:13:56.991943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ce1e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ce1f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ce1f00>]}
[0m11:13:57.004081 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hg4g_30x'
[0m11:13:57.005907 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:13:57.606556 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:13:57.613168 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:13:58.151030 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:13:58.212125 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:14:02.572820 [info ] [MainThread]:   Installed from version 1.0.0
[0m11:14:02.574948 [info ] [MainThread]:   Up to date!
[0m11:14:02.576861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6e0b1520-0b98-4860-98bb-74dd530097b0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ce2080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ce25f0>]}
[0m11:14:02.579097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e9c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ce2740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ce1540>]}
[0m11:14:02.585513 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 11:14:06.845091 | e039d253-6b64-4942-8a95-7ed1c72b8fd6 ==============================
[0m11:14:06.845102 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:14:06.846228 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:14:06.848659 [debug] [MainThread]: Tracking: tracking
[0m11:14:06.853562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff932f3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fc6aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fc7c10>]}
[0m11:14:06.878296 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:14:06.902845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e039d253-6b64-4942-8a95-7ed1c72b8fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fe1420>]}
[0m11:14:07.183817 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m11:14:07.186754 [debug] [MainThread]: Parsing macros/relations.sql
[0m11:14:07.213131 [debug] [MainThread]: Parsing macros/adapters.sql
[0m11:14:07.228341 [debug] [MainThread]: Parsing macros/catalog.sql
[0m11:14:07.231558 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:14:07.234014 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:14:07.236953 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:14:07.242014 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:14:07.244280 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:14:07.246319 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:14:07.254158 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m11:14:07.256293 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m11:14:07.258780 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:14:07.263431 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:14:07.265382 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:14:07.271740 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:14:07.274188 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:14:07.276047 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:14:07.278154 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:14:07.280429 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:14:07.288682 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:14:07.292194 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:14:07.295066 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:14:07.299162 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:14:07.305233 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:14:07.307960 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:14:07.311073 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:14:07.313162 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:14:07.318275 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:14:07.320550 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:14:07.322469 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:14:07.324321 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:14:07.326662 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:14:07.330966 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:14:07.333226 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:14:07.335326 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:14:07.337549 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:14:07.339553 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:14:07.372593 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:14:07.375453 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:14:07.381681 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:14:07.384957 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:14:07.387835 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:14:07.401811 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:14:07.406262 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:14:07.416639 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:14:07.420478 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:14:07.423605 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:14:07.425910 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:14:07.427977 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:14:07.437689 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m11:14:07.442913 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:14:07.445356 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:14:07.448634 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:14:07.456039 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:14:07.458255 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:14:07.467046 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:14:07.475826 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:14:07.480156 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:14:07.483166 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:14:07.487127 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:14:07.493317 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:14:07.502019 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:14:07.506935 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:14:07.515890 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:14:07.521167 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:14:07.524038 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:14:07.528481 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:14:07.531171 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:14:07.533070 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:14:07.557616 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:14:07.561477 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:14:07.564198 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:14:07.569118 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:14:07.579589 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:14:07.581681 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:14:07.583235 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:14:07.585022 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:14:07.591184 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m11:14:07.593961 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m11:14:07.597009 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m11:14:07.600487 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m11:14:07.603307 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m11:14:07.612265 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m11:14:07.615565 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m11:14:07.617712 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m11:14:07.621388 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m11:14:07.627156 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m11:14:07.636180 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m11:14:07.638805 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m11:14:07.641295 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m11:14:07.644894 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m11:14:07.648080 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m11:14:07.650427 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m11:14:07.653680 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m11:14:07.656506 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m11:14:07.658755 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m11:14:07.660805 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m11:14:07.662735 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m11:14:07.665657 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m11:14:07.668630 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m11:14:07.670488 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m11:14:07.674033 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m11:14:07.677542 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m11:14:07.681185 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m11:14:07.683920 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m11:14:07.688057 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m11:14:07.690737 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m11:14:07.715487 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m11:14:07.719377 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m11:14:07.722843 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m11:14:07.726342 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m11:14:07.728360 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m11:14:07.733510 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m11:14:07.735500 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m11:14:07.737549 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m11:14:07.746960 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m11:14:07.749287 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m11:14:07.751664 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m11:14:07.755256 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m11:14:07.758041 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m11:14:07.764739 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m11:14:07.769107 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m11:14:07.771014 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m11:14:07.778046 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m11:14:07.782205 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m11:14:07.792187 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m11:14:07.794513 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m11:14:07.796530 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m11:14:07.946602 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m11:14:07.954959 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m11:14:07.994839 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m11:14:08.001863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f9bdb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb20f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb21c30>]}
[0m11:14:08.003659 [debug] [MainThread]: Flushing usage events
[0m11:14:08.691087 [error] [MainThread]: Encountered an error:
Compilation Error in model cumulative_revenue (models/marts/cumulative_revenue.sql)
  Model 'model.customer.cumulative_revenue' (models/marts/cumulative_revenue.sql) depends on a node named 'int_revenue_by_date' which was not found


============================== 2023-02-21 11:16:07.752150 | 89568c84-4cc5-4128-b71b-d725a59debb7 ==============================
[0m11:16:07.752163 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:16:07.754146 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['cumulative_revenue.sql'], 'which': 'build', 'rpc_method': 'build'}
[0m11:16:07.756830 [debug] [MainThread]: Tracking: tracking
[0m11:16:07.760585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dca2830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dca2740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dca27a0>]}
[0m11:16:07.785261 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:16:07.787087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '89568c84-4cc5-4128-b71b-d725a59debb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dcbdba0>]}
[0m11:16:07.946870 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m11:16:07.950006 [debug] [MainThread]: Parsing macros/relations.sql
[0m11:16:07.952604 [debug] [MainThread]: Parsing macros/adapters.sql
[0m11:16:07.966531 [debug] [MainThread]: Parsing macros/catalog.sql
[0m11:16:07.971253 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:16:07.973022 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:16:07.975195 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:16:07.980115 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:16:07.982234 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:16:07.984085 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:16:07.989088 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m11:16:07.991321 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m11:16:07.993341 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:16:07.997533 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:16:07.999525 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:16:08.025378 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:16:08.028683 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:16:08.031016 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:16:08.033100 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:16:08.034909 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:16:08.036965 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:16:08.039001 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:16:08.041056 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:16:08.048886 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:16:08.053796 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:16:08.055754 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:16:08.057950 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:16:08.059872 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:16:08.066817 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:16:08.069141 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:16:08.070846 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:16:08.072956 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:16:08.075144 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:16:08.077518 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:16:08.084999 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:16:08.086936 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:16:08.088959 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:16:08.091533 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:16:08.098479 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:16:08.100668 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:16:08.105380 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:16:08.108977 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:16:08.111972 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:16:08.121155 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:16:08.123744 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:16:08.132502 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:16:08.135977 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:16:08.138558 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:16:08.140847 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:16:08.144928 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:16:08.149030 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m11:16:08.154588 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:16:08.156724 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:16:08.159861 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:16:08.189408 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:16:08.192299 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:16:08.203737 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:16:08.211871 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:16:08.216618 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:16:08.219728 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:16:08.222439 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:16:08.236678 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:16:08.246356 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:16:08.252261 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:16:08.262234 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:16:08.266892 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:16:08.274680 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:16:08.279396 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:16:08.282159 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:16:08.284058 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:16:08.286485 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:16:08.290017 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:16:08.296528 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:16:08.301690 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:16:08.312210 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:16:08.314428 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:16:08.316767 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:16:08.318687 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:16:08.320159 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m11:16:08.323161 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m11:16:08.325590 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m11:16:08.327982 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m11:16:08.332352 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m11:16:08.336390 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m11:16:08.339594 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m11:16:08.342615 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m11:16:08.346862 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m11:16:08.353561 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m11:16:08.356195 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m11:16:08.358432 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m11:16:08.361471 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m11:16:08.364819 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m11:16:08.388727 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m11:16:08.391319 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m11:16:08.395136 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m11:16:08.398274 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m11:16:08.400481 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m11:16:08.402549 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m11:16:08.404391 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m11:16:08.411019 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m11:16:08.413034 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m11:16:08.415288 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m11:16:08.418999 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m11:16:08.422203 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m11:16:08.425414 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m11:16:08.433151 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m11:16:08.438553 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m11:16:08.442075 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m11:16:08.444565 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m11:16:08.447529 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m11:16:08.456728 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m11:16:08.459788 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m11:16:08.462197 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m11:16:08.467106 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m11:16:08.469417 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m11:16:08.471625 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m11:16:08.475911 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m11:16:08.478356 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m11:16:08.480346 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m11:16:08.483591 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m11:16:08.486408 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m11:16:08.489463 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m11:16:08.493437 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m11:16:08.495961 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m11:16:08.504187 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m11:16:08.508454 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m11:16:08.514225 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m11:16:08.516720 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m11:16:08.518901 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m11:16:08.665167 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m11:16:08.695736 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m11:16:08.737675 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m11:16:08.741968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c895bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1591e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca1fac0>]}
[0m11:16:08.744144 [debug] [MainThread]: Flushing usage events
[0m11:16:09.574030 [error] [MainThread]: Encountered an error:
Compilation Error in model cumulative_revenue (models/marts/cumulative_revenue.sql)
  Model 'model.customer.cumulative_revenue' (models/marts/cumulative_revenue.sql) depends on a node named 'int_revenue_by_date' which was not found


============================== 2023-02-21 11:16:32.563105 | 68a4a077-0363-48f7-a94d-4e5a4707d6f8 ==============================
[0m11:16:32.563117 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:16:32.563950 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m11:16:32.566756 [debug] [MainThread]: Tracking: tracking
[0m11:16:32.570493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902bdf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902be020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902bdfc0>]}
[0m11:16:33.056761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902be380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902be140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902be650>]}
[0m11:16:33.058253 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 11:16:36.937462 | 2af784d0-5a74-43b0-b1a8-33668f1e1c7c ==============================
[0m11:16:36.937473 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:16:36.938324 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m11:16:36.940112 [debug] [MainThread]: Tracking: tracking
[0m11:16:36.948309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca59f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca5a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca59ff0>]}
[0m11:16:36.954310 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7m372quv'
[0m11:16:36.963020 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:16:37.496462 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:16:37.503635 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:16:37.992625 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:16:38.079323 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:16:42.381799 [info ] [MainThread]:   Installed from version 1.0.0
[0m11:16:42.384003 [info ] [MainThread]:   Up to date!
[0m11:16:42.385722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2af784d0-5a74-43b0-b1a8-33668f1e1c7c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cad0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cad0dc0>]}
[0m11:16:42.387415 [info ] [MainThread]: Installing ../shared_models
[0m11:16:42.394595 [debug] [MainThread]:   Creating symlink to local dependency.
[0m11:16:42.398639 [info ] [MainThread]:   Installed from <local @ ../shared_models>
[0m11:16:42.400168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2af784d0-5a74-43b0-b1a8-33668f1e1c7c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cad1480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cad0e80>]}
[0m11:16:42.409276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cad10c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cad0e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cad0e50>]}
[0m11:16:42.410961 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 11:16:47.780462 | ec6dd35e-1055-4fca-9db7-7d81a1ad6621 ==============================
[0m11:16:47.780472 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:16:47.781347 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['cumulative_revenue.sql'], 'which': 'build', 'rpc_method': 'build'}
[0m11:16:47.783383 [debug] [MainThread]: Tracking: tracking
[0m11:16:47.786238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb851a680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb851a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb851a5f0>]}
[0m11:16:47.844116 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:16:47.845976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ec6dd35e-1055-4fca-9db7-7d81a1ad6621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb85377c0>]}
[0m11:16:48.336797 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m11:16:48.344329 [debug] [MainThread]: Parsing macros/relations.sql
[0m11:16:48.346533 [debug] [MainThread]: Parsing macros/adapters.sql
[0m11:16:48.359054 [debug] [MainThread]: Parsing macros/catalog.sql
[0m11:16:48.361365 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:16:48.363319 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:16:48.370063 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:16:48.375385 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:16:48.377813 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:16:48.379748 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:16:48.381703 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m11:16:48.390025 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m11:16:48.392474 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:16:48.396962 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:16:48.399036 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:16:48.401671 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:16:48.404184 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:16:48.406039 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:16:48.407978 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:16:48.410105 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:16:48.412271 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:16:48.416029 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:16:48.418131 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:16:48.420997 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:16:48.425814 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:16:48.427599 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:16:48.431623 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:16:48.433815 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:16:48.436025 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:16:48.438215 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:16:48.440091 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:16:48.442026 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:16:48.466841 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:16:48.469696 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:16:48.472381 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:16:48.474433 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:16:48.476220 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:16:48.478376 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:16:48.484647 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:16:48.487464 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:16:48.497054 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:16:48.500484 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:16:48.503003 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:16:48.510597 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:16:48.513044 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:16:48.521916 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:16:48.526100 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:16:48.529307 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:16:48.531630 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:16:48.533563 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:16:48.537557 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m11:16:48.549774 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:16:48.552357 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:16:48.555353 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:16:48.562207 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:16:48.564388 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:16:48.572968 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:16:48.581219 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:16:48.585090 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:16:48.588085 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:16:48.590323 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:16:48.597014 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:16:48.606484 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:16:48.612627 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:16:48.622245 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:16:48.626830 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:16:48.631142 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:16:48.635461 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:16:48.638421 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:16:48.640441 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:16:48.642784 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:16:48.669120 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:16:48.671925 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:16:48.676920 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:16:48.687283 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:16:48.689550 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:16:48.691266 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:16:48.693031 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:16:48.694620 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m11:16:48.702095 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m11:16:48.705037 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m11:16:48.707218 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m11:16:48.709622 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m11:16:48.713324 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m11:16:48.720950 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m11:16:48.723063 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m11:16:48.727092 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m11:16:48.733044 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m11:16:48.735770 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m11:16:48.744960 [debug] [MainThread]: Parsing macros/generic_tests/not_empty_string.sql
[0m11:16:48.747772 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m11:16:48.750992 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m11:16:48.754179 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m11:16:48.756436 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m11:16:48.760296 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m11:16:48.763033 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m11:16:48.765967 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m11:16:48.767979 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m11:16:48.769934 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m11:16:48.772652 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m11:16:48.776478 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m11:16:48.779015 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m11:16:48.782302 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m11:16:48.785545 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m11:16:48.788753 [debug] [MainThread]: Parsing macros/sql/generate_surrogate_key.sql
[0m11:16:48.791389 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m11:16:48.795970 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m11:16:48.798483 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m11:16:48.802014 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m11:16:48.804834 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m11:16:48.830508 [debug] [MainThread]: Parsing macros/sql/get_single_value.sql
[0m11:16:48.833813 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m11:16:48.836404 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m11:16:48.841553 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m11:16:48.844315 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m11:16:48.846437 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m11:16:48.850417 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m11:16:48.852689 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m11:16:48.859900 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m11:16:48.863289 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m11:16:48.865563 [debug] [MainThread]: Parsing macros/sql/safe_divide.sql
[0m11:16:48.867503 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m11:16:48.871361 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m11:16:48.878595 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m11:16:48.886276 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m11:16:48.890458 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m11:16:48.894317 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m11:16:48.897030 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m11:16:48.898988 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m11:16:49.052255 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_customers_per_store.sql
[0m11:16:49.061527 [debug] [MainThread]: 1699: static parser successfully parsed marts/cumulative_revenue.sql
[0m11:16:49.094045 [debug] [MainThread]: 1699: static parser successfully parsed intermediate/int_revenue_by_date.sql
[0m11:16:49.097285 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_category.sql
[0m11:16:49.100471 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_customer.sql
[0m11:16:49.102994 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_film.sql
[0m11:16:49.106072 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payment.sql
[0m11:16:49.109285 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_rental.sql
[0m11:16:49.121313 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_customers_per_store_snapshot' in the 'snapshots' section of file 'snapshots/_snapshots.yml'
[0m11:16:49.173916 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.customer.not_null_int_customers_per_store_snapshot_total_customers.6745de9a0e' (snapshots/_snapshots.yml) depends on a node named 'int_customers_per_store_snapshot' which was not found
[0m11:16:49.251261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec6dd35e-1055-4fca-9db7-7d81a1ad6621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb83e1750>]}
[0m11:16:49.312419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec6dd35e-1055-4fca-9db7-7d81a1ad6621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb85355d0>]}
[0m11:16:49.316507 [info ] [MainThread]: Found 8 models, 16 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 5 sources, 0 exposures, 0 metrics
[0m11:16:49.322393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec6dd35e-1055-4fca-9db7-7d81a1ad6621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb844a1d0>]}
[0m11:16:49.335371 [info ] [MainThread]: 
[0m11:16:49.338478 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:16:49.346980 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:16:49.355060 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:16:49.358551 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:16:49.361022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:49.412025 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.05 seconds
[0m11:16:49.415442 [debug] [ThreadPool]: On list_postgres: Close
[0m11:16:49.418549 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m11:16:49.424035 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:16:49.432080 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m11:16:49.434382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:54.510086 [debug] [ThreadPool]: SQL status: BEGIN in 5.08 seconds
[0m11:16:54.514343 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:16:54.517170 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:16:54.569262 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.05 seconds
[0m11:16:54.574124 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:16:54.577428 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:16:54.582767 [debug] [MainThread]: Using postgres connection "master"
[0m11:16:54.585202 [debug] [MainThread]: On master: BEGIN
[0m11:16:54.610289 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:16:54.637573 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m11:16:54.639848 [debug] [MainThread]: Using postgres connection "master"
[0m11:16:54.642195 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:16:54.719691 [debug] [MainThread]: SQL status: SELECT 50 in 0.07 seconds
[0m11:16:54.723987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec6dd35e-1055-4fca-9db7-7d81a1ad6621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb83e2c20>]}
[0m11:16:54.726018 [debug] [MainThread]: On master: ROLLBACK
[0m11:16:54.734128 [debug] [MainThread]: Using postgres connection "master"
[0m11:16:54.735851 [debug] [MainThread]: On master: BEGIN
[0m11:16:54.738316 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:16:54.739902 [debug] [MainThread]: On master: COMMIT
[0m11:16:54.745785 [debug] [MainThread]: Using postgres connection "master"
[0m11:16:54.747547 [debug] [MainThread]: On master: COMMIT
[0m11:16:54.749505 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:16:54.750880 [debug] [MainThread]: On master: Close
[0m11:16:54.752627 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:16:54.760575 [info ] [MainThread]: 
[0m11:16:54.764684 [debug] [Thread-1 (]: Began running node model.customer.cumulative_revenue
[0m11:16:54.766956 [info ] [Thread-1 (]: 1 of 1 START sql table model public.cumulative_revenue ......................... [RUN]
[0m11:16:54.768368 [debug] [Thread-1 (]: Acquiring new postgres connection "model.customer.cumulative_revenue"
[0m11:16:54.769989 [debug] [Thread-1 (]: Began compiling node model.customer.cumulative_revenue
[0m11:16:54.771477 [debug] [Thread-1 (]: Compiling model.customer.cumulative_revenue
[0m11:16:54.775121 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer.cumulative_revenue"
[0m11:16:54.797799 [debug] [Thread-1 (]: finished collecting timing info
[0m11:16:54.799570 [debug] [Thread-1 (]: Began executing node model.customer.cumulative_revenue
[0m11:16:54.843063 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer.cumulative_revenue"
[0m11:16:54.875696 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:16:54.877802 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: BEGIN
[0m11:16:54.879348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:54.905169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:16:54.907990 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:16:54.916116 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */

  
    

  create  table "postgres"."public"."cumulative_revenue__dbt_tmp"
  as (
    

SELECT
    payment_date,
    amount,
    SUM(amount) OVER (ORDER BY payment_date)
FROM
    "postgres"."public"."int_revenue_by_date"
ORDER BY
    payment_date
  );
  
[0m11:16:55.011849 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.09 seconds
[0m11:16:55.018622 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:16:55.020543 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue" rename to "cumulative_revenue__dbt_backup"
[0m11:16:55.025426 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:16:55.029369 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:16:55.030801 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue__dbt_tmp" rename to "cumulative_revenue"
[0m11:16:55.033544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:16:55.047933 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: COMMIT
[0m11:16:55.051713 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:16:55.053745 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: COMMIT
[0m11:16:55.058700 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:16:55.063355 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:16:55.065019 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
drop table if exists "postgres"."public"."cumulative_revenue__dbt_backup" cascade
[0m11:16:55.075674 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m11:16:55.078288 [debug] [Thread-1 (]: finished collecting timing info
[0m11:16:55.079808 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: Close
[0m11:16:55.081579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec6dd35e-1055-4fca-9db7-7d81a1ad6621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7c3f340>]}
[0m11:16:55.083183 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.cumulative_revenue .................... [[32mSELECT 40[0m in 0.31s]
[0m11:16:55.110092 [debug] [Thread-1 (]: Finished running node model.customer.cumulative_revenue
[0m11:16:55.113122 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:16:55.115179 [debug] [MainThread]: Using postgres connection "master"
[0m11:16:55.116648 [debug] [MainThread]: On master: BEGIN
[0m11:16:55.117927 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:16:55.143056 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m11:16:55.145291 [debug] [MainThread]: On master: COMMIT
[0m11:16:55.152249 [debug] [MainThread]: Using postgres connection "master"
[0m11:16:55.153696 [debug] [MainThread]: On master: COMMIT
[0m11:16:55.155589 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:16:55.157041 [debug] [MainThread]: On master: Close
[0m11:16:55.158661 [info ] [MainThread]: 
[0m11:16:55.165487 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.82 seconds (5.82s).
[0m11:16:55.167190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:16:55.168996 [debug] [MainThread]: Connection 'model.customer.cumulative_revenue' was properly closed.
[0m11:16:55.228999 [info ] [MainThread]: 
[0m11:16:55.230689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:16:55.232460 [info ] [MainThread]: 
[0m11:16:55.234348 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:16:55.235997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ce24d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7c3ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7bd9f30>]}
[0m11:16:55.237786 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 11:17:23.197280 | d503dc33-be31-4af9-86a3-3d2f6551af9e ==============================
[0m11:17:23.197292 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:17:23.199200 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['+cumulative_revenue.sql'], 'which': 'build', 'rpc_method': 'build'}
[0m11:17:23.201703 [debug] [MainThread]: Tracking: tracking
[0m11:17:23.208483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f28e680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f28e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f28e5f0>]}
[0m11:17:23.616599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:17:23.618264 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:17:23.629505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd503dc33-be31-4af9-86a3-3d2f6551af9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f0cd510>]}
[0m11:17:23.693689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd503dc33-be31-4af9-86a3-3d2f6551af9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f01bb50>]}
[0m11:17:23.695946 [info ] [MainThread]: Found 8 models, 16 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 5 sources, 0 exposures, 0 metrics
[0m11:17:23.698065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd503dc33-be31-4af9-86a3-3d2f6551af9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f094040>]}
[0m11:17:23.700881 [info ] [MainThread]: 
[0m11:17:23.702701 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:17:23.705721 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:17:23.718188 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:17:23.720233 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:17:23.722484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:28.816550 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.09 seconds
[0m11:17:28.820282 [debug] [ThreadPool]: On list_postgres: Close
[0m11:17:28.824218 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m11:17:28.829674 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:17:28.832181 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m11:17:28.833935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:33.904270 [debug] [ThreadPool]: SQL status: BEGIN in 5.07 seconds
[0m11:17:33.909915 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:17:33.913315 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:17:33.962403 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.05 seconds
[0m11:17:33.967203 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:17:33.992133 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:17:33.997998 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:34.001374 [debug] [MainThread]: On master: BEGIN
[0m11:17:34.003803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:17:34.030581 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m11:17:34.033143 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:34.039959 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:17:34.114908 [debug] [MainThread]: SQL status: SELECT 50 in 0.07 seconds
[0m11:17:34.119410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd503dc33-be31-4af9-86a3-3d2f6551af9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f077eb0>]}
[0m11:17:34.121770 [debug] [MainThread]: On master: ROLLBACK
[0m11:17:34.124628 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:34.129883 [debug] [MainThread]: On master: BEGIN
[0m11:17:34.132176 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:17:34.133912 [debug] [MainThread]: On master: COMMIT
[0m11:17:34.136254 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:34.144347 [debug] [MainThread]: On master: COMMIT
[0m11:17:34.147193 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:17:34.149549 [debug] [MainThread]: On master: Close
[0m11:17:34.152043 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:17:34.154135 [info ] [MainThread]: 
[0m11:17:34.158616 [debug] [Thread-1 (]: Began running node model.shared_models.stg_payment
[0m11:17:34.160620 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_payment ................................. [RUN]
[0m11:17:34.162263 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_payment"
[0m11:17:34.164565 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_payment
[0m11:17:34.167974 [debug] [Thread-1 (]: Compiling model.shared_models.stg_payment
[0m11:17:34.171580 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_payment"
[0m11:17:34.213301 [debug] [Thread-1 (]: finished collecting timing info
[0m11:17:34.215368 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_payment
[0m11:17:34.237480 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_payment"
[0m11:17:34.263700 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:17:34.266393 [debug] [Thread-1 (]: On model.shared_models.stg_payment: BEGIN
[0m11:17:34.268970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:39.343016 [debug] [Thread-1 (]: SQL status: BEGIN in 5.07 seconds
[0m11:17:39.347693 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:17:39.350185 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */

  create view "postgres"."public"."stg_payment__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."payment"
  );
[0m11:17:39.384000 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m11:17:39.390284 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:17:39.392395 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */
alter table "postgres"."public"."stg_payment" rename to "stg_payment__dbt_backup"
[0m11:17:39.396660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:17:39.399729 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:17:39.402885 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */
alter table "postgres"."public"."stg_payment__dbt_tmp" rename to "stg_payment"
[0m11:17:39.406896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:17:39.417592 [debug] [Thread-1 (]: On model.shared_models.stg_payment: COMMIT
[0m11:17:39.419345 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:17:39.420856 [debug] [Thread-1 (]: On model.shared_models.stg_payment: COMMIT
[0m11:17:39.448978 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:17:39.453748 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_payment"
[0m11:17:39.455741 [debug] [Thread-1 (]: On model.shared_models.stg_payment: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_payment"} */
drop view if exists "postgres"."public"."stg_payment__dbt_backup" cascade
[0m11:17:39.466145 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m11:17:39.468611 [debug] [Thread-1 (]: finished collecting timing info
[0m11:17:39.470096 [debug] [Thread-1 (]: On model.shared_models.stg_payment: Close
[0m11:17:39.471738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd503dc33-be31-4af9-86a3-3d2f6551af9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef70d60>]}
[0m11:17:39.478045 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_payment ............................ [[32mCREATE VIEW[0m in 5.31s]
[0m11:17:39.480049 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_payment
[0m11:17:39.482068 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m11:17:39.483757 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_payment_customer_id ............................. [RUN]
[0m11:17:39.491237 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m11:17:39.492968 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m11:17:39.494605 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m11:17:39.502837 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m11:17:39.518648 [debug] [Thread-1 (]: finished collecting timing info
[0m11:17:39.520135 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m11:17:39.531029 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m11:17:39.542346 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m11:17:39.544106 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: BEGIN
[0m11:17:39.545680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:39.571357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:17:39.573204 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"
[0m11:17:39.574892 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_payment_customer_id.baf680fcce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "postgres"."public"."stg_payment"
where customer_id is null



      
    ) dbt_internal_test
[0m11:17:39.602148 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:17:39.605362 [debug] [Thread-1 (]: finished collecting timing info
[0m11:17:39.629387 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: ROLLBACK
[0m11:17:39.632329 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_customer_id.baf680fcce: Close
[0m11:17:39.634764 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_payment_customer_id ................................... [[32mPASS[0m in 0.14s]
[0m11:17:39.636792 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_payment_customer_id.baf680fcce
[0m11:17:39.638647 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m11:17:39.640392 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_payment_payment_id .............................. [RUN]
[0m11:17:39.642224 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m11:17:39.643766 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m11:17:39.651290 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m11:17:39.656765 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m11:17:39.669131 [debug] [Thread-1 (]: finished collecting timing info
[0m11:17:39.671302 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m11:17:39.673745 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m11:17:39.687009 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m11:17:39.688597 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: BEGIN
[0m11:17:39.689918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:39.716316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:17:39.718296 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"
[0m11:17:39.719994 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_payment_payment_id.a464b8cd72"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from "postgres"."public"."stg_payment"
where payment_id is null



      
    ) dbt_internal_test
[0m11:17:39.746818 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:17:39.751529 [debug] [Thread-1 (]: finished collecting timing info
[0m11:17:39.753817 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: ROLLBACK
[0m11:17:39.756409 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_payment_payment_id.a464b8cd72: Close
[0m11:17:39.758771 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_payment_payment_id .................................... [[32mPASS[0m in 0.12s]
[0m11:17:39.760328 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_payment_payment_id.a464b8cd72
[0m11:17:39.763849 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m11:17:39.765729 [info ] [Thread-1 (]: 4 of 6 START test unique_stg_payment_payment_id ................................ [RUN]
[0m11:17:39.767851 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m11:17:39.769567 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m11:17:39.771122 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m11:17:39.799923 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m11:17:39.805737 [debug] [Thread-1 (]: finished collecting timing info
[0m11:17:39.807385 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m11:17:39.810226 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m11:17:39.821948 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m11:17:39.823493 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: BEGIN
[0m11:17:39.829653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:39.854842 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:17:39.857234 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_payment_payment_id.7398e70184"
[0m11:17:39.859162 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_payment_payment_id.7398e70184"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_payment"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:17:39.935525 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.07 seconds
[0m11:17:39.944161 [debug] [Thread-1 (]: finished collecting timing info
[0m11:17:39.946575 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: ROLLBACK
[0m11:17:39.949671 [debug] [Thread-1 (]: On test.shared_models.unique_stg_payment_payment_id.7398e70184: Close
[0m11:17:39.951486 [info ] [Thread-1 (]: 4 of 6 PASS unique_stg_payment_payment_id ...................................... [[32mPASS[0m in 0.18s]
[0m11:17:39.953647 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_payment_payment_id.7398e70184
[0m11:17:39.955502 [debug] [Thread-1 (]: Began running node model.shared_models.int_revenue_by_date
[0m11:17:39.957522 [info ] [Thread-1 (]: 5 of 6 START sql view model public.int_revenue_by_date ......................... [RUN]
[0m11:17:39.959540 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.int_revenue_by_date"
[0m11:17:39.960839 [debug] [Thread-1 (]: Began compiling node model.shared_models.int_revenue_by_date
[0m11:17:39.964447 [debug] [Thread-1 (]: Compiling model.shared_models.int_revenue_by_date
[0m11:17:39.968075 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.int_revenue_by_date"
[0m11:17:39.979241 [debug] [Thread-1 (]: finished collecting timing info
[0m11:17:39.981043 [debug] [Thread-1 (]: Began executing node model.shared_models.int_revenue_by_date
[0m11:17:39.985010 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.int_revenue_by_date"
[0m11:17:40.018026 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m11:17:40.020058 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: BEGIN
[0m11:17:40.021500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:40.046980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:17:40.053966 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m11:17:40.056989 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.int_revenue_by_date"} */

  create view "postgres"."public"."int_revenue_by_date__dbt_tmp" as (
    SELECT
    DATE(payment_date) AS payment_date,
    SUM(amount) AS amount
FROM
    "postgres"."public"."stg_payment"
GROUP BY
    1
  );
[0m11:17:40.085882 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m11:17:40.089504 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m11:17:40.095913 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.int_revenue_by_date"} */
alter table "postgres"."public"."int_revenue_by_date__dbt_tmp" rename to "int_revenue_by_date"
[0m11:17:40.100998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:17:40.103810 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: COMMIT
[0m11:17:40.105198 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m11:17:40.106912 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: COMMIT
[0m11:17:40.117952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:17:40.120862 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.int_revenue_by_date"
[0m11:17:40.122350 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.int_revenue_by_date"} */
drop view if exists "postgres"."public"."int_revenue_by_date__dbt_backup" cascade
[0m11:17:40.125000 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:17:40.127107 [debug] [Thread-1 (]: finished collecting timing info
[0m11:17:40.128666 [debug] [Thread-1 (]: On model.shared_models.int_revenue_by_date: Close
[0m11:17:40.130684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd503dc33-be31-4af9-86a3-3d2f6551af9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7efa8040>]}
[0m11:17:40.132007 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.int_revenue_by_date .................... [[32mCREATE VIEW[0m in 0.17s]
[0m11:17:40.134406 [debug] [Thread-1 (]: Finished running node model.shared_models.int_revenue_by_date
[0m11:17:40.138765 [debug] [Thread-1 (]: Began running node model.customer.cumulative_revenue
[0m11:17:40.140959 [info ] [Thread-1 (]: 6 of 6 START sql table model public.cumulative_revenue ......................... [RUN]
[0m11:17:40.143056 [debug] [Thread-1 (]: Acquiring new postgres connection "model.customer.cumulative_revenue"
[0m11:17:40.144688 [debug] [Thread-1 (]: Began compiling node model.customer.cumulative_revenue
[0m11:17:40.145927 [debug] [Thread-1 (]: Compiling model.customer.cumulative_revenue
[0m11:17:40.150570 [debug] [Thread-1 (]: Writing injected SQL for node "model.customer.cumulative_revenue"
[0m11:17:40.156063 [debug] [Thread-1 (]: finished collecting timing info
[0m11:17:40.157672 [debug] [Thread-1 (]: Began executing node model.customer.cumulative_revenue
[0m11:17:40.193069 [debug] [Thread-1 (]: Writing runtime sql for node "model.customer.cumulative_revenue"
[0m11:17:40.201384 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:17:40.203638 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: BEGIN
[0m11:17:40.205083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:40.236829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:17:40.239377 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:17:40.241062 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */

  
    

  create  table "postgres"."public"."cumulative_revenue__dbt_tmp"
  as (
    

SELECT
    payment_date,
    amount,
    SUM(amount) OVER (ORDER BY payment_date)
FROM
    "postgres"."public"."int_revenue_by_date"
ORDER BY
    payment_date
  );
  
[0m11:17:40.332132 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0.09 seconds
[0m11:17:40.337662 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:17:40.345623 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue" rename to "cumulative_revenue__dbt_backup"
[0m11:17:40.351565 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:17:40.362787 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:17:40.365381 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
alter table "postgres"."public"."cumulative_revenue__dbt_tmp" rename to "cumulative_revenue"
[0m11:17:40.372272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:17:40.382827 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: COMMIT
[0m11:17:40.384989 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:17:40.386876 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: COMMIT
[0m11:17:40.391899 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:17:40.395127 [debug] [Thread-1 (]: Using postgres connection "model.customer.cumulative_revenue"
[0m11:17:40.396856 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.customer.cumulative_revenue"} */
drop table if exists "postgres"."public"."cumulative_revenue__dbt_backup" cascade
[0m11:17:40.405627 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m11:17:40.407997 [debug] [Thread-1 (]: finished collecting timing info
[0m11:17:40.409204 [debug] [Thread-1 (]: On model.customer.cumulative_revenue: Close
[0m11:17:40.412412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd503dc33-be31-4af9-86a3-3d2f6551af9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cddcee0>]}
[0m11:17:40.415208 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public.cumulative_revenue .................... [[32mSELECT 40[0m in 0.27s]
[0m11:17:40.418025 [debug] [Thread-1 (]: Finished running node model.customer.cumulative_revenue
[0m11:17:40.421223 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:17:40.422947 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:40.426066 [debug] [MainThread]: On master: BEGIN
[0m11:17:40.427830 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:17:45.463103 [debug] [MainThread]: SQL status: BEGIN in 5.04 seconds
[0m11:17:45.467299 [debug] [MainThread]: On master: COMMIT
[0m11:17:45.474255 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:45.476037 [debug] [MainThread]: On master: COMMIT
[0m11:17:45.477943 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:17:45.479640 [debug] [MainThread]: On master: Close
[0m11:17:45.481494 [info ] [MainThread]: 
[0m11:17:45.487719 [info ] [MainThread]: Finished running 2 view models, 3 tests, 1 table model in 0 hours 0 minutes and 21.78 seconds (21.78s).
[0m11:17:45.489570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:45.491078 [debug] [MainThread]: Connection 'model.customer.cumulative_revenue' was properly closed.
[0m11:17:45.556036 [info ] [MainThread]: 
[0m11:17:45.563911 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:17:45.566142 [info ] [MainThread]: 
[0m11:17:45.567901 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:17:45.569863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f077c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f0cd570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cdd5cc0>]}
[0m11:17:45.577139 [debug] [MainThread]: Flushing usage events


============================== 2023-02-21 11:26:30.101789 | 80ce3faf-61c1-4e5e-90fa-c3f1add92307 ==============================
[0m11:26:30.101835 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:26:30.104155 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/src/dbt/dbt_project/profiles', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'select': ['stg_rental.sql'], 'which': 'build', 'rpc_method': 'build'}
[0m11:26:30.106024 [debug] [MainThread]: Tracking: tracking
[0m11:26:30.109598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef627a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef626b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef62710>]}
[0m11:26:30.516286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:26:30.522899 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:26:30.528697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80ce3faf-61c1-4e5e-90fa-c3f1add92307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed9d4e0>]}
[0m11:26:30.594846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80ce3faf-61c1-4e5e-90fa-c3f1add92307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed640a0>]}
[0m11:26:30.598101 [info ] [MainThread]: Found 8 models, 16 tests, 1 snapshot, 0 analyses, 401 macros, 0 operations, 1 seed file, 5 sources, 0 exposures, 0 metrics
[0m11:26:30.600131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80ce3faf-61c1-4e5e-90fa-c3f1add92307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eee7b20>]}
[0m11:26:30.603821 [info ] [MainThread]: 
[0m11:26:30.606305 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:26:30.613440 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:26:30.621355 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:26:30.623282 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:26:30.624932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:30.678677 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.05 seconds
[0m11:26:30.681729 [debug] [ThreadPool]: On list_postgres: Close
[0m11:26:30.684371 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m11:26:30.689496 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:26:30.691480 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m11:26:30.699353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:35.791233 [debug] [ThreadPool]: SQL status: BEGIN in 5.09 seconds
[0m11:26:35.797685 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:26:35.800645 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:26:35.850607 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.05 seconds
[0m11:26:35.853750 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:26:35.857972 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:26:35.863559 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:35.865715 [debug] [MainThread]: On master: BEGIN
[0m11:26:35.867435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:26:35.915092 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m11:26:35.917441 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:35.919326 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:26:36.001095 [debug] [MainThread]: SQL status: SELECT 50 in 0.08 seconds
[0m11:26:36.005833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80ce3faf-61c1-4e5e-90fa-c3f1add92307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed47e50>]}
[0m11:26:36.008142 [debug] [MainThread]: On master: ROLLBACK
[0m11:26:36.011019 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:36.017247 [debug] [MainThread]: On master: BEGIN
[0m11:26:36.019327 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:26:36.020979 [debug] [MainThread]: On master: COMMIT
[0m11:26:36.022471 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:36.023982 [debug] [MainThread]: On master: COMMIT
[0m11:26:36.031141 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:26:36.032932 [debug] [MainThread]: On master: Close
[0m11:26:36.034746 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:26:36.036342 [info ] [MainThread]: 
[0m11:26:36.040693 [debug] [Thread-1 (]: Began running node model.shared_models.stg_rental
[0m11:26:36.046303 [info ] [Thread-1 (]: 1 of 3 START sql view model public.stg_rental .................................. [RUN]
[0m11:26:36.048450 [debug] [Thread-1 (]: Acquiring new postgres connection "model.shared_models.stg_rental"
[0m11:26:36.049795 [debug] [Thread-1 (]: Began compiling node model.shared_models.stg_rental
[0m11:26:36.051294 [debug] [Thread-1 (]: Compiling model.shared_models.stg_rental
[0m11:26:36.054770 [debug] [Thread-1 (]: Writing injected SQL for node "model.shared_models.stg_rental"
[0m11:26:36.060531 [debug] [Thread-1 (]: finished collecting timing info
[0m11:26:36.063764 [debug] [Thread-1 (]: Began executing node model.shared_models.stg_rental
[0m11:26:36.083419 [debug] [Thread-1 (]: Writing runtime sql for node "model.shared_models.stg_rental"
[0m11:26:36.092283 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:26:36.093936 [debug] [Thread-1 (]: On model.shared_models.stg_rental: BEGIN
[0m11:26:36.095129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:41.161111 [debug] [Thread-1 (]: SQL status: BEGIN in 5.07 seconds
[0m11:26:41.172640 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:26:41.175586 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */

  create view "postgres"."public"."stg_rental__dbt_tmp" as (
    SELECT
    *
FROM
    "postgres"."public"."rental"
  );
[0m11:26:41.210918 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.03 seconds
[0m11:26:41.217116 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:26:41.224515 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */
alter table "postgres"."public"."stg_rental" rename to "stg_rental__dbt_backup"
[0m11:26:41.228374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:26:41.231910 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:26:41.233747 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */
alter table "postgres"."public"."stg_rental__dbt_tmp" rename to "stg_rental"
[0m11:26:41.237535 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:26:41.254605 [debug] [Thread-1 (]: On model.shared_models.stg_rental: COMMIT
[0m11:26:41.256051 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:26:41.257542 [debug] [Thread-1 (]: On model.shared_models.stg_rental: COMMIT
[0m11:26:41.262231 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:26:41.267030 [debug] [Thread-1 (]: Using postgres connection "model.shared_models.stg_rental"
[0m11:26:41.268617 [debug] [Thread-1 (]: On model.shared_models.stg_rental: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "model.shared_models.stg_rental"} */
drop view if exists "postgres"."public"."stg_rental__dbt_backup" cascade
[0m11:26:41.280259 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m11:26:41.282873 [debug] [Thread-1 (]: finished collecting timing info
[0m11:26:41.284621 [debug] [Thread-1 (]: On model.shared_models.stg_rental: Close
[0m11:26:41.286301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80ce3faf-61c1-4e5e-90fa-c3f1add92307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec43520>]}
[0m11:26:41.290094 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.stg_rental ............................. [[32mCREATE VIEW[0m in 5.24s]
[0m11:26:41.291770 [debug] [Thread-1 (]: Finished running node model.shared_models.stg_rental
[0m11:26:41.294020 [debug] [Thread-1 (]: Began running node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m11:26:41.295766 [info ] [Thread-1 (]: 2 of 3 START test not_null_stg_rental_rental_id ................................ [RUN]
[0m11:26:41.297742 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m11:26:41.300827 [debug] [Thread-1 (]: Began compiling node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m11:26:41.302696 [debug] [Thread-1 (]: Compiling test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m11:26:41.311878 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m11:26:41.348622 [debug] [Thread-1 (]: finished collecting timing info
[0m11:26:41.350915 [debug] [Thread-1 (]: Began executing node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m11:26:41.361579 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m11:26:41.369110 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m11:26:41.375346 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: BEGIN
[0m11:26:41.377078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:41.402327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:26:41.404650 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"
[0m11:26:41.411053 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rental_id
from "postgres"."public"."stg_rental"
where rental_id is null



      
    ) dbt_internal_test
[0m11:26:41.441226 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.03 seconds
[0m11:26:41.444283 [debug] [Thread-1 (]: finished collecting timing info
[0m11:26:41.446338 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: ROLLBACK
[0m11:26:41.449596 [debug] [Thread-1 (]: On test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2: Close
[0m11:26:41.457932 [info ] [Thread-1 (]: 2 of 3 PASS not_null_stg_rental_rental_id ...................................... [[32mPASS[0m in 0.16s]
[0m11:26:41.459657 [debug] [Thread-1 (]: Finished running node test.shared_models.not_null_stg_rental_rental_id.cb8d8dd5b2
[0m11:26:41.461256 [debug] [Thread-1 (]: Began running node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m11:26:41.463393 [info ] [Thread-1 (]: 3 of 3 START test unique_stg_rental_rental_id .................................. [RUN]
[0m11:26:41.465422 [debug] [Thread-1 (]: Acquiring new postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m11:26:41.467206 [debug] [Thread-1 (]: Began compiling node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m11:26:41.469283 [debug] [Thread-1 (]: Compiling test.shared_models.unique_stg_rental_rental_id.b263207352
[0m11:26:41.474911 [debug] [Thread-1 (]: Writing injected SQL for node "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m11:26:41.485264 [debug] [Thread-1 (]: finished collecting timing info
[0m11:26:41.487201 [debug] [Thread-1 (]: Began executing node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m11:26:41.491600 [debug] [Thread-1 (]: Writing runtime sql for node "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m11:26:41.498287 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m11:26:41.499907 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: BEGIN
[0m11:26:41.524588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:41.551026 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m11:26:41.553117 [debug] [Thread-1 (]: Using postgres connection "test.shared_models.unique_stg_rental_rental_id.b263207352"
[0m11:26:41.555026 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "customer", "target_name": "dev", "node_id": "test.shared_models.unique_stg_rental_rental_id.b263207352"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    rental_id as unique_field,
    count(*) as n_records

from "postgres"."public"."stg_rental"
where rental_id is not null
group by rental_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:26:41.625415 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.07 seconds
[0m11:26:41.628484 [debug] [Thread-1 (]: finished collecting timing info
[0m11:26:41.630517 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: ROLLBACK
[0m11:26:41.637685 [debug] [Thread-1 (]: On test.shared_models.unique_stg_rental_rental_id.b263207352: Close
[0m11:26:41.640109 [info ] [Thread-1 (]: 3 of 3 PASS unique_stg_rental_rental_id ........................................ [[32mPASS[0m in 0.17s]
[0m11:26:41.641822 [debug] [Thread-1 (]: Finished running node test.shared_models.unique_stg_rental_rental_id.b263207352
[0m11:26:41.644767 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:26:41.651429 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:41.653252 [debug] [MainThread]: On master: BEGIN
[0m11:26:41.655272 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:26:46.725536 [debug] [MainThread]: SQL status: BEGIN in 5.07 seconds
[0m11:26:46.730296 [debug] [MainThread]: On master: COMMIT
[0m11:26:46.732796 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:46.738887 [debug] [MainThread]: On master: COMMIT
[0m11:26:46.741697 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:26:46.743950 [debug] [MainThread]: On master: Close
[0m11:26:46.746551 [info ] [MainThread]: 
[0m11:26:46.748761 [info ] [MainThread]: Finished running 1 view model, 2 tests in 0 hours 0 minutes and 16.14 seconds (16.14s).
[0m11:26:46.752473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:46.754264 [debug] [MainThread]: Connection 'test.shared_models.unique_stg_rental_rental_id.b263207352' was properly closed.
[0m11:26:46.815223 [info ] [MainThread]: 
[0m11:26:46.816709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:26:46.818173 [info ] [MainThread]: 
[0m11:26:46.825997 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:26:46.827737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ecde710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ecdf8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ecdc730>]}
[0m11:26:46.829564 [debug] [MainThread]: Flushing usage events
